var e,t,n,r,o,a,l={},i=[],s=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function c(e,t){for(var n in t)e[n]=t[n];return e}function u(e){var t=e.parentNode;t&&t.removeChild(e)}function d(e,t,n){var r,o=arguments,a={};for(r in t)"key"!==r&&"ref"!==r&&(a[r]=t[r]);if(arguments.length>3)for(n=[n],r=3;r<arguments.length;r++)n.push(o[r]);if(null!=n&&(a.children=n),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===a[r]&&(a[r]=e.defaultProps[r]);return f(e,a,t&&t.key,t&&t.ref,null)}function f(t,n,r,o,a){var l={type:t,props:n,key:r,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:a};return null==a&&(l.__v=l),e.vnode&&e.vnode(l),l}function v(e){return e.children}function p(e,t){this.props=e,this.context=t}function g(e,t){if(null==t)return e.__?g(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?g(e):null}function h(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return h(e)}}function m(a){(!a.__d&&(a.__d=!0)&&t.push(a)&&!n++||o!==e.debounceRendering)&&((o=e.debounceRendering)||r)(w)}function w(){for(var e;n=t.length;)e=t.sort((function(e,t){return e.__v.__b-t.__v.__b})),t=[],e.some((function(e){var t,n,r,o,a,l,i;e.__d&&(l=(a=(t=e).__v).__e,(i=t.__P)&&(n=[],(r=c({},a)).__v=r,o=C(i,a,r,t.__n,void 0!==i.ownerSVGElement,null,n,null==l?g(a):l),S(n,a),o!=l&&h(a)))}))}function y(e,t,n,r,o,a,s,c,d){var f,v,p,h,m,w,y,b=n&&n.__k||i,x=b.length;if(c==l&&(c=null!=a?a[0]:x?g(n,0):null),f=0,t.__k=_(t.__k,(function(n){if(null!=n){if(n.__=t,n.__b=t.__b+1,null===(p=b[f])||p&&n.key==p.key&&n.type===p.type)b[f]=void 0;else for(v=0;v<x;v++){if((p=b[v])&&n.key==p.key&&n.type===p.type){b[v]=void 0;break}p=null}if(h=C(e,n,p=p||l,r,o,a,s,c,d),(v=n.ref)&&p.ref!=v&&(y||(y=[]),p.ref&&y.push(p.ref,null,n),y.push(v,n.__c||h,n)),null!=h){var i;if(null==w&&(w=h),void 0!==n.__d)i=n.__d,n.__d=void 0;else if(a==p||h!=c||null==h.parentNode){e:if(null==c||c.parentNode!==e)e.appendChild(h),i=null;else{for(m=c,v=0;(m=m.nextSibling)&&v<x;v+=2)if(m==h)break e;e.insertBefore(h,c),i=c}"option"==t.type&&(e.value="")}c=void 0!==i?i:h.nextSibling,"function"==typeof t.type&&(t.__d=c)}else c&&p.__e==c&&c.parentNode!=e&&(c=g(p))}return f++,n})),t.__e=w,null!=a&&"function"!=typeof t.type)for(f=a.length;f--;)null!=a[f]&&u(a[f]);for(f=x;f--;)null!=b[f]&&I(b[f],b[f]);if(y)for(f=0;f<y.length;f++)D(y[f],y[++f],y[++f])}function _(e,t,n){if(null==n&&(n=[]),null==e||"boolean"==typeof e)t&&n.push(t(null));else if(Array.isArray(e))for(var r=0;r<e.length;r++)_(e[r],t,n);else n.push(t?t("string"==typeof e||"number"==typeof e?f(null,e,null,null,e):null!=e.__e||null!=e.__c?f(e.type,e.props,e.key,null,e.__v):e):e);return n}function b(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]="number"==typeof n&&!1===s.test(t)?n+"px":null==n?"":n}function x(e,t,n,r,o){var a,l,i,s,c;if(o?"className"===t&&(t="class"):"class"===t&&(t="className"),"style"===t)if(a=e.style,"string"==typeof n)a.cssText=n;else{if("string"==typeof r&&(a.cssText="",r=null),r)for(s in r)n&&s in n||b(a,s,"");if(n)for(c in n)r&&n[c]===r[c]||b(a,c,n[c])}else"o"===t[0]&&"n"===t[1]?(l=t!==(t=t.replace(/Capture$/,"")),i=t.toLowerCase(),t=(i in e?i:t).slice(2),n?(r||e.addEventListener(t,k,l),(e.l||(e.l={}))[t]=n):e.removeEventListener(t,k,l)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&!o&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,n))}function k(t){this.l[t.type](e.event?e.event(t):t)}function C(t,n,r,o,a,l,i,s,u){var d,f,g,h,m,w,_,b,x,k,C=n.type;if(void 0!==n.constructor)return null;(d=e.__b)&&d(n);try{e:if("function"==typeof C){if(b=n.props,x=(d=C.contextType)&&o[d.__c],k=d?x?x.props.value:d.__:o,r.__c?_=(f=n.__c=r.__c).__=f.__E:("prototype"in C&&C.prototype.render?n.__c=f=new C(b,k):(n.__c=f=new p(b,k),f.constructor=C,f.render=P),x&&x.sub(f),f.props=b,f.state||(f.state={}),f.context=k,f.__n=o,g=f.__d=!0,f.__h=[]),null==f.__s&&(f.__s=f.state),null!=C.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=c({},f.__s)),c(f.__s,C.getDerivedStateFromProps(b,f.__s))),h=f.props,m=f.state,g)null==C.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(null==C.getDerivedStateFromProps&&b!==h&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(b,k),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(b,f.__s,k)||n.__v===r.__v&&!f.__){for(f.props=b,f.state=f.__s,n.__v!==r.__v&&(f.__d=!1),f.__v=n,n.__e=r.__e,n.__k=r.__k,f.__h.length&&i.push(f),d=0;d<n.__k.length;d++)n.__k[d]&&(n.__k[d].__=n);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(b,f.__s,k),null!=f.componentDidUpdate&&f.__h.push((function(){f.componentDidUpdate(h,m,w)}))}f.context=k,f.props=b,f.state=f.__s,(d=e.__r)&&d(n),f.__d=!1,f.__v=n,f.__P=t,d=f.render(f.props,f.state,f.context),n.__k=null!=d&&d.type==v&&null==d.key?d.props.children:Array.isArray(d)?d:[d],null!=f.getChildContext&&(o=c(c({},o),f.getChildContext())),g||null==f.getSnapshotBeforeUpdate||(w=f.getSnapshotBeforeUpdate(h,m)),y(t,n,r,o,a,l,i,s,u),f.base=n.__e,f.__h.length&&i.push(f),_&&(f.__E=f.__=null),f.__e=!1}else null==l&&n.__v===r.__v?(n.__k=r.__k,n.__e=r.__e):n.__e=A(r.__e,n,r,o,a,l,i,u);(d=e.diffed)&&d(n)}catch(t){n.__v=null,e.__e(t,n,r)}return n.__e}function S(t,n){e.__c&&e.__c(n,t),t.some((function(n){try{t=n.__h,n.__h=[],t.some((function(e){e.call(n)}))}catch(t){e.__e(t,n.__v)}}))}function A(e,t,n,r,o,a,s,c){var u,d,f,v,p,g=n.props,h=t.props;if(o="svg"===t.type||o,null!=a)for(u=0;u<a.length;u++)if(null!=(d=a[u])&&((null===t.type?3===d.nodeType:d.localName===t.type)||e==d)){e=d,a[u]=null;break}if(null==e){if(null===t.type)return document.createTextNode(h);e=o?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,h.is&&{is:h.is}),a=null,c=!1}if(null===t.type)g!==h&&e.data!=h&&(e.data=h);else{if(null!=a&&(a=i.slice.call(e.childNodes)),f=(g=n.props||l).dangerouslySetInnerHTML,v=h.dangerouslySetInnerHTML,!c){if(g===l)for(g={},p=0;p<e.attributes.length;p++)g[e.attributes[p].name]=e.attributes[p].value;(v||f)&&(v&&f&&v.__html==f.__html||(e.innerHTML=v&&v.__html||""))}(function(e,t,n,r,o){var a;for(a in n)"children"===a||"key"===a||a in t||x(e,a,null,n[a],r);for(a in t)o&&"function"!=typeof t[a]||"children"===a||"key"===a||"value"===a||"checked"===a||n[a]===t[a]||x(e,a,t[a],n[a],r)})(e,h,g,o,c),v?t.__k=[]:(t.__k=t.props.children,y(e,t,n,r,"foreignObject"!==t.type&&o,a,s,l,c)),c||("value"in h&&void 0!==(u=h.value)&&u!==e.value&&x(e,"value",u,g.value,!1),"checked"in h&&void 0!==(u=h.checked)&&u!==e.checked&&x(e,"checked",u,g.checked,!1))}return e}function D(t,n,r){try{"function"==typeof t?t(n):t.current=n}catch(t){e.__e(t,r)}}function I(t,n,r){var o,a,l;if(e.unmount&&e.unmount(t),(o=t.ref)&&(o.current&&o.current!==t.__e||D(o,null,n)),r||"function"==typeof t.type||(r=null!=(a=t.__e)),t.__e=t.__d=void 0,null!=(o=t.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(t){e.__e(t,n)}o.base=o.__P=null}if(o=t.__k)for(l=0;l<o.length;l++)o[l]&&I(o[l],n,r);null!=a&&u(a)}function P(e,t,n){return this.constructor(e,n)}e={__e:function(e,t){for(var n,r;t=t.__;)if((n=t.__c)&&!n.__)try{if(n.constructor&&null!=n.constructor.getDerivedStateFromError&&(r=!0,n.setState(n.constructor.getDerivedStateFromError(e))),null!=n.componentDidCatch&&(r=!0,n.componentDidCatch(e)),r)return m(n.__E=n)}catch(t){e=t}throw e}},p.prototype.setState=function(e,t){var n;n=this.__s!==this.state?this.__s:this.__s=c({},this.state),"function"==typeof e&&(e=e(n,this.props)),e&&c(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),m(this))},p.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),m(this))},p.prototype.render=v,t=[],n=0,r="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,a=l;var T=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,o=Math.min(t,n,r),a=Math.max(t,n,r),l=a-o,i=0,s=0,c=0;return i=0===l?0:a===t?(n-r)/l%6:a===n?(r-t)/l+2:(t-n)/l+4,(i=Math.round(60*i))<0&&(i+=360),c=(a+o)/2,s=+(100*(s=0===l?0:l/(1-Math.abs(2*c-1)))).toFixed(1),c=+(100*c).toFixed(1),[Math.floor(i),Math.floor(s),Math.floor(c),255]},E=window.location.href.includes("localhost:4000")?"DEV":"PROD",M={},z={render:void 0},L=["canvasSelection","canvasPreview","canvasTemp","canvasFinal","canvasView"],q=function(){L.forEach((function(e){z[e].dom="canvasView"===e?document.querySelector("#canvas-view"):document.createElement("canvas"),z[e].dom.width=M.width,z[e].dom.height=M.height,z[e].ctx=z[e].dom.getContext("2d"),z[e].imgData=z[e].ctx.getImageData(0,0,M.width,M.height)})),z.canvasTimeline=document.querySelector("#timeline-canvas"),z.canvasTimelineTemp=document.createElement("canvas")},X=function(e,t,n){!function(e,t){M.width=e,M.height=t,M.tool="pencil",M.frameActive=0,M.layerActive=0,M.frameCount=1,M.layerCount=1,M.layers=[{name:"Layer 1",hidden:!1,frames:[new ImageData(e,t)]}],M.color={},M.color.rgb=[100,188,156,255],M.color.hsl=T(M.color.rgb),M.palette=[[26,188,156,255],[46,204,113,255],[52,152,219,255],[155,89,182,255],[52,73,94,255],[22,160,133,255],[39,174,96,255],[41,128,185,255],[142,68,173,255],[44,62,80,255],[241,196,15,255],[230,126,34,255],[231,76,60,255],[236,240,241,255],[149,165,166,255],[243,156,18,255],[211,84,0,255],[192,57,43,255],[189,195,199,255],[127,140,141,255]],Object.seal(M)}(e,t),function(e){z.activeInput={id:"",val:""},z.window={request:"",mouseDown:!1,startX:0,startY:0,prevX:0,prevY:0,currX:0,currY:0},z.file={open:!1},z.newCanvas={open:!1,w:32,h:32},z.downloadCanvas={open:!1,size:2,type:"frame"},z.brushSize=0,z.timerID=void 0,z.isPlaying=!1,z.onionSkinning=!1,z.undo=[],z.undoPos=-1,z.currUndoRef={},z.canvasTimeline=void 0,z.canvasTimelineTemp=void 0,L.forEach((function(e){z[e]={dom:void 0,ctx:void 0,imgData:void 0}})),!0!==e&&q(),Object.seal(z)}(n)},Y=function(e,t){void 0===t&&(t=""),z.undo.splice(0,z.undoPos+1,{icon:e+".svg",action:e+" "+t,undo:R,redo:U}),z.undoPos>=0&&(z.undoPos=-1),z.undo.length>50&&z.undo.pop(),z.currUndoRef=z.undo[z.undoPos+1]},R=function(){z.undoPos+1!==z.undo.length&&(z.undoPos+=1,z.undo[z.undoPos].undo(),z.render())},U=function(){z.undoPos-1!=-2&&(z.undo[z.undoPos].redo&&z.undo[z.undoPos].redo(),z.undoPos-=1,z.render())},N=function(e){M.tool=e,z.render()},O=function(){return d("div",{class:"w-40 bg-light bord-dark-r"},["pencil","eraser","line","circle","square","fill","eye-dropper","move"].map((function(e){return d("button",{onClick:function(){N(e)},class:"fl fl-center m-0 p-0 w-40 h-40 bord-dark-r",style:M.tool===e?"background: rgba(52, 152, 219, 255);":""},d("img",{src:"img/"+e+".svg"}))})))},V={metaKey:{z:R},shiftKey:{metaKey:{z:U}},b:function(){N("pencil")},e:function(){N("eraser")},u:function(){N("line")},g:function(){N("fill")},l:function(){N("eye-dropper")},v:function(){N("move")}},F=Date.now(),K=Date.now(),G=Date.now(),H=function(e,t){z.activeInput.id=e,z.activeInput.val=t,z.render()},W=function(){z.activeInput.id="",z.activeInput.val="",z.render()},j=function(e){z.activeInput.val=e},B=function(e){var t=e,n=T(t);M.color.rgb=t,M.color.hsl=n,z.render()},$=function(e){var t=e,n=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,o=(1-Math.abs(2*r-1))*n,a=o*(1-Math.abs(e[0]/60%2-1)),l=r-o/2,i=0,s=0,c=0;return t>=0&&t<60?(i=o,s=a,c=0):t>=60&&t<120?(i=a,s=o,c=0):t>=120&&t<180?(i=0,s=o,c=a):t>=180&&t<240?(i=0,s=a,c=o):t>=240&&t<300?(i=a,s=0,c=o):t>=300&&t<360&&(i=o,s=0,c=a),[i=Math.round(255*(i+l)),s=Math.round(255*(s+l)),c=Math.round(255*(c+l)),255]}(t);M.color.hsl=t,M.color.rgb=n,z.render()},J=function(e){var t=parseInt(e.target.value);if(t>=0&&t<=255){var n=[t,M.color.rgb[1],M.color.rgb[2],M.color.rgb[3]];B(n)}},Q=function(e){var t=parseInt(e.target.value);if(t>=0&&t<=255){var n=[M.color.rgb[0],t,M.color.rgb[2],M.color.rgb[3]];B(n)}},Z=function(e){var t=parseInt(e.target.value);if(t>=0&&t<=255){var n=[M.color.rgb[0],M.color.rgb[1],t,M.color.rgb[3]];B(n)}},ee=function(e){var t=parseInt(e.target.value);if(t>=0&&t<=360){var n=[t,M.color.hsl[1],M.color.hsl[2],M.color.hsl[3]];$(n)}},te=function(e){var t=parseInt(e.target.value);if(t>=0&&t<=100){var n=[M.color.hsl[0],t,M.color.hsl[2],M.color.hsl[3]];$(n)}},ne=function(e){var t=parseInt(e.target.value);if(t>=0&&t<=100){var n=[M.color.hsl[0],M.color.hsl[1],t,M.color.hsl[3]];$(n)}},re=function(){return d("div",{class:"bord-dark-b fl-1"},d("div",{class:"h-30 bg-mid bord-dark-b fl fl-center-y p-h-10"},d("small",null,d("b",null,"Color"))),d("div",{class:"fl-column overflow-none p-10"},d("div",{class:"b-r-2 overflow-none fl-column"},[{id:"color-hue-range",min:0,max:360,func:ee,style:"min-height: 26px; background: linear-gradient(to right, #ff0000 0%, #ffff00 17%, #00ff00 33%, #00ffff 50%, #0000ff 67%, #ff00ff 83%, #ff0000 100%);"},{id:"color-saturation-range",min:0,max:100,func:te,style:"min-height: 26px; background: linear-gradient(to right, hsl("+M.color.hsl[0]+", 0%, 50%) 0%,hsl("+M.color.hsl[0]+", 100%, 50%) 100%);"},{id:"color-lightness-range",min:0,max:100,func:ne,style:"min-height: 26px; background: linear-gradient(to right, hsl("+M.color.hsl[0]+", 100%, 0%) 0%, hsl("+M.color.hsl[0]+", 100%, 50%) 50%, hsl("+M.color.hsl[0]+", 100%, 100%) 100%)"}].map((function(e,t){return d("input",{type:"range",min:e.min,max:e.max,style:e.style,class:"fl-1 m-0",onFocus:function(n){H(e.id,M.color.hsl[t])},onFocusOut:function(){W()},onInput:function(t){j(t.target.value),e.func(t)},value:z.activeInput.id===e.id?z.activeInput.val:M.color.hsl[t]})}))),d("div",{class:"p-v-10"},d("div",{class:"fl fl-center-y",style:"margin-bottom: 2px;"},d("small",{style:"width: 50px; font-size: 11px;"},"HSL"),[{id:"color-hue-text",func:ee},{id:"color-saturation-text",func:te},{id:"color-lightness-text",func:ne}].map((function(e,t){return d("input",{class:"fl-1",type:"number",style:"margin-right: "+(2===t?0:2)+"px;",onFocus:function(n){H(e.id,M.color.hsl[t])},onFocusOut:function(){W()},onInput:function(t){j(t.target.value),e.func(t)},value:z.activeInput.id===e.id?z.activeInput.val:M.color.hsl[t]})}))),d("div",{class:"fl fl-center-y",style:"margin-bottom: 2px;"},d("small",{style:"width: 50px; font-size: 11px;"},"RGB"),[{id:"color-red-text",func:J},{id:"color-green-text",func:Q},{id:"color-blue-text",func:Z}].map((function(e,t){return d("input",{class:"fl-1",type:"number",style:"margin-right: "+(2===t?0:2)+"px;",onFocus:function(n){H(e.id,M.color.rgb[t])},onFocusOut:function(){W()},onInput:function(t){j(t.target.value),e.func(t)},value:z.activeInput.id===e.id?z.activeInput.val:M.color.rgb[t]})})))),d("div",{class:"fl"},d("div",{class:"fl-1 no-ptr h-25 b-r-2",style:"margin-right: 10px; background: rgba("+M.color.rgb[0]+", "+M.color.rgb[1]+", "+M.color.rgb[2]+", 255); margin-bottom: 10px; "}),0===M.palette.filter((function(e){return M.color.rgb[0]===e[0]&&M.color.rgb[1]===e[1]&&M.color.rgb[2]===e[2]&&M.color.rgb[3]===e[3]})).length?d("button",{onClick:function(){M.palette.push(M.color.rgb),z.render()},class:"w-30 h-25 fl fl-center bg-dark bord-dark b-r-2"},d("img",{src:"img/insert.svg"})):d("button",{onClick:function(){var e;-1!==(e=M.palette.indexOf(M.color.rgb))&&(M.palette.splice(e,1),z.render())},class:"w-30 h-25 fl fl-center bg-dark bord-dark b-r-2"},d("img",{src:"img/delete.svg"}))),d("div",{class:"fl fl-wrap overflow-none b-r-2",style:"align-content: baseline;"},M.palette.map((function(e){return d("button",{onClick:function(){B(e)},class:"m-0",style:"\n                  width: 44px;\n                  min-height: 25px;\n                  background: rgba("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+");\n                  border: "+(M.color.rgb[0]===e[0]&&M.color.rgb[1]===e[1]&&M.color.rgb[2]===e[2]&&M.color.rgb[3]===e[3]?"2px solid rgba(61,61,61, 1)":"2px solid rgba(61,61,61, 0)")+";\n                  box-shadow: inset 0px 0px 0px 1px rgba(255, 255, 255, "+(M.color.rgb[0]===e[0]&&M.color.rgb[1]===e[1]&&M.color.rgb[2]===e[2]&&M.color.rgb[3]===e[3]?"255":"0")+");\n                "})})))))},oe=function(e,t){void 0===e&&console.error("setTargetCanvas - no frame given"),void 0===t&&console.error("setTargetCanvas - no layer given"),e>=0&&e<M.frameCount&&t>=0&&t<=M.layerCount&&(M.frameActive=e,M.layerActive=t,z.render())},ae=function(e,t,n){var r="insert"===e||"duplicate"===e;function o(e,t,n,r){"insert"===e&&t.splice(n+1,0,r),"delete"===e&&t.splice(n,1)}"layer"===t&&("insert"===e&&o(e,M.layers,M.layerActive,n),"delete"===e&&o(e,M.layers,M.layerActive)),"frame"===t&&("insert"===e&&M.layers.forEach((function(t,r){var a=new ImageData(M.width,M.height);a.data.set(n[r].data),o(e,t.frames,M.frameActive,a)})),"delete"===e&&M.layers.forEach((function(t){o(e,t.frames,M.frameActive)}))),M[t+"Count"]+=r?1:-1,r&&(M[t+"Active"]+=1),"delete"===e&&M[t+"Active"]===M[t+"Count"]&&(M[t+"Active"]-=1)},le=function(e){var t=e.type,n=e.request,r=e.requestType,o=e.data,a=e.disableUndoRedo,l=M.layerActive,i=M.frameActive,s=M.layerCount,c=M.frameCount;a||(Y(n,t),z.currUndoRef.redo=function(){M.frameCount=c,M.layerCount=s,M.frameActive=i,M.layerActive=l,le({type:t,request:n,requestType:r,data:o,disableUndoRedo:!0})});var u="layer"===t?{name:"Layer "+(s+1),hidden:!1,frames:new Array(c).fill(void 0).map((function(e){return new ImageData(M.width,M.height)}))}:new Array(M.layerCount).fill(void 0).map((function(e){return new ImageData(M.width,M.height)})),d="layer"===t?{name:M.layers[l].name+" "+("clone"===r?"(Copy)":""),hidden:!1,frames:new Array(c).fill(void 0).map((function(e,t){var n=new ImageData(M.width,M.height);return n.data.set(M.layers[l].frames[t].data),n}))}:new Array(s).fill(void 0).map((function(e,t){var n=new ImageData(M.width,M.height);return n.data.set(M.layers[t].frames[i].data),n}));"layer"!==t&&"frame"!==t||"new"!==r&&"clone"!==r||ae("insert",t,"new"===r?u:d),"layer"!==t&&"frame"!==t||"delete"!==n||(M[t+"Count"]-1==0?(ae("delete",t),"layer"===t&&(u.name="Layer 1"),ae("insert",t,u)):ae("delete",t));var f=M.layerActive,v=M.frameActive,p=M.layerCount,g=M.frameCount;a||(z.currUndoRef.undo=function(){M.frameCount=g,M.layerCount=p,"layer"===t&&(M.frameActive=v,"insert"===n&&(M.layerActive=f,ae("delete",t)),"delete"===n&&1!==s&&(M.layerActive=l-1,ae("insert",t,d)),"delete"===n&&1===s&&(ae("delete",t),ae("insert",t,d))),"frame"===t&&(M.layerActive=f,"insert"===n&&(M.frameActive=v,ae("delete",t)),"delete"===n&&1!==c&&(M.frameActive=i-1,ae("insert",t,d)),"delete"===n&&1===c&&(ae("delete",t),ae("insert",t,d)))}),z.render()},ie=function(e,t){var n="up"===t?-1:1,r="layer"===e?"layerActive":"frameActive",o="layer"===e?M.layerCount:M.frameCount;if(M[r]+n!==-1&&M[r]+n!==o){if("layer"===e){var a=M.layers[M.layerActive+n];M.layers[M.layerActive+n]=M.layers[M.layerActive],M.layers[M.layerActive]=a}"frame"===e&&M.layers.forEach((function(e){var t=e.frames[M.frameActive+n];e.frames[M.frameActive+n]=e.frames[M.frameActive],e.frames[M.frameActive]=t})),M[r]+=n,z.render()}},se=function(){M.frameActive=(M.frameActive+1)%M.frameCount,z.render(),z.timerID=setTimeout(se,100)},ce=function(){return d("div",{class:"bg-light bord-dark-t fl-column",style:"height: 250px;"},d("div",{class:"fl w-full bord-dark-b h-30"},d("div",{class:"fl fl-justify-between bord-dark-r",style:"width: 210px;"},d("div",{class:"fl"},d("button",{onClick:function(){M.layerCount<30&&le({type:"layer",request:"insert",requestType:"new"})},class:"w-30 fl fl-center bord-dark-r"},d("img",{src:"img/insert.svg"})),d("button",{onClick:function(){le({type:"layer",request:"insert",requestType:"clone"})},class:"w-30 fl fl-center bord-dark-r"},d("img",{src:"img/clone.svg"})),d("button",{onClick:function(){ie("layer","down")},class:"w-30 fl fl-center bord-dark-r"},d("img",{src:"img/up.svg"})),d("button",{onClick:function(){ie("layer","up")},class:"w-30 fl fl-center bord-dark-r"},d("img",{src:"img/down.svg"})),d("button",{onClick:function(){le({type:"layer",request:"delete"})},class:"w-30 fl fl-center bord-dark-r"},d("img",{src:"img/delete.svg"})))),d("div",{class:"fl fl-1"},d("div",{class:"fl"},d("button",{onClick:function(){z.onionSkinning=!z.onionSkinning,z.render()},class:"fl fl-center m-0 p-0 w-30 bord-dark-r",style:z.onionSkinning?"background: rgba(52, 152, 219, 255);":""},d("img",{src:"img/onion.svg"}))),d("div",{class:"fl-1 fl fl-justify-center"},d("div",{class:"fl"},d("button",{onClick:function(){M.frameActive=M.frameActive-1==-1?M.frameCount-1:M.frameActive-1,z.render()},class:"fl fl-center m-0 p-0 w-30 bord-dark-r bord-dark-l"},d("img",{src:"img/lastframe.svg"})),d("button",{onClick:function(){1!==M.frameCount&&(z.isPlaying?clearTimeout(z.timerID):se(),z.isPlaying=!z.isPlaying,z.render())},class:"fl fl-center m-0 p-0 w-30 bord-dark-r"},d("img",{src:"img/"+(z.isPlaying?"stop.svg":"play.svg")})),d("button",{onClick:function(){M.frameActive=(M.frameActive+1)%M.frameCount,z.render()},class:"fl fl-center m-0 p-0 w-30 bord-dark-r"},d("img",{src:"img/nextframe.svg"})))),d("div",{class:"fl"},d("button",{onClick:function(){!z.isPlaying&&M.frameCount<50&&le({type:"frame",request:"insert",requestType:"new"})},class:"w-30 fl fl-center bord-dark-r bord-dark-l"},d("img",{src:"img/insert.svg"})),d("button",{onClick:function(){le({type:"frame",request:"insert",requestType:"clone"})},class:"w-30 fl fl-center bord-dark-r"},d("img",{src:"img/clone.svg"})),d("button",{onClick:function(){z.isPlaying||ie("frame","up")},class:"w-30 fl fl-center bord-dark-r"},d("img",{src:"img/up.svg",style:"transform: rotate(-90deg);"})),d("button",{onClick:function(){z.isPlaying||ie("frame","down")},class:"w-30 fl fl-center bord-dark-r"},d("img",{src:"img/down.svg",style:"transform: rotate(-90deg);"})),d("button",{onClick:function(){z.isPlaying||le({type:"frame",request:"delete"})},class:"w-30 fl fl-center"},d("img",{src:"img/delete.svg"}))))),d("div",{class:"fl bg-mid",style:"height: calc(100% - 30px);"},d("div",{id:"layers",class:"overflow hide-scroll",style:"padding-bottom: 30px;"},d("div",{class:"bord-dark-r fl-col-reverse",style:"width: 210px;"},M.layers.map((function(e,t){return d("div",{class:"fl bord-dark-b h-30",style:"background: "+(M.layerActive===t?"rgb(100, 100, 100)":"")+";"},d("button",{style:e.hidden?"background: rgba(52, 152, 219, 255);":"",onClick:function(){!function(e){M.layers[e].hidden=!M.layers[e].hidden,z.render()}(t)},class:"w-30 h-30 fl fl-center bord-dark-b"},d("img",{src:"img/"+(e.hidden?"eye-active.svg":"eye.svg")})),d("button",{onClick:function(){oe(M.frameActive,t)},class:"fl-1 txt-left"},d("small",{style:"font-size: 11px;"},d("b",null,e.name))))})))),d("div",{id:"frames",class:"fl-1 overflow hide-scroll",style:"padding-bottom: 30px;"},d("canvas",{id:"timeline-canvas",style:"cursor: pointer;",onClick:function(e){var t=Math.floor(e.offsetX/30),n=M.layerCount-1-Math.floor(e.offsetY/30);oe(t,n)}}))))},ue=function(e,t,n,r,o){var a=Math.abs(n-e),l=Math.abs(r-t),i=n-e>=0?1:-1,s=r-t>=0?1:-1,c=e,u=t,d=a>=l?a:l;a/=d,l/=d;for(var f=0;f<d;)o(Math.floor(c),Math.floor(u)),c+=a*i,u+=l*s,f+=1;o(Math.floor(c),Math.floor(u))},de=function(e,t,n,r,o){var a=Math.floor(Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2)));if(!(a<=0)){var l=0,i=a,s=1-a,c=function(){o(e+l,t+i),o(e+i,t+l),o(e-l,t+i),o(e-i,t+l),o(e+l,t-i),o(e+i,t-l),o(e-l,t-i),o(e-i,t-l)};for(c();l<=i;)l++,s<0?s+=2*l+1:(i--,s+=2*(l-i)+1),c()}},fe=function(e,t,n,r,o){var a=Math.abs(n-e),l=Math.abs(r-t),i=n-e>=0?1:-1,s=r-t>=0?1:-1,c=e,u=t,d=0;for(o(c,u);d<a;)o(c+=1*i,t),o(c,t+l*s),d+=1;for(d=0;d<l;)o(e,u+=1*s),o(e+a*i,u),d+=1},ve=function(e){z.canvasPreview.ctx.clearRect(0,0,M.width,M.height),z.canvasPreview.imgData=z.canvasPreview.ctx.getImageData(0,0,M.width,M.height);var t=M.layers[M.layerActive].frames[M.frameActive].data,n=z.canvasPreview.imgData.data,r=z.canvasView.dom.getBoundingClientRect(),o=r.width/z.canvasView.dom.width,a=r.height/z.canvasView.dom.height,l=Math.floor((z.window.startX-r.x)/o),i=Math.floor((z.window.startY-r.y)/a),s=Math.floor((z.window.prevX-r.x)/o),c=Math.floor((z.window.prevY-r.y)/a),u=Math.floor((z.window.currX-r.x)/o),d=Math.floor((z.window.currY-r.y)/a),f=function(e,t,n,r,o,a){!function(e,t,n,r,o,a,l,i){for(var s=Math.abs(n-e),c=Math.abs(r-t),u=n-e>=0?1:-1,d=r-t>=0?1:-1,f=e,v=t,p=0,g=0;p<=s;){for(g=0,v=t;g<=c;)i(f,v),v+=1*d,g+=1;f+=1*u,p+=1}}(t-z.brushSize,n-z.brushSize,t+z.brushSize,n+z.brushSize,0,0,0,(function(t,n){!function(e,t,n,r,o,a){if(!e)throw Error("setPoint: "+e+" undefined");if(!e.length)throw Error("setPoint: "+e+" not a valid array");if(t>=0&&t<r&&n>=0&&n<o){var l=4*(t+r*n);e[l+0]=a[0],e[l+1]=a[1],e[l+2]=a[2],e[l+3]=a[3]}}(e,t,n,r,o,a)}))};if("hover"===e&&"eye-dropper"!==M.tool&&"move"!==M.tool)return f(n,u,d,M.width,M.height,"eraser"!==M.tool?M.color.rgb:[0,0,0,50]),void z.render();if("start"===e&&"eye-dropper"!==M.tool){var v=new ImageData(M.width,M.height);v.data.set(M.layers[M.layerActive].frames[M.frameActive].data);var p=M.layerActive,g=M.frameActive;Y(M.tool),z.currUndoRef.undo=function(){M.frameActive=g,M.layerActive=p,M.layers[p].frames[g].data.set(v.data)}}if("end"===e&&"eye-dropper"===M.tool){var h=function(e,t,n,r,o){if(!e)throw Error("setPoint: "+e+" undefined");if(!e.length)throw Error("setPoint: "+e+" not a valid array");if(t>=0&&t<r&&n>=0&&n<o){var a=4*(t+r*n);return[e[a+0],e[a+1],e[a+2],e[a+3]]}return[0,0,0,0]}(t,u,d,M.width,M.height);0!==h[3]&&B(h)}("end"===e&&"fill"===M.tool&&function(e,t,n,r,o,a){var l=4*(n*r+t),i=[{x:t,y:n}],s=function(e,t,n,r){var o=4*(n*r+t);return[e[o+0],e[o+1],e[o+2],e[o+3]]}(e,t,n,r);if(!function(e,t,n,r){return e[t+0]===n[r+0]&&e[t+1]===n[r+1]&&e[t+2]===n[r+2]&&e[t+3]===n[r+3]}(a,0,s,0))for(;i.length>0;){var c=i.shift(),u=c.x,d=c.y;for(l=4*(d*r+u);d-- >=0&&e[l+0]===s[0]&&e[l+1]===s[1]&&e[l+2]===s[2]&&e[l+3]===s[3];)l-=4*r;l+=4*r,d++;for(var f=!1,v=!1;d++<o&&e[l+0]===s[0]&&e[l+1]===s[1]&&e[l+2]===s[2]&&e[l+3]===s[3];)e[l+0]=a[0],e[l+1]=a[1],e[l+2]=a[2],e[l+3]=a[3],u>0&&(e[l-4+0]===s[0]&&e[l-4+1]===s[1]&&e[l-4+2]===s[2]&&e[l-4+3]===s[3]?f||(i.push({x:u-1,y:d}),f=!0):f&&(f=!1)),u<r-1&&(e[l+4+0]===s[0]&&e[l+4+1]===s[1]&&e[l+4+2]===s[2]&&e[l+4+3]===s[3]?v||(i.push({x:u+1,y:d}),v=!0):v&&(v=!1)),l+=4*r}}(t,u,d,M.width,M.height,M.color.rgb),"pencil"!==M.tool&&"eraser"!==M.tool||("eraser"===M.tool&&f(n,u,d,M.width,M.height,[0,0,0,50]),ue(s,c,u,d,(function(e,n){f(t,e,n,M.width,M.height,"pencil"===M.tool?M.color.rgb:[0,0,0,0])}))),"line"===M.tool||"circle"===M.tool||"square"===M.tool)&&{line:ue,circle:de,square:fe}[M.tool](l,i,u,d,(function(r,o){f("start"===e||"resume"===e?n:t,r,o,M.width,M.height,M.color.rgb)}));if("move"===M.tool&&("start"===e&&(z.canvasSelection.ctx.putImageData(M.layers[M.layerActive].frames[M.frameActive],0,0),z.canvasSelection.imgData=z.canvasSelection.ctx.getImageData(0,0,M.width,M.height),z.canvasPreview.ctx.putImageData(z.canvasSelection.imgData,0,0),z.canvasPreview.imgData=z.canvasPreview.ctx.getImageData(0,0,M.width,M.height),M.layers[M.layerActive].frames[M.frameActive]=new ImageData(M.width,M.height)),"resume"===e&&(z.canvasPreview.ctx.putImageData(z.canvasSelection.imgData,s-l,c-i),z.canvasPreview.imgData=z.canvasPreview.ctx.getImageData(0,0,M.width,M.height)),"end"===e&&(z.canvasPreview.ctx.putImageData(z.canvasSelection.imgData,s-l,c-i),z.canvasPreview.imgData=z.canvasPreview.ctx.getImageData(0,0,M.width,M.height),M.layers[M.layerActive].frames[M.frameActive]=z.canvasPreview.ctx.getImageData(0,0,M.width,M.height),z.canvasPreview.ctx.clearRect(0,0,M.width,M.height),z.canvasPreview.imgData=z.canvasPreview.ctx.getImageData(0,0,M.width,M.height))),"end"===e&&"eye-dropper"!==M.tool){var m=new ImageData(M.width,M.height);m.data.set(M.layers[M.layerActive].frames[M.frameActive].data);var w=M.layerActive,y=M.frameActive;z.currUndoRef.redo=function(){M.frameActive=y,M.layerActive=w,M.layers[w].frames[y].data.set(m.data)}}z.render()},pe=function(){return d("div",{id:"canvas-outer-scroll",class:"overflow fl-1 cursor-"+M.tool},d("div",{id:"canvas-inner-scroll","data-request":"paintCanvas","data-hover":"paintCanvas",class:"fl fl-center fl-1",style:"width: 1920px; height: 1920px;"},d("canvas",{id:"canvas-view",width:M.width,height:M.height,style:"width: 1920px; height: 1920px; transform: scale(.25); pointer-events: none;"})))},ge=function(){return d("div",{class:"h-40 bg-light bord-dark-b fl"},d("div",{class:"fl w-full"},d("div",{class:"fl-1 fl"},d("div",{class:"fl bord-dark-r rel w-40",onMouseLeave:function(){z.file.open=!1,z.render()}},d("button",{onClick:function(){z.file.open=!z.file.open,z.render()},class:"fl fl-center m-0 p-0 w-40"},d("img",{src:"img/bars.svg"})),d("div",{class:"bg-light fl-column bord-dark abs z-5",style:"visibility: "+(z.file.open?"visible":"hidden")+"; top: 10px; left: 10px;"},d("button",{onClick:function(){z.newCanvas.open=!0,z.file.open=!1,z.render()},class:"m-0 p-h-15 h-40 fl fl-center-y"},d("img",{src:"img/new.svg"}),d("small",{class:"bold p-h-10",style:"text-transform: capitalize;"},"New")),d("button",{onClick:function(){z.downloadCanvas.open=!0,z.file.open=!1,z.render()},class:"m-0 p-h-15 h-40 fl fl-center-y"},d("img",{src:"img/download.svg"}),d("small",{class:"bold p-h-10",style:"text-transform: capitalize;"},"download")))),d("div",{class:"fl-1 fl fl-justify-center"},d("button",{onClick:function(){R()},class:"fl fl-center m-0 p-0 w-40 bord-dark-l bord-dark-r"},d("img",{src:"img/undo.svg"})),d("button",{onClick:function(){U()},class:"fl fl-center m-0 p-0 w-40 bord-dark-r"},d("img",{src:"img/redo.svg"})))),d("div",{class:"fl",style:"max-width: 241px; min-width: 241px;"})))},he=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){var e=this;function t(){dataLayer.push(arguments)}z.render=function(){e.setState({},(function(){z.canvasTemp.ctx.clearRect(0,0,M.width,M.height),z.canvasFinal.ctx.clearRect(0,0,M.width,M.height),z.canvasView.ctx.clearRect(0,0,M.width,M.height),M.layers.forEach((function(e,t){if(z.canvasView.ctx.globalAlpha=1,!e.hidden){if(M.layerActive===t&&z.onionSkinning&&!z.isPlaying){z.canvasView.ctx.globalAlpha=.5;for(var n=-3;n<3;n++)if(e.frames[M.frameActive-n]){var r=e.frames[M.frameActive-n];z.canvasTemp.ctx.putImageData(r,0,0),z.canvasView.ctx.drawImage(z.canvasTemp.dom,0,0)}}z.canvasView.ctx.globalAlpha=1;for(var o=e.frames[M.frameActive],a=0;a<2;a++)z.canvasTemp.ctx.putImageData(o,0,0),z.canvasView.ctx.drawImage(z.canvasTemp.dom,0,0),M.layerActive===t&&(z.canvasTemp.ctx.putImageData(z.canvasPreview.imgData,0,0),z.canvasView.ctx.drawImage(z.canvasTemp.dom,0,0))}}));z.canvasTimeline.width=30*M.frameCount*2,z.canvasTimeline.height=30*M.layerCount*2,z.canvasTimeline.style.width=30*M.frameCount+"px",z.canvasTimeline.style.height=30*M.layerCount+"px";var e=z.canvasTimeline.getContext("2d");z.canvasTimelineTemp.width=30*M.frameCount*2,z.canvasTimelineTemp.height=30*M.layerCount*2;var t=z.canvasTimelineTemp.getContext("2d");M.layers.map((function(n,r){n.frames.map((function(n,o){var a=60,l=60*o,i=r*a,s=M.frameActive===o&&M.layerActive===r?"rgba(52, 152, 219, 255)":M.frameActive===o||M.layerActive===r?"rgba(100, 100, 100, 255)":"rgba(50, 50, 50, 255)";e.fillStyle="rgba(33, 33, 33, 255)",e.fillRect(l,(M.layerCount-1)*a-i,60,a),e.fillStyle=s,e.fillRect(l,(M.layerCount-1)*a-i,58,58),t.putImageData(n,l+5,(M.layerCount-1)*a-i+5,0,0,47,47)}))})),e.drawImage(z.canvasTimelineTemp,0,0)}))},q(),this.funcs={paintCanvas:ve},this.canvasOuterScroll=document.querySelector("#canvas-outer-scroll"),this.canvasInnerScroll=document.querySelector("#canvas-inner-scroll"),this.timelineScroll={isSyncingLeftScroll:!1,isSyncingRightScroll:!1,leftDiv:document.querySelector("#layers"),rightDiv:document.querySelector("#frames")},this.timelineScrollController(),this.centerCanvas(),window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","UA-144729452-1")},t.prototype.centerCanvas=function(){var e=this.canvasOuterScroll.offsetWidth,t=this.canvasInnerScroll.offsetWidth,n=this.canvasOuterScroll.offsetHeight,r=this.canvasInnerScroll.offsetHeight;this.canvasOuterScroll.scrollLeft=Math.floor((t-e)/2)+8,this.canvasOuterScroll.scrollTop=Math.floor((r-n)/2)+8},t.prototype.timelineScrollController=function(){var e=this;this.timelineScroll.leftDiv.addEventListener("scroll",(function(t){e.timelineScroll.isSyncingLeftScroll||(e.timelineScroll.isSyncingRightScroll=!0,e.timelineScroll.rightDiv.scrollTop=t.target.scrollTop),e.timelineScroll.isSyncingLeftScroll=!1})),this.timelineScroll.rightDiv.addEventListener("scroll",(function(t){e.timelineScroll.isSyncingRightScroll||(e.timelineScroll.isSyncingLeftScroll=!0,e.timelineScroll.leftDiv.scrollTop=t.target.scrollTop),e.timelineScroll.isSyncingRightScroll=!1}))},t.prototype.onGestureDown=function(e){z.isPlaying||(z.window.request=e.target.dataset.request||""),z.window.mouseDown=!0,z.window.startX=void 0===e.pageX?e.touches[0].pageX:e.pageX,z.window.startY=void 0===e.pageY?e.touches[0].pageY:e.pageY,z.window.prevX=void 0===e.pageX?e.touches[0].pageX:e.pageX,z.window.prevY=void 0===e.pageY?e.touches[0].pageY:e.pageY,z.window.currX=void 0===e.pageX?e.touches[0].pageX:e.pageX,z.window.currY=void 0===e.pageY?e.touches[0].pageY:e.pageY,z.window.request&&this.funcs[z.window.request]("start")},t.prototype.onGestureDrag=function(e){z.isPlaying||(z.window.prevX=z.window.currX),z.window.prevY=z.window.currY,z.window.currX=void 0===e.pageX?e.touches[0].pageX:e.pageX,z.window.currY=void 0===e.pageY?e.touches[0].pageY:e.pageY,z.window.request&&this.funcs[z.window.request]("resume"),"INPUT"!==e.target.tagName&&e.preventDefault()},t.prototype.onGestureEnd=function(e){z.isPlaying||z.window.request&&this.funcs[z.window.request]("end"),z.window.request="",z.window.mouseDown=!1,z.window.startX=0,z.window.startY=0,z.window.prevX=0,z.window.prevY=0,z.window.currX=0,z.window.currY=0},t.prototype.onGestureHover=function(e){z.isPlaying||(z.window.prevX=z.window.currX),z.window.prevY=z.window.currY,z.window.currX=void 0===e.pageX?e.touches[0].pageX:e.pageX,z.window.currY=void 0===e.pageY?e.touches[0].pageY:e.pageY,e.target.dataset.hover&&this.funcs[e.target.dataset.hover]("hover")},t.prototype.dragOrHover=function(e){z.window.mouseDown?this.onGestureDrag(e):this.onGestureHover(e)},t.prototype.render=function(){var e=this;return d("div",{class:"h-full relative",onMouseDown:function(t){1===t.which&&e.onGestureDown(t)},onMouseMove:function(t){e.dragOrHover(t)},onMouseUp:function(t){e.onGestureEnd(t)},onMouseLeave:function(t){e.onGestureEnd(t)}},d(ge,null),d("div",{class:"fl",style:"height: calc(100% - 40px); "},d(O,null),d("div",{class:"fl-column",style:"width: calc(100% - 281px);"},d(pe,null),d(ce,null)),d("div",{class:"bg-light bord-dark-l fl-column",style:"max-width: 241px; min-width: 241px;"},d("div",{class:"bord-dark-b fl-column overflow"},d("div",{class:"h-30 bg-mid bord-dark-b fl fl-center-y p-h-10"},d("small",null,d("b",null,"Tool"))),d("div",{class:"fl-1 overflow"},d("div",{class:"fl fl-center p-10"},d("small",{style:"width: 150px; font-size: 11px;"},"Brush Size"),d("div",{class:"fl-1 select"},d("select",{onInput:function(e){z.brushSize=parseInt(e.target.value)},value:z.brushSize,class:"w-full"},[1,2,3,4,5,6,7,8,9,10].map((function(e,t){return d("option",{value:t},e)}))))))),d(re,null),d("div",{class:"bord-dark-b fl-column overflow",style:"min-height: 249px; max-height: 249px;"},d("div",{class:"h-30 bg-mid bord-dark-b fl fl-center-y p-h-10"},d("small",null,d("b",null,"History"))),d("div",{class:"fl-1 overflow"},z.undo.map((function(e,t){return d("button",{class:"p-h-10 h-30 w-full txt-left fl fl-center-y no-ptr "+(z.undoPos===t?"bg-xlight":"")},d("img",{width:"10",height:"10",style:"margin-right: 10px;",src:"img/"+e.icon}),d("small",{style:"text-transform: capitalize; font-size: 11px;"},d("b",null,e.action)))})))))),z.newCanvas.open&&d("div",{class:"abs top left w-full h-full fl fl-justify-center",style:"z-index: 10;"},d("div",{class:"w-full overflow-hidden",style:"max-width: 300px; margin-top: 175px;"},d("div",{class:"fl fl-center bg-mid bord-dark p-v-5",style:"border-top-right-radius: 5px; border-top-left-radius: 5px;"},d("small",null,d("b",null,"New Canvas"))),d("div",{class:"p-10 bg-light bord-dark-l bord-dark-r bord-dark-b",style:"border-bottom-right-radius: 5px; border-bottom-left-radius: 5px;"},d("div",{class:"m-5 p-v-5"},d("div",{class:"fl fl-center"},d("small",{class:"bold",style:"width: 100px;"},"Dimensions"),d("div",{class:"fl-1 select"},d("select",{onInput:function(e){var t=e.target.value.split("x");z.newCanvas.w=parseInt(t[0]),z.newCanvas.h=parseInt(t[1])},class:"w-full"},d("option",{value:"32x32"},"32x32"),d("option",{value:"50x50"},"50x50"),d("option",{value:"64x64"},"64x64"),d("option",{value:"100x100"},"100x100"),d("option",{value:"128x128"},"128x128"))))),d("div",{class:"fl",style:"padding-top: 5px;"},d("button",{onClick:function(){z.newCanvas.open=!1,z.render()},class:"b-r-2 bold p-5 w-full bg-red m-5"},"Cancel"),d("button",{onClick:function(){X(z.newCanvas.w,z.newCanvas.h),z.newCanvas.open=!1,z.render()},class:"b-r-2 bold p-5 w-full bg-green m-5"},"Confirm"))))),z.downloadCanvas.open&&d("div",{class:"abs top left w-full h-full fl fl-center-x",style:"z-index: 10;"},d("div",{class:"w-full",style:"max-width: 300px; overflow: hidden; margin-top: 175px;"},d("div",{class:"fl fl-center bg-mid bord-dark p-v-5",style:"border-top-right-radius: 5px; border-top-left-radius: 5px;"},d("small",{class:"bold"},"Download")),d("div",{class:"p-10 bg-light bord-dark-l bord-dark-r bord-dark-b",style:"border-bottom-right-radius: 5px; border-bottom-left-radius: 5px;"},d("div",{class:"m-5 p-v-5"},d("div",{class:"fl fl-center"},d("small",{class:"bold",style:"width: 100px;"},"Type"),d("div",{class:"fl-1 select"},d("select",{onInput:function(e){z.downloadCanvas.type=e.target.value},value:z.downloadCanvas.type,id:"config-download-size",class:"w-full"},d("option",{value:"frame"},"Frame"),d("option",{value:"spritesheet"},"Spritesheet"),d("option",{value:"numgrid"},"Number Grid"))))),d("div",{class:"m-5 p-v-5"},d("div",{class:"fl fl-center"},d("small",{class:"bold",style:"width: 100px;"},"Size"),d("div",{class:"fl-1 select"},d("select",{onInput:function(e){z.downloadCanvas.size=parseInt(e.target.value)},value:z.downloadCanvas.size,id:"config-download-size",class:"w-full"},d("option",{value:"2"},"2x"),d("option",{value:"4"},"4x"),d("option",{value:"8"},"8x"),d("option",{value:"16"},"16x"),d("option",{value:"32"},"32x"),d("option",{value:"64"},"64x"))))),d("div",{class:"fl",style:"padding-top: 5px;"},d("button",{onClick:function(){z.downloadCanvas.open=!1,z.render()},class:"b-r-2 bold p-5 w-full bg-red m-5"},"Cancel"),d("a",{onClick:function(e){!function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=M.height*z.downloadCanvas.size,o=M.width*z.downloadCanvas.size;if("frame"===z.downloadCanvas.type){t.width=o,t.height=r,n.webkitImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1,M.layers.forEach((function(e){z.canvasTemp.ctx.putImageData(e.frames[M.frameActive],0,0),n.drawImage(z.canvasView.dom,0,0,t.width,t.height)}));var a=t.toDataURL("image/png").replace("image/png","image/octet-stream");e.target.setAttribute("href",a)}if("spritesheet"===z.downloadCanvas.type){var l=M.width*z.downloadCanvas.size*M.frameCount;t.width=l,t.height=r,n.webkitImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1;for(var i=function(e){M.layers.forEach((function(t){z.canvasTemp.ctx.putImageData(t.frames[e],0,0),n.drawImage(z.canvasTemp.dom,e*o,0,o,r)}))},s=0;s<M.frameCount;s++)i(s);var c=t.toDataURL("image/png").replace("image/png","image/octet-stream");e.target.setAttribute("href",c)}if("numgrid"===z.downloadCanvas.type){t.width=M.width,t.height=M.height,n.webkitImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1,M.layers.forEach((function(e){z.canvasTemp.ctx.putImageData(e.frames[M.frameActive],0,0),n.drawImage(z.canvasView.dom,0,0,t.width,t.height)}));var u=n.getImageData(0,0,t.width,t.height);console.log(u.data.length);var d=document.createElement("canvas");d.width=40*M.width,d.height=40*M.height;for(var f=d.getContext("2d"),v=0,p=function(e){var t=v%M.width,n=Math.floor(v/M.height);M.palette.forEach((function(r,o){(function(e,t,n,r){return e[t+0]===n[r+0]&&e[t+1]===n[r+1]&&e[t+2]===n[r+2]&&e[t+3]===n[r+3]})(r,0,[u.data[e+0],u.data[e+1],u.data[e+2],u.data[e+3]],0)&&(console.log(t,n),f.font="20px serif",f.fillText(o,40*t+15,40*(n+1)-15),f.strokeStyle="black",f.strokeRect(40*t,40*n,40,40))})),v+=1},g=0;g<u.data.length;g+=4)p(g);var h=d.toDataURL("image/png").replace("image/png","image/octet-stream");e.target.setAttribute("href",h)}}(e)},class:"w-full m-5 clickable",download:"pixel-art.png",style:"display: inline-block;"},d("button",{class:"b-r-2 bold p-5 w-full bg-green no-ptr"},"Download")))))))},t}(p),me=function(){setTimeout((function(){console.time("startwrite"),localforage.setItem("pixel-art-app",M).then((function(e){console.timeEnd("startwrite")})).catch((function(e){console.log(e)}))}),50)};window.addEventListener("load",(function(){var t,n,r;console.log("Program started."),X(64,64,!0),function(t,n,r){var o,s,c;e.__&&e.__(t,n),s=(o=r===a)?null:r&&r.__k||n.__k,t=d(v,null,[t]),c=[],C(n,(o?n:r||n).__k=t,s||l,l,void 0!==n.ownerSVGElement,r&&!o?[r]:s?null:i.slice.call(n.childNodes),c,r||l,o),S(c,t)}(d(he,null),document.body),n=(t={onLoaded:function(){q(),z.render()},onError:function(){}}).onLoaded,r=t.onError,localforage.getItem("pixel-art-app").then((function(e){for(var t in e)M[t]=e[t];n()})).catch((function(e){console.log(e),r()})),window.addEventListener("keydown",(function(e){if("INPUT"!==e.target.tagName){var t=e.key.toLowerCase();e.repeat||"meta"!==t||(K=Date.now()),e.repeat||"shift"!==t||(F=Date.now()),e.repeat||"z"!==t||(G=Date.now()),e.shiftKey&&e.metaKey&&F<K<G&&"z"===t&&V.shiftKey.metaKey.z(),!e.shiftKey&&e.metaKey&&K<G&&"z"===t&&V.metaKey.z(),e.shiftKey&&e.metaKey,e.shiftKey||e.metaKey||!V[e.key.toLowerCase()]||V[e.key.toLowerCase()]()}})),window.addEventListener("keyup",me),window.addEventListener("mouseup",me)})),"PROD"===E&&window.addEventListener("beforeunload",(function(e){e.returnValue="Are you sure you want to leave?"}));
//# sourceMappingURL=bundle.js.map
