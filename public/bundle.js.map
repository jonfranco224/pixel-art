{"version":3,"file":"bundle.js","sources":["../node_modules/preact/dist/preact.module.js","../app/utils.js","../app/state.js","../app/undo-redo.js","../app/components/toolbar.js","../app/keyboard.js","../app/components/color.js","../app/components/timeline.js","../app/components/canvas.js","../app/components/header.js","../app/index.js"],"sourcesContent":["var n,l,u,i,t,o,r,f={},e=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function s(n,l){for(var u in l)n[u]=l[u];return n}function a(n){var l=n.parentNode;l&&l.removeChild(n)}function v(n,l,u){var i,t,o,r=arguments,f={};for(o in l)\"key\"==o?i=l[o]:\"ref\"==o?t=l[o]:f[o]=l[o];if(arguments.length>3)for(u=[u],o=3;o<arguments.length;o++)u.push(r[o]);if(null!=u&&(f.children=u),\"function\"==typeof n&&null!=n.defaultProps)for(o in n.defaultProps)void 0===f[o]&&(f[o]=n.defaultProps[o]);return h(n,f,i,t,null)}function h(l,u,i,t,o){var r={type:l,props:u,key:i,ref:t,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++n.__v:o};return null!=n.vnode&&n.vnode(r),r}function y(){return{current:null}}function p(n){return n.children}function d(n,l){this.props=n,this.context=l}function _(n,l){if(null==l)return n.__?_(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?_(n):null}function w(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return w(n)}}function k(l){(!l.__d&&(l.__d=!0)&&u.push(l)&&!g.__r++||t!==n.debounceRendering)&&((t=n.debounceRendering)||i)(g)}function g(){for(var n;g.__r=u.length;)n=u.sort(function(n,l){return n.__v.__b-l.__v.__b}),u=[],n.some(function(n){var l,u,i,t,o,r,f;n.__d&&(r=(o=(l=n).__v).__e,(f=l.__P)&&(u=[],(i=s({},o)).__v=o.__v+1,t=$(f,o,i,l.__n,void 0!==f.ownerSVGElement,null!=o.__h?[r]:null,u,null==r?_(o):r,o.__h),j(u,o),t!=r&&w(o)))})}function m(n,l,u,i,t,o,r,c,s,v){var y,d,w,k,g,m,b,A=i&&i.__k||e,P=A.length;for(s==f&&(s=null!=r?r[0]:P?_(i,0):null),u.__k=[],y=0;y<l.length;y++)if(null!=(k=u.__k[y]=null==(k=l[y])||\"boolean\"==typeof k?null:\"string\"==typeof k||\"number\"==typeof k?h(null,k,null,null,k):Array.isArray(k)?h(p,{children:k},null,null,null):null!=k.__e||null!=k.__c?h(k.type,k.props,k.key,null,k.__v):k)){if(k.__=u,k.__b=u.__b+1,null===(w=A[y])||w&&k.key==w.key&&k.type===w.type)A[y]=void 0;else for(d=0;d<P;d++){if((w=A[d])&&k.key==w.key&&k.type===w.type){A[d]=void 0;break}w=null}g=$(n,k,w=w||f,t,o,r,c,s,v),(d=k.ref)&&w.ref!=d&&(b||(b=[]),w.ref&&b.push(w.ref,null,k),b.push(d,k.__c||g,k)),null!=g?(null==m&&(m=g),s=x(n,k,w,A,r,g,s),v||\"option\"!=u.type?\"function\"==typeof u.type&&(u.__d=s):n.value=\"\"):s&&w.__e==s&&s.parentNode!=n&&(s=_(w))}if(u.__e=m,null!=r&&\"function\"!=typeof u.type)for(y=r.length;y--;)null!=r[y]&&a(r[y]);for(y=P;y--;)null!=A[y]&&L(A[y],A[y]);if(b)for(y=0;y<b.length;y++)I(b[y],b[++y],b[++y])}function b(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(Array.isArray(n)?n.some(function(n){b(n,l)}):l.push(n)),l}function x(n,l,u,i,t,o,r){var f,e,c;if(void 0!==l.__d)f=l.__d,l.__d=void 0;else if(t==u||o!=r||null==o.parentNode)n:if(null==r||r.parentNode!==n)n.appendChild(o),f=null;else{for(e=r,c=0;(e=e.nextSibling)&&c<i.length;c+=2)if(e==o)break n;n.insertBefore(o,r),f=r}return void 0!==f?f:o.nextSibling}function A(n,l,u,i,t){var o;for(o in u)\"children\"===o||\"key\"===o||o in l||C(n,o,null,u[o],i);for(o in l)t&&\"function\"!=typeof l[o]||\"children\"===o||\"key\"===o||\"value\"===o||\"checked\"===o||u[o]===l[o]||C(n,o,l[o],u[o],i)}function P(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=null==u?\"\":\"number\"!=typeof u||c.test(l)?u:u+\"px\"}function C(n,l,u,i,t){var o,r,f;if(t&&\"className\"==l&&(l=\"class\"),\"style\"===l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof i&&(n.style.cssText=i=\"\"),i)for(l in i)u&&l in u||P(n.style,l,\"\");if(u)for(l in u)i&&u[l]===i[l]||P(n.style,l,u[l])}else\"o\"===l[0]&&\"n\"===l[1]?(o=l!==(l=l.replace(/Capture$/,\"\")),(r=l.toLowerCase())in n&&(l=r),l=l.slice(2),n.l||(n.l={}),n.l[l+o]=u,f=o?N:z,u?i||n.addEventListener(l,f,o):n.removeEventListener(l,f,o)):\"list\"!==l&&\"tagName\"!==l&&\"form\"!==l&&\"type\"!==l&&\"size\"!==l&&\"download\"!==l&&\"href\"!==l&&!t&&l in n?n[l]=null==u?\"\":u:\"function\"!=typeof u&&\"dangerouslySetInnerHTML\"!==l&&(l!==(l=l.replace(/xlink:?/,\"\"))?null==u||!1===u?n.removeAttributeNS(\"http://www.w3.org/1999/xlink\",l.toLowerCase()):n.setAttributeNS(\"http://www.w3.org/1999/xlink\",l.toLowerCase(),u):null==u||!1===u&&!/^ar/.test(l)?n.removeAttribute(l):n.setAttribute(l,u))}function z(l){this.l[l.type+!1](n.event?n.event(l):l)}function N(l){this.l[l.type+!0](n.event?n.event(l):l)}function T(n,l,u){var i,t;for(i=0;i<n.__k.length;i++)(t=n.__k[i])&&(t.__=n,t.__e&&(\"function\"==typeof t.type&&t.__k.length>1&&T(t,l,u),l=x(u,t,t,n.__k,null,t.__e,l),\"function\"==typeof n.type&&(n.__d=l)))}function $(l,u,i,t,o,r,f,e,c){var a,v,h,y,_,w,k,g,b,x,A,P=u.type;if(void 0!==u.constructor)return null;null!=i.__h&&(c=i.__h,e=u.__e=i.__e,u.__h=null,r=[e]),(a=n.__b)&&a(u);try{n:if(\"function\"==typeof P){if(g=u.props,b=(a=P.contextType)&&t[a.__c],x=a?b?b.props.value:a.__:t,i.__c?k=(v=u.__c=i.__c).__=v.__E:(\"prototype\"in P&&P.prototype.render?u.__c=v=new P(g,x):(u.__c=v=new d(g,x),v.constructor=P,v.render=M),b&&b.sub(v),v.props=g,v.state||(v.state={}),v.context=x,v.__n=t,h=v.__d=!0,v.__h=[]),null==v.__s&&(v.__s=v.state),null!=P.getDerivedStateFromProps&&(v.__s==v.state&&(v.__s=s({},v.__s)),s(v.__s,P.getDerivedStateFromProps(g,v.__s))),y=v.props,_=v.state,h)null==P.getDerivedStateFromProps&&null!=v.componentWillMount&&v.componentWillMount(),null!=v.componentDidMount&&v.__h.push(v.componentDidMount);else{if(null==P.getDerivedStateFromProps&&g!==y&&null!=v.componentWillReceiveProps&&v.componentWillReceiveProps(g,x),!v.__e&&null!=v.shouldComponentUpdate&&!1===v.shouldComponentUpdate(g,v.__s,x)||u.__v===i.__v){v.props=g,v.state=v.__s,u.__v!==i.__v&&(v.__d=!1),v.__v=u,u.__e=i.__e,u.__k=i.__k,v.__h.length&&f.push(v),T(u,e,l);break n}null!=v.componentWillUpdate&&v.componentWillUpdate(g,v.__s,x),null!=v.componentDidUpdate&&v.__h.push(function(){v.componentDidUpdate(y,_,w)})}v.context=x,v.props=g,v.state=v.__s,(a=n.__r)&&a(u),v.__d=!1,v.__v=u,v.__P=l,a=v.render(v.props,v.state,v.context),v.state=v.__s,null!=v.getChildContext&&(t=s(s({},t),v.getChildContext())),h||null==v.getSnapshotBeforeUpdate||(w=v.getSnapshotBeforeUpdate(y,_)),A=null!=a&&a.type==p&&null==a.key?a.props.children:a,m(l,Array.isArray(A)?A:[A],u,i,t,o,r,f,e,c),v.base=u.__e,u.__h=null,v.__h.length&&f.push(v),k&&(v.__E=v.__=null),v.__e=!1}else null==r&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=H(i.__e,u,i,t,o,r,f,c);(a=n.diffed)&&a(u)}catch(l){u.__v=null,(c||null!=r)&&(u.__e=e,u.__h=!!c,r[r.indexOf(e)]=null),n.__e(l,u,i)}return u.__e}function j(l,u){n.__c&&n.__c(u,l),l.some(function(u){try{l=u.__h,u.__h=[],l.some(function(n){n.call(u)})}catch(l){n.__e(l,u.__v)}})}function H(n,l,u,i,t,o,r,c){var s,a,v,h,y,p=u.props,d=l.props;if(t=\"svg\"===l.type||t,null!=o)for(s=0;s<o.length;s++)if(null!=(a=o[s])&&((null===l.type?3===a.nodeType:a.localName===l.type)||n==a)){n=a,o[s]=null;break}if(null==n){if(null===l.type)return document.createTextNode(d);n=t?document.createElementNS(\"http://www.w3.org/2000/svg\",l.type):document.createElement(l.type,d.is&&{is:d.is}),o=null,c=!1}if(null===l.type)p===d||c&&n.data===d||(n.data=d);else{if(null!=o&&(o=e.slice.call(n.childNodes)),v=(p=u.props||f).dangerouslySetInnerHTML,h=d.dangerouslySetInnerHTML,!c){if(null!=o)for(p={},y=0;y<n.attributes.length;y++)p[n.attributes[y].name]=n.attributes[y].value;(h||v)&&(h&&(v&&h.__html==v.__html||h.__html===n.innerHTML)||(n.innerHTML=h&&h.__html||\"\"))}A(n,d,p,t,c),h?l.__k=[]:(s=l.props.children,m(n,Array.isArray(s)?s:[s],l,u,i,\"foreignObject\"!==l.type&&t,o,r,f,c)),c||(\"value\"in d&&void 0!==(s=d.value)&&(s!==n.value||\"progress\"===l.type&&!s)&&C(n,\"value\",s,p.value,!1),\"checked\"in d&&void 0!==(s=d.checked)&&s!==n.checked&&C(n,\"checked\",s,p.checked,!1))}return n}function I(l,u,i){try{\"function\"==typeof l?l(u):l.current=u}catch(l){n.__e(l,i)}}function L(l,u,i){var t,o,r;if(n.unmount&&n.unmount(l),(t=l.ref)&&(t.current&&t.current!==l.__e||I(t,null,u)),i||\"function\"==typeof l.type||(i=null!=(o=l.__e)),l.__e=l.__d=void 0,null!=(t=l.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(l){n.__e(l,u)}t.base=t.__P=null}if(t=l.__k)for(r=0;r<t.length;r++)t[r]&&L(t[r],u,i);null!=o&&a(o)}function M(n,l,u){return this.constructor(n,u)}function O(l,u,i){var t,r,c;n.__&&n.__(l,u),r=(t=i===o)?null:i&&i.__k||u.__k,l=v(p,null,[l]),c=[],$(u,(t?u:i||u).__k=l,r||f,f,void 0!==u.ownerSVGElement,i&&!t?[i]:r?null:u.childNodes.length?e.slice.call(u.childNodes):null,c,i||f,t),j(c,l)}function S(n,l){O(n,l,o)}function q(n,l,u){var i,t,o,r=arguments,f=s({},n.props);for(o in l)\"key\"==o?i=l[o]:\"ref\"==o?t=l[o]:f[o]=l[o];if(arguments.length>3)for(u=[u],o=3;o<arguments.length;o++)u.push(r[o]);return null!=u&&(f.children=u),h(n.type,f,i||n.key,t||n.ref,null)}function B(n,l){var u={__c:l=\"__cC\"+r++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n,u,i){return this.getChildContext||(u=[],(i={})[l]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(n){this.props.value!==n.value&&u.some(k)},this.sub=function(n){u.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u.splice(u.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Provider.__=u.Consumer.contextType=u}n={__e:function(n,l){for(var u,i,t,o=l.__h;l=l.__;)if((u=l.__c)&&!u.__)try{if((i=u.constructor)&&null!=i.getDerivedStateFromError&&(u.setState(i.getDerivedStateFromError(n)),t=u.__d),null!=u.componentDidCatch&&(u.componentDidCatch(n),t=u.__d),t)return l.__h=o,u.__E=u}catch(l){n=l}throw n},__v:0},l=function(n){return null!=n&&void 0===n.constructor},d.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=s({},this.state),\"function\"==typeof n&&(n=n(s({},u),this.props)),n&&s(u,n),null!=n&&this.__v&&(l&&this.__h.push(l),k(this))},d.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),k(this))},d.prototype.render=p,u=[],i=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,g.__r=0,o=f,r=0;export{O as render,S as hydrate,v as createElement,v as h,p as Fragment,y as createRef,l as isValidElement,d as Component,q as cloneElement,B as createContext,b as toChildArray,L as __u,n as options};\n//# sourceMappingURL=preact.module.js.map\n","\nexport const RGBtoHSL = (rgb) => {\n  // Make r, g, and b fractions of 1\n  let r = rgb[0] / 255\n  let g = rgb[1] / 255\n  let b = rgb[2] / 255\n\n  // Find greatest and smallest channel values\n  let cmin = Math.min(r, g, b)\n  let cmax = Math.max(r, g, b)\n  let delta = cmax - cmin\n  let h = 0\n  let s = 0\n  let l = 0\n\n  if (delta === 0) {\n    h = 0\n  } else if (cmax === r) {\n    h = ((g - b) / delta) % 6\n  } else if (cmax === g) {\n    h = (b - r) / delta + 2\n  } else {\n    h = (r - g) / delta + 4\n  }\n\n  h = Math.round(h * 60)\n\n  // Make negative hues positive behind 360Â°\n  if (h < 0) h += 360\n\n  l = (cmax + cmin) / 2\n\n  // Calculate saturation\n  s = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))\n\n  // Multiply l and s by 100\n  s = +(s * 100).toFixed(1)\n  l = +(l * 100).toFixed(1)\n\n  return [ Math.floor(h), Math.floor(s), Math.floor(l), 255 ]\n}\n\nexport const HSLtoRGB = (hsl) => {\n  const h = hsl[0]\n  const s = hsl[1] / 100\n  const l = hsl[2] / 100\n\n  let c = (1 - Math.abs(2 * l - 1)) * s\n  let x = c * (1 - Math.abs((hsl[0] / 60) % 2 - 1))\n  let m = l - c / 2\n  let r = 0\n  let g = 0\n  let b = 0\n\n  if (h >= 0 && h < 60) {\n    r = c; g = x; b = 0\n  } else if (h >= 60 && h < 120) {\n    r = x; g = c; b = 0\n  } else if (h >= 120 && h < 180) {\n    r = 0; g = c; b = x\n  } else if (h >= 180 && h < 240) {\n    r = 0; g = x; b = c\n  } else if (h >= 240 && h < 300) {\n    r = x; g = 0; b = c\n  } else if (h >= 300 && h < 360) {\n    r = c; g = 0; b = x\n  }\n\n  r = Math.round((r + m) * 255)\n  g = Math.round((g + m) * 255)\n  b = Math.round((b + m) * 255)\n\n  return [ r, g, b, 255 ]\n}","import { RGBtoHSL } from './utils'\n\nexport const ENV = window.location.href.includes('localhost:4000') ? 'DEV' : 'PROD'\nexport const APP = {}\nexport const VIEW = { render: undefined }\nexport const canvases = ['canvasSelection', 'canvasPreview', 'canvasTemp', 'canvasFinal', 'canvasView']\n\nconst initAppDefault = (w, h) => {\n  APP.width = w\n  APP.height = h\n  APP.tool = 'pencil'\n\n  APP.frameActive = 0\n  APP.layerActive = 0\n  APP.frameCount = 1 \n  APP.layerCount = 1  \n  APP.layers = [\n    {\n      name: 'Layer 1',\n      hidden: false,\n      frames: [new ImageData(w, h)]\n    }\n  ]\n  \n  APP.color = {}\n  APP.color.rgb = [100, 188, 156, 255]\n  APP.color.hsl = RGBtoHSL(APP.color.rgb)\n\n  APP.palette = [\n    [26, 188, 156, 255],\n    [46, 204, 113, 255],\n    [52, 152, 219, 255],\n    [155, 89, 182, 255],\n    [52, 73, 94, 255],\n    [22, 160, 133, 255],\n    [39, 174, 96, 255],\n    [41, 128, 185, 255],\n    [142, 68, 173, 255],\n    [44, 62, 80, 255],\n    [241, 196, 15, 255],\n    [230, 126, 34, 255],\n    [231, 76, 60, 255],\n    [236, 240, 241, 255],\n    [149, 165, 166, 255],\n    [243, 156, 18, 255],\n    [211, 84, 0, 255],\n    [192, 57, 43, 255],\n    [189, 195, 199, 255],\n    [127, 140, 141, 255]\n  ]\n  \n  Object.seal(APP)\n}\n\nexport const initCanvases = () => {\n  canvases.forEach(canvas => {\n    VIEW[canvas].dom = canvas === 'canvasView' ? document.querySelector('#canvas-view') : document.createElement('canvas')\n    VIEW[canvas].dom.width = APP.width\n    VIEW[canvas].dom.height = APP.height\n    VIEW[canvas].ctx = VIEW[canvas].dom.getContext('2d')\n    VIEW[canvas].imgData = VIEW[canvas].ctx.getImageData(0, 0, APP.width, APP.height)\n  })\n\n  VIEW.canvasTimeline = document.querySelector('#timeline-canvas')\n  VIEW.canvasTimelineTemp = document.createElement('canvas')\n}\n\nconst initViewDefault = (preventOnMount) => {\n  VIEW.activeInput = {\n    id: '',\n    val: ''\n  }\n\n  VIEW.window = {\n    request: '',\n    mouseDown: false,\n    startX: 0,\n    startY: 0,\n    prevX: 0,\n    prevY: 0,\n    currX: 0,\n    currY: 0\n  }\n\n  VIEW.file = { open: false }\n  VIEW.newCanvas = { open: false, w: 32, h: 32 }\n  VIEW.downloadCanvas = { open: false, size: 2, type: 'frame' }\n\n  VIEW.brushSize = 0\n\n  VIEW.timerID = undefined\n  VIEW.isPlaying = false\n  VIEW.onionSkinning = false\n\n  VIEW.undo = []\n  VIEW.undoPos = -1\n  VIEW.currUndoRef = {}\n  \n  VIEW.canvasTimeline = undefined\n  VIEW.canvasTimelineTemp = undefined\n\n  // need to reset these on new project\n  canvases.forEach(canvas => {\n    VIEW[canvas] = {\n      dom: undefined,\n      ctx: undefined,\n      imgData: undefined\n    }\n  })\n\n  if (preventOnMount !== true) {\n    initCanvases()\n  }\n\n  Object.seal(VIEW)\n}\n\nexport const newData = (w, h, preventOnMount) => {\n  initAppDefault(w, h)\n  initViewDefault(preventOnMount)\n}","import { VIEW } from './state'\n\nexport const addToUndo = (action, type = '') => {\n  VIEW.undo.splice(0, VIEW.undoPos + 1, {\n    icon: `${action}.svg`,\n    action: `${action} ${type}`,\n    undo: undo,\n    redo: redo\n  })\n\n  if (VIEW.undoPos >= 0) VIEW.undoPos = -1  \n  if (VIEW.undo.length > 50) VIEW.undo.pop()\n\n  VIEW.currUndoRef = VIEW.undo[VIEW.undoPos + 1]\n}\n\nexport const undo = () => {\n  if (VIEW.undoPos + 1 === VIEW.undo.length) return\n\n  VIEW.undoPos += 1\n  VIEW.undo[VIEW.undoPos].undo()\n\n  VIEW.render()\n}\n\nexport const redo = () => {\n  if (VIEW.undoPos - 1 === -2) return\n\n  if (VIEW.undo[VIEW.undoPos].redo) VIEW.undo[VIEW.undoPos].redo()\n  VIEW.undoPos -= 1\n\n  VIEW.render()\n}","import { h } from 'preact'\nimport { APP, VIEW } from '../state'\n\nexport const setTool = (tool) => {\n  APP.tool = tool\n  VIEW.render()\n}\n\nexport const Toolbar = () => {\n  return <div class='w-40 bg-light bord-dark-r'>\n    {\n      ['pencil', 'eraser', 'line', 'circle', 'square', 'fill', 'eye-dropper', 'move'].map(tool => \n        <button\n          onClick={() => { setTool(tool) }}\n          class=\"fl fl-center m-0 p-0 w-40 h-40 bord-dark-r\"\n          style={`${APP.tool === tool ? 'background: rgba(52, 152, 219, 255);' : ''}`}>\n          <img src={`img/${tool}.svg`} />\n        </button>\n      )\n    }\n  </div>\n}\n\n","import { undo, redo } from './undo-redo'\nimport { setTool } from './components/toolbar'\n\nconst keyMap = {\n  metaKey: {\n    z: undo\n  },\n  shiftKey: {\n    metaKey: {\n      z: redo\n    }\n  },\n  b: () => {\n    setTool('pencil')\n  },\n  e: () => {\n    setTool('eraser')\n  },\n  u: () => {\n    setTool('line')\n  },\n  g: () => {\n    setTool('fill')\n  },\n  l: () => {\n    setTool('eye-dropper')\n  },\n  v: () => {\n    setTool('move')\n  }\n}\n\nlet shiftKeyMark = Date.now()\nlet metaKeyMark = Date.now()\nlet alphaKeyMark = Date.now()\n\nexport const setupKeyListeners = () => {\n  window.addEventListener('keydown', (e) => {\n    if (e.target.tagName === 'INPUT') {\n      return\n    }\n\n    const key = e.key.toLowerCase()\n    \n    if (!e.repeat && key === 'meta') {\n      metaKeyMark = Date.now()\n    } \n\n    if (!e.repeat && key === 'shift') {\n      shiftKeyMark = Date.now()\n    } \n\n    if (!e.repeat && key === 'z') {\n      alphaKeyMark = Date.now()\n    }\n\n    if (e.shiftKey && e.metaKey) {\n      if ((shiftKeyMark < metaKeyMark < alphaKeyMark) && key === 'z') {\n        keyMap.shiftKey.metaKey['z']()\n      }\n    }\n    \n    if (!e.shiftKey && e.metaKey) {\n      if ((metaKeyMark < alphaKeyMark) && key === 'z') {\n        keyMap.metaKey['z']()\n      }\n    }\n\n    if (e.shiftKey && !e.metaKey) {\n      if ((shiftKeyMark < alphaKeyMark) && key === 'z') {\n        // keyMap.shiftKey['z']()\n      }\n    }\n\n    if (!e.shiftKey && !e.metaKey && keyMap[e.key.toLowerCase()]) {\n      keyMap[e.key.toLowerCase()]()\n    }\n  })\n}\n","import { h, render, createRef } from 'preact'\nimport { RGBtoHSL, HSLtoRGB } from '../utils'\nimport { APP, VIEW } from '../state'\nimport { addToUndo, undo, redo } from '../undo-redo'\n\nconst enableActiveInput = (id, val) => {\n  VIEW.activeInput.id = id\n  VIEW.activeInput.val = val\n  \n  VIEW.render()\n}\n\nconst disableActiveInput = () => {\n  VIEW.activeInput.id = ''\n  VIEW.activeInput.val = ''\n  \n  VIEW.render()\n}\n\nconst setActiveInput = (val) => {\n  VIEW.activeInput.val = val\n}\n\nexport const setRGB = (newRGB) => {\n  const rgb = newRGB\n  const hsl = RGBtoHSL(rgb)\n\n  APP.color.rgb = rgb\n  APP.color.hsl = hsl\n\n  VIEW.render()\n}\n\nconst setHSL = (newHSL) => {\n  const hsl = newHSL\n  const rgb = HSLtoRGB(hsl)\n\n  APP.color.hsl = hsl\n  APP.color.rgb = rgb\n  \n  VIEW.render()\n}\n\nconst setRed = (e) => {\n  const r = parseInt(e.target.value)\n\n  if (r >= 0 && r <= 255) {\n    const newRGB = [r, APP.color.rgb[1], APP.color.rgb[2], APP.color.rgb[3]]\n    setRGB(newRGB)\n  }\n}\n\nconst setGreen = (e) => {\n  const g = parseInt(e.target.value)\n\n  if (g >= 0 && g <= 255) {\n    const newRGB = [APP.color.rgb[0], g, APP.color.rgb[2], APP.color.rgb[3]]\n    setRGB(newRGB)\n  }\n}\n\nconst setBlue = (e) => {\n  const b = parseInt(e.target.value)\n\n  if (b >= 0 && b <= 255) {\n    const newRGB = [APP.color.rgb[0], APP.color.rgb[1], b, APP.color.rgb[3]]\n    setRGB(newRGB)\n  }\n}\n\nconst setHue = (e) => {\n  const h = parseInt(e.target.value)\n  \n  if (h >= 0 && h <= 360) {\n    const newHSL = [h, APP.color.hsl[1], APP.color.hsl[2], APP.color.hsl[3]]\n    setHSL(newHSL)\n  }\n}\n\nconst setSaturation = (e) => {\n  const s = parseInt(e.target.value)\n  \n  if (s >= 0 && s <= 100) {\n    const newHSL = [APP.color.hsl[0], s, APP.color.hsl[2], APP.color.hsl[3]]\n    setHSL(newHSL)\n  }\n}\n\nconst setLightness = (e) => {\n  const l = parseInt(e.target.value)\n  \n  if (l >= 0 && l <= 100) {\n    const newHSL = [APP.color.hsl[0], APP.color.hsl[1], l, APP.color.hsl[3]]\n    setHSL(newHSL)\n  }\n}\n\nconst setHex = () => {}\n\nconst paletteAdd = () => {\n  APP.palette.push(APP.color.rgb)\n  \n  VIEW.render()\n}\n\nconst paletteDelete = (i) => {\n  const index = APP.palette.indexOf(APP.color.rgb)\n\n  if (index !== -1) {\n    APP.palette.splice(index, 1)\n    VIEW.render()\n  } \n}\n\nexport const Color = () => {\n  return (\n    <div class='bord-dark-b fl-1'>\n      <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n        <small><b>Color</b></small>\n      </div>\n      <div class='fl-column overflow-none p-10'>\n        <div class='b-r-2 overflow-none fl-column'>\n          {\n            [\n              {\n                id: 'color-hue-range',\n                min: 0,\n                max: 360,\n                func: setHue,\n                style: `min-height: 26px; background: linear-gradient(to right, #ff0000 0%, #ffff00 17%, #00ff00 33%, #00ffff 50%, #0000ff 67%, #ff00ff 83%, #ff0000 100%);`\n              }, {\n                id: 'color-saturation-range',\n                min: 0,\n                max: 100,\n                func: setSaturation,\n                style: `min-height: 26px; background: linear-gradient(to right, hsl(${APP.color.hsl[0]}, 0%, 50%) 0%,hsl(${APP.color.hsl[0]}, 100%, 50%) 100%);`\n              }, {\n                id: 'color-lightness-range',\n                min: 0,\n                max: 100,\n                func: setLightness,\n                style: `min-height: 26px; background: linear-gradient(to right, hsl(${APP.color.hsl[0]}, 100%, 0%) 0%, hsl(${APP.color.hsl[0]}, 100%, 50%) 50%, hsl(${APP.color.hsl[0]}, 100%, 100%) 100%)`\n              }\n            ].map((item, i) => {\n              return <input\n                type='range'\n                min={item.min}\n                max={item.max}\n                style={item.style}\n                class='fl-1 m-0'\n                onFocus={(e) => {\n                  enableActiveInput(item.id, APP.color.hsl[i])\n                }}\n                onFocusOut={() => {\n                  disableActiveInput()\n                }}\n                onInput={(e) => {\n                  setActiveInput(e.target.value)\n                  item.func(e)\n                }}\n                value={VIEW.activeInput.id === item.id ? VIEW.activeInput.val : APP.color.hsl[i]}\n              />\n            })\n          }\n        </div>\n        <div class='p-v-10'>\n          <div class='fl fl-center-y' style='margin-bottom: 2px;'>\n            <small style='width: 50px; font-size: 11px;'>HSL</small>\n            {\n              [\n                {\n                  id: 'color-hue-text',\n                  func: setHue\n                }, {\n                  id: 'color-saturation-text',\n                  func: setSaturation\n                }, {\n                  id: 'color-lightness-text',\n                  func: setLightness\n                }\n              ].map((item, i) => {\n                return <input\n                  class='fl-1'\n                  type='number'\n                  style={`margin-right: ${i === 2 ? 0 : 2}px;`}\n                  onFocus={(e) => {\n                    enableActiveInput(item.id, APP.color.hsl[i])\n                  }}\n                  onFocusOut={() => {\n                    disableActiveInput()\n                  }}\n                  onInput={(e) => {\n                    setActiveInput(e.target.value)\n                    item.func(e)\n                  }}\n                  value={VIEW.activeInput.id === item.id ? VIEW.activeInput.val : APP.color.hsl[i]}\n                />\n              })\n            }\n          </div>\n          <div class='fl fl-center-y' style='margin-bottom: 2px;'>\n            <small style='width: 50px; font-size: 11px;'>RGB</small>\n            {\n              [\n                {\n                  id: 'color-red-text',\n                  func: setRed\n                }, {\n                  id: 'color-green-text',\n                  func: setGreen\n                }, {\n                  id: 'color-blue-text',\n                  func: setBlue\n                }\n              ].map((item, i) => {\n                return <input\n                  class='fl-1'\n                  type='number'\n                  style={`margin-right: ${i === 2 ? 0 : 2}px;`}\n                  onFocus={(e) => {\n                    enableActiveInput(item.id, APP.color.rgb[i])\n                  }}\n                  onFocusOut={() => {\n                    disableActiveInput()\n                  }}\n                  onInput={(e) => {\n                    setActiveInput(e.target.value)\n                    item.func(e)\n                  }}\n                  value={VIEW.activeInput.id === item.id ? VIEW.activeInput.val : APP.color.rgb[i]}\n                />\n              })\n            }\n          </div>\n          {/* <div class='fl fl-center-y'>\n            <small style='width: 50px; font-size: 11px;'>HEX</small>\n            <input class='fl-1' type='text' />\n          </div> */}\n        </div>\n        <div class='fl'>\n          <div\n            class='fl-1 no-ptr h-25 b-r-2'\n            style={`margin-right: 10px; background: rgba(${APP.color.rgb[0]}, ${APP.color.rgb[1]}, ${APP.color.rgb[2]}, 255); margin-bottom: 10px; `}>\n          </div>\n          {APP.palette.filter(c =>\n            APP.color.rgb[0] === c[0] &&\n            APP.color.rgb[1] === c[1] &&\n            APP.color.rgb[2] === c[2] &&\n            APP.color.rgb[3] === c[3])\n            .length === 0\n            ? <button\n                onClick={() => { paletteAdd() }}\n                class='w-30 h-25 fl fl-center bg-dark bord-dark b-r-2'>\n                <img src={`img/insert.svg`} />\n              </button>\n            : <button\n              onClick={() => { paletteDelete() }}\n              class='w-30 h-25 fl fl-center bg-dark bord-dark b-r-2'>\n              <img src={`img/delete.svg`} />\n            </button>\n          }\n        </div>\n        <div class='fl fl-wrap overflow-none b-r-2' style='align-content: baseline;'>\n          {\n            APP.palette.map(c =>\n              <button\n                onClick={() => {\n                  setRGB(c)\n                }}\n                class='m-0'\n                style={`\n                  width: 44px;\n                  min-height: 25px;\n                  background: rgba(${c[0]}, ${c[1]}, ${c[2]}, ${c[3]});\n                  border: ${\n                    APP.color.rgb[0] === c[0] &&\n                    APP.color.rgb[1] === c[1] &&\n                    APP.color.rgb[2] === c[2] &&\n                    APP.color.rgb[3] === c[3] ? '2px solid rgba(61,61,61, 1)' : '2px solid rgba(61,61,61, 0)'};\n                  box-shadow: inset 0px 0px 0px 1px rgba(255, 255, 255, ${\n                    APP.color.rgb[0] === c[0] &&\n                    APP.color.rgb[1] === c[1] &&\n                    APP.color.rgb[2] === c[2] &&\n                    APP.color.rgb[3] === c[3] ? '255' : '0'});\n                `} />\n            )\n          }\n        </div>\n      </div>\n    </div>\n  )\n}","import { h, render } from 'preact'\nimport { APP, VIEW } from '../state'\nimport { addToUndo } from '../undo-redo'\n\nconst setTargetCanvas = (frame, layer) => {\n  if (frame === undefined) console.error('setTargetCanvas - no frame given')\n  if (layer === undefined) console.error('setTargetCanvas - no layer given')\n\n  if (frame >= 0 && frame < APP.frameCount && layer >= 0 && layer <= APP.layerCount) {\n    APP.frameActive = frame\n    APP.layerActive = layer\n\n    VIEW.render()\n  }\n}\n\nconst seq = (request, type, data) => {\n  const inserting = request === 'insert' || request === 'duplicate'\n  \n  function action (req, ref, target, entry) {\n    if (req === 'insert') ref.splice(target + 1, 0, entry)\n    if (req === 'delete') ref.splice(target, 1)\n  }\n\n  if (type === 'layer') {\n    if (request === 'insert') {\n      action(request, APP.layers, APP.layerActive, data)\n    }\n\n    if (request === 'delete') {\n      action(request, APP.layers, APP.layerActive)\n    }\n  }\n\n  if (type === 'frame') {\n    if (request === 'insert') {\n      APP.layers.forEach((layer, i) => {\n        const entry = new ImageData(APP.width, APP.height)\n        entry.data.set(data[i].data)\n        action(request, layer.frames, APP.frameActive, entry)\n      })\n    }\n\n    if (request === 'delete') {\n      APP.layers.forEach(layer => {\n        action(request, layer.frames, APP.frameActive)\n      })\n    }\n  }\n\n  APP[`${type}Count`] += (inserting ? 1 : -1)\n\n  if (inserting) {\n    APP[`${type}Active`] += 1\n  } \n  \n  if (request === 'delete') {\n    if (APP[`${type}Active`] === APP[`${type}Count`]) {\n      APP[`${type}Active`] -= 1\n    } \n  }\n}\n\nexport const timelineManager = ({ type, request, requestType, data, disableUndoRedo }) => {\n  const layerActive = APP.layerActive\n  const frameActive = APP.frameActive\n  const layerCount = APP.layerCount\n  const frameCount = APP.frameCount\n\n  if (!disableUndoRedo) {\n    addToUndo(request, type)\n\n    VIEW.currUndoRef.redo = () => {\n      APP.frameCount = frameCount\n      APP.layerCount = layerCount\n      APP.frameActive = frameActive\n      APP.layerActive = layerActive\n      timelineManager({ type, request, requestType, data, disableUndoRedo: true })\n    }\n  }\n\n  const newData = type === 'layer' ? {\n    name: `Layer ${layerCount + 1}`,\n    hidden: false,\n    frames: new Array(frameCount).fill(undefined).map(frame => new ImageData(APP.width, APP.height))\n  } : new Array(APP.layerCount)\n    .fill(undefined)\n    .map(item => {\n      return new ImageData(APP.width, APP.height)\n    })\n  \n  const cloneData = type === 'layer' ? {\n    name: `${APP.layers[layerActive].name} ${requestType === 'clone' ? '(Copy)' : ''}`,\n    hidden: false,\n    frames: new Array(frameCount)\n      .fill(undefined)\n      .map((frame, frameI) => {\n        const imgData = new ImageData(APP.width, APP.height)\n        imgData.data.set(APP.layers[layerActive].frames[frameI].data)\n        return imgData\n      })\n  } : new Array(layerCount)\n      .fill(undefined)\n      .map((item, i) => {\n        const copy = new ImageData(APP.width, APP.height)\n        copy.data.set(APP.layers[i].frames[frameActive].data)\n        return copy\n      })\n  \n  if ((type === 'layer' || type === 'frame') && (requestType === 'new' || requestType === 'clone')) {\n    seq('insert', type, requestType === 'new' ? newData : cloneData)\n  }\n\n  if ((type === 'layer' || type === 'frame') && request === 'delete') {\n    if (APP[`${type}Count`] - 1 === 0) {\n      seq('delete', type)\n      if (type === 'layer') newData.name = 'Layer 1'\n      seq('insert', type, newData)\n    } else {\n      seq('delete', type)\n    }\n  }\n\n  const layerActiveAfter = APP.layerActive\n  const frameActiveAfter = APP.frameActive\n  const layerCountAfter = APP.layerCount\n  const frameCountAfter = APP.frameCount\n  \n  if (!disableUndoRedo) {\n    VIEW.currUndoRef.undo = () => {\n      APP.frameCount = frameCountAfter\n      APP.layerCount = layerCountAfter\n  \n      if (type === 'layer') {\n        APP.frameActive = frameActiveAfter\n        \n        if (request === 'insert') {\n          APP.layerActive = layerActiveAfter\n          seq('delete', type)\n        }\n  \n        if (request === 'delete' && layerCount !== 1) {\n          APP.layerActive = layerActive - 1\n          seq('insert', type, cloneData)\n        }\n\n        if (request === 'delete' && layerCount === 1) {\n          seq('delete', type)\n          seq('insert', type, cloneData)\n        }\n      }\n\n      if (type === 'frame') {\n        APP.layerActive = layerActiveAfter\n        \n        if (request === 'insert') {\n          APP.frameActive = frameActiveAfter\n          seq('delete', type)\n        }\n  \n        if (request === 'delete' && frameCount !== 1) {\n          APP.frameActive = frameActive - 1\n          seq('insert', type, cloneData)\n        }\n\n        if (request === 'delete' && frameCount === 1) {\n          seq('delete', type)\n          seq('insert', type, cloneData)\n        }\n      }\n    }\n  }\n\n  VIEW.render()\n}\n\nconst swap = (type, dir) => {\n  const step = dir === 'up' ? -1 : 1\n  const active = type === 'layer' ? 'layerActive' : 'frameActive'\n  const length = type === 'layer' ? APP.layerCount : APP.frameCount\n\n  if (APP[active] + step === -1) return\n  if (APP[active] + step === length) return\n\n  if (type === 'layer') {\n    const temp = APP.layers[APP.layerActive + step]\n    APP.layers[APP.layerActive + step] = APP.layers[APP.layerActive]\n    APP.layers[APP.layerActive] = temp\n  }\n\n  if (type === 'frame') {\n    APP.layers.forEach(layer => {\n      const temp = layer.frames[APP.frameActive + step]\n      layer.frames[APP.frameActive + step] = layer.frames[APP.frameActive]\n      layer.frames[APP.frameActive] = temp\n    })\n  }\n\n  APP[active] += step\n\n  VIEW.render()\n}\n\nconst layersEditHidden = (i) => {\n  APP.layers[i].hidden = !APP.layers[i].hidden\n  VIEW.render()\n}\n\nconst nextFrame = () => {\n  APP.frameActive = (APP.frameActive + 1) % APP.frameCount\n  VIEW.render()\n}\n\nconst lastFrame = () => {\n  APP.frameActive = APP.frameActive - 1 === -1 ? APP.frameCount - 1 : APP.frameActive - 1\n  VIEW.render()\n}\n\n// Animation\nconst scheduler = () => {\n  APP.frameActive = (APP.frameActive + 1) % APP.frameCount\n  VIEW.render()\n  VIEW.timerID = setTimeout(scheduler, 100)\n}\n\nconst togglePlay = () => {\n  if (APP.frameCount === 1) return\n\n  if (VIEW.isPlaying) {\n    clearTimeout(VIEW.timerID)\n  } else {\n    scheduler()\n  }\n  \n  VIEW.isPlaying = !VIEW.isPlaying\n  VIEW.render()\n}\n\nexport const Timeline= () => {\n  return (\n    <div class='bg-light bord-dark-t fl-column' style='height: 250px;'>\n        <div class='fl w-full bord-dark-b h-30'>\n          <div class='fl fl-justify-between bord-dark-r' style='width: 210px;'>\n            {/* <div style='width: 90px;' class='p-h-10 fl fl-center-y bord-dark-r'>\n              <small><b>Layers</b></small>\n            </div> */}\n            <div class='fl'>\n              <button\n                onClick={() => { if (APP.layerCount < 30) timelineManager({ type:'layer', request: 'insert', requestType: 'new' }) }}\n                class='w-30 fl fl-center bord-dark-r' >\n                <img src={`img/insert.svg`} />\n              </button>\n              <button\n                onClick={() => { timelineManager({ type:'layer', request: 'insert', requestType: 'clone' }) }}\n                class='w-30 fl fl-center bord-dark-r' >\n                <img src={`img/clone.svg`} />\n              </button>\n              <button\n                onClick={() => { swap('layer', 'down') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/up.svg`} />\n              </button>\n              <button\n                onClick={() => { swap('layer', 'up') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/down.svg`} />\n              </button>\n              <button\n                onClick={() => { timelineManager({ type:'layer', request: 'delete' }) }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/delete.svg`} />\n              </button>\n            </div>\n          </div>\n          <div class='fl fl-1'>\n            <div class='fl'>\n              <button\n                onClick={() => { VIEW.onionSkinning = !VIEW.onionSkinning; VIEW.render() }}\n                class=\"fl fl-center m-0 p-0 w-30 bord-dark-r\"\n                style={VIEW.onionSkinning ? 'background: rgba(52, 152, 219, 255);' : ''}>\n                <img src=\"img/onion.svg\" />\n              </button>\n            </div>\n            <div class='fl-1 fl fl-justify-center'>\n              <div class='fl'>\n                <button\n                  onClick={() => { lastFrame() }}\n                  class=\"fl fl-center m-0 p-0 w-30 bord-dark-r bord-dark-l\" >\n                  <img src=\"img/lastframe.svg\" />\n                </button>\n                <button\n                  onClick={() => { togglePlay() }}\n                  class=\"fl fl-center m-0 p-0 w-30 bord-dark-r\" >\n                  <img src={`img/${VIEW.isPlaying ? 'stop.svg' : 'play.svg'}`} />\n                </button>\n                <button\n                  onClick={() => { nextFrame() }}\n                  class=\"fl fl-center m-0 p-0 w-30 bord-dark-r\" >\n                  <img src=\"img/nextframe.svg\" />\n                </button>\n              </div>\n            </div>\n            <div class='fl'>\n              <button\n                onClick={() => { if (!VIEW.isPlaying && APP.frameCount < 50) timelineManager({ type: 'frame', request: 'insert', requestType: 'new' }) }}\n                class='w-30 fl fl-center bord-dark-r bord-dark-l'>\n                <img src={`img/insert.svg`} />\n              </button>\n              <button\n                onClick={() => { timelineManager({ type:'frame', request: 'insert', requestType: 'clone' }) }}\n                class='w-30 fl fl-center bord-dark-r' >\n                <img src={`img/clone.svg`} />\n              </button>\n              <button\n                onClick={() => { if (!VIEW.isPlaying) swap('frame', 'up') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/up.svg`} style='transform: rotate(-90deg);'/>\n              </button>\n              <button\n                onClick={() => { if (!VIEW.isPlaying) swap('frame', 'down') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/down.svg`} style='transform: rotate(-90deg);' />\n              </button>\n              <button\n                onClick={() => { if (!VIEW.isPlaying) timelineManager({ type:'frame', request: 'delete' }) }}\n                class='w-30 fl fl-center'>\n                <img src={`img/delete.svg`} />\n              </button>\n            </div>\n          </div>\n        </div>\n        <div class='fl bg-mid' style='height: calc(100% - 30px);'>\n          <div id='layers' class='overflow hide-scroll' style='padding-bottom: 30px;'>\n            <div class='bord-dark-r fl-col-reverse' style='width: 210px;'>\n              {\n                APP.layers.map((layer, li) => {\n                  return <div\n                    class='fl bord-dark-b h-30'\n                    style={`background: ${APP.layerActive === li ? 'rgb(100, 100, 100)' :''};`}>\n                    <button\n                      style={`${layer.hidden ? 'background: rgba(52, 152, 219, 255);' : ''}`}\n                      onClick={() => { layersEditHidden(li) }}\n                      class='w-30 h-30 fl fl-center bord-dark-b'>\n                      <img src={`img/${layer.hidden ? 'eye-active.svg' : 'eye.svg'}`} />\n                    </button>\n                    <button\n                      onClick={() => { setTargetCanvas(APP.frameActive, li) }}\n                      class='fl-1 txt-left'>\n                      <small style='font-size: 11px;'><b>{layer.name}</b></small>\n                    </button>\n                  </div>\n                })\n              }\n            </div>\n          </div>\n          <div id='frames' class='fl-1 overflow hide-scroll' style='padding-bottom: 30px;'>\n            <canvas id='timeline-canvas' style='cursor: pointer;' onClick={(e) => {\n              const x = Math.floor(e.offsetX / 30)\n              const y = (APP.layerCount - 1) - Math.floor(e.offsetY / 30)\n              \n              setTargetCanvas(x, y)\n            }}/>\n          </div>\n        </div>\n      </div>\n  )\n}","import { h, render } from 'preact'\nimport { APP, VIEW } from '../state'\nimport { addToUndo } from '../undo-redo'\nimport { setRGB } from './color'\n\nconst getPoint = (imgDataArr, x, y, w, h) => {\n  if (!imgDataArr) throw Error(`setPoint: ${imgDataArr} undefined`)\n  if (!imgDataArr.length) throw Error(`setPoint: ${imgDataArr} not a valid array`)\n\n  if (x >= 0 && x < w && y >= 0 && y < h) { // check bounds\n    const i = (x + w * y) * 4\n    return [\n      imgDataArr[i + 0],\n      imgDataArr[i + 1],\n      imgDataArr[i + 2],\n      imgDataArr[i + 3]\n    ]\n  }\n\n  return [0, 0, 0, 0]\n}\n\nconst setPoint = (imgDataArr, x, y, w, h, color) => {\n  if (!imgDataArr) throw Error(`setPoint: ${imgDataArr} undefined`)\n  if (!imgDataArr.length) throw Error(`setPoint: ${imgDataArr} not a valid array`)\n  \n  if (x >= 0 && x < w && y >= 0 && y < h) { // check bounds\n    const i = (x + w * y) * 4\n    imgDataArr[i + 0] = color[0]\n    imgDataArr[i + 1] = color[1]\n    imgDataArr[i + 2] = color[2]\n    imgDataArr[i + 3] = color[3]\n  }\n}\n\nconst areRGBAsEqual = (c1, a, c2, b) => {\n  return (\n    c1[a + 0] === c2[b + 0] &&\n    c1[a + 1] === c2[b + 1] &&\n    c1[a + 2] === c2[b + 2] &&\n    c1[a + 3] === c2[b + 3]\n  )\n}\n\nconst getColorAtPixel = (data, x, y, w) => {\n  const linearCord = (y * w + x) * 4\n\n  return [\n    data[linearCord + 0],\n    data[linearCord + 1],\n    data[linearCord + 2],\n    data[linearCord + 3]\n  ]\n}\n\nconst fill = (canvasImgData, startX, startY, w, h, color) => { // http://www.williammalone.com/articles/html5-canvas-javascript-paint-bucket-tool/\n  var linear_cords = (startY * w + startX) * 4;\n\n  var pixel_stack = [{ x: startX, y: startY }];\n  var original_color = getColorAtPixel(canvasImgData, startX, startY, w);\n\n  if (areRGBAsEqual(color, 0, original_color, 0)) {\n    return\n  }\n\n  while (pixel_stack.length > 0) {\n    var new_pixel = pixel_stack.shift();\n    var x = new_pixel.x;\n    var y = new_pixel.y;\n\n    linear_cords = (y * w + x) * 4;\n\n    while (\n      y-- >= 0 &&\n      canvasImgData[linear_cords + 0] === original_color[0] &&\n      canvasImgData[linear_cords + 1] === original_color[1] &&\n      canvasImgData[linear_cords + 2] === original_color[2] &&\n      canvasImgData[linear_cords + 3] === original_color[3]) {\n        linear_cords -= w * 4;\n    }\n\n    linear_cords += w * 4;\n    y++;\n\n    var reached_left = false;\n    var reached_right = false;\n\n    while (\n      y++ < h &&\n      canvasImgData[linear_cords + 0] === original_color[0] &&\n      canvasImgData[linear_cords + 1] === original_color[1] &&\n      canvasImgData[linear_cords + 2] === original_color[2] &&\n      canvasImgData[linear_cords + 3] === original_color[3]\n    ) {\n      canvasImgData[linear_cords + 0] = color[0];\n      canvasImgData[linear_cords + 1] = color[1];\n      canvasImgData[linear_cords + 2] = color[2];\n      canvasImgData[linear_cords + 3] = color[3];\n\n      if (x > 0) {\n        if (\n          canvasImgData[linear_cords - 4 + 0] === original_color[0] &&\n          canvasImgData[linear_cords - 4 + 1] === original_color[1] &&\n          canvasImgData[linear_cords - 4 + 2] === original_color[2] &&\n          canvasImgData[linear_cords - 4 + 3] === original_color[3]\n        ) {\n          if (!reached_left) {\n            pixel_stack.push({ x: x - 1, y: y });\n            reached_left = true;\n          }\n        } else if (reached_left) {\n          reached_left = false;\n        }\n      }\n  \n      if (x < w - 1) {\n        if (\n          canvasImgData[linear_cords + 4 + 0] === original_color[0] &&\n          canvasImgData[linear_cords + 4 + 1] === original_color[1] &&\n          canvasImgData[linear_cords + 4 + 2] === original_color[2] &&\n          canvasImgData[linear_cords + 4 + 3] === original_color[3]\n        ) {\n          if (!reached_right) {\n            pixel_stack.push({ x: x + 1, y: y });\n            reached_right = true;\n          }\n        } else if (reached_right) {\n          reached_right = false;\n        }\n      }\n      \n      linear_cords += w * 4;\n    }\n  }\n}\n\nconst line = (startX, startY, endX, endY, func) => {\n  let dx = Math.abs(endX - startX)\n  let dy = Math.abs(endY - startY)\n\n  let xDir = endX - startX >= 0 ? 1 : -1\n  let yDir = endY - startY >= 0 ? 1 : -1\n  \n  let lineX = startX\n  let lineY = startY\n\n  let step = dx >= dy ? dx : dy\n\n  dx = dx / step\n  dy = dy / step\n  \n  let i = 0\n  while (i < step) {\n    func(Math.floor(lineX), Math.floor(lineY))\n\n    lineX += (dx * xDir)\n    lineY += (dy * yDir)\n    i += 1\n  }\n\n  func(Math.floor(lineX), Math.floor(lineY))\n}\n\nconst circle = (xCenter, yCenter, currX, currY, func) => {\n  let radius = Math.floor(Math.sqrt(Math.pow((currX - xCenter), 2) + Math.pow((currY - yCenter), 2)))\n\n  if (radius <= 0) return\n\n  let x = 0\n  let y = radius\n  let p = 1 - radius\n\n  const circlePlot = () => {\n    func(xCenter + x, yCenter + y)\n    func(xCenter + y, yCenter + x)\n    func(xCenter - x, yCenter + y)\n    func(xCenter - y, yCenter + x)\n    func(xCenter + x, yCenter - y)\n    func(xCenter + y, yCenter - x)\n    func(xCenter - x, yCenter - y)\n    func(xCenter - y, yCenter - x)\n  }\n\n  // Plot first set of points\n  circlePlot(xCenter, yCenter, x, y)\n\n  while (x <= y) {\n    x++\n    if (p < 0) {\n      p += 2 * x + 1 // Mid point is inside therefore y remains same\n    } else { // Mid point is outside the circle so y decreases\n      y--\n      p += 2 * (x - y) + 1\n    }\n\n    circlePlot(xCenter, yCenter, x, y)\n  }\n}\n\nconst squareFilled = (startX, startY, endX, endY, w, h, color, func) => {\n  let points = []\n\n  let dx = Math.abs(endX - startX)\n  let dy = Math.abs(endY - startY)\n\n  let xDir = endX - startX >= 0 ? 1 : -1\n  let yDir = endY - startY >= 0 ? 1 : -1\n\n  let lineX = startX\n  let lineY = startY\n\n  let xStep = 0\n  let yStep = 0\n\n  while (xStep <= dx) {\n    yStep = 0\n    lineY = startY\n\n    while (yStep <= dy) {\n      func(lineX, lineY)\n      //points.push({ x: lineX, y: lineY })\n\n      lineY += (1 * yDir)\n      yStep += 1\n    }\n\n    lineX += (1 * xDir)\n    xStep += 1\n  }\n\n  return points\n}\n\nconst square = (startX, startY, endX, endY, func) => {\n  let dx = Math.abs(endX - startX)\n  let dy = Math.abs(endY - startY)\n\n  let xDir = endX - startX >= 0 ? 1 : -1\n  let yDir = endY - startY >= 0 ? 1 : -1\n\n  let lineX = startX\n  let lineY = startY\n  let i = 0\n\n  func(lineX, lineY)\n\n  while (i < dx) {\n    lineX += (1 * xDir)\n    func(lineX, startY)\n    func(lineX, (startY + (dy * yDir)))\n    i += 1\n  }\n\n  i = 0\n\n  while (i < dy) {\n    lineY += (1 * yDir)\n    func(startX, lineY)\n    func((startX + (dx * xDir)), lineY)\n    i += 1\n  }\n}\n\nexport const paintCanvas = (gestureEvent) => {\n  // Reset\n  VIEW.canvasPreview.ctx.clearRect(0, 0, APP.width, APP.height)\n  VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n  // Whole or Selection\n  const target = APP.layers[APP.layerActive].frames[APP.frameActive].data // or selection buffer\n  const preview = VIEW.canvasPreview.imgData.data\n\n  // Translate coordinates based on current screen position and canvas scale\n  const bb = VIEW.canvasView.dom.getBoundingClientRect()\n\n  const scaleX = bb.width / VIEW.canvasView.dom.width\n  const scaleY = bb.height / VIEW.canvasView.dom.height\n\n  const startX = Math.floor((VIEW.window.startX - bb.x) / scaleX)\n  const startY = Math.floor((VIEW.window.startY - bb.y) / scaleY)\n  const prevX = Math.floor((VIEW.window.prevX - bb.x) / scaleX)\n  const prevY = Math.floor((VIEW.window.prevY - bb.y) / scaleY)\n  const currX = Math.floor((VIEW.window.currX - bb.x) / scaleX)\n  const currY = Math.floor((VIEW.window.currY - bb.y) / scaleY)\n\n  const setBrushPoints = (canvas, x, y, w, h, color) => {\n    squareFilled(x - VIEW.brushSize, y - VIEW.brushSize, x + VIEW.brushSize, y + VIEW.brushSize, w, h, color, (x, y) => {\n      setPoint(canvas, x, y, w, h, color)\n    })\n  }\n\n  if (gestureEvent === 'hover' && APP.tool !== 'eye-dropper' && APP.tool !== 'move') {\n    setBrushPoints(preview, currX, currY, APP.width, APP.height, APP.tool !== 'eraser' ? APP.color.rgb : [0, 0, 0, 50])\n    VIEW.render()\n\n    return\n  }\n\n  // Setup Undo\n  if (gestureEvent === 'start' && APP.tool !== 'eye-dropper') {\n    const copy = new ImageData(APP.width, APP.height)\n    copy.data.set(APP.layers[APP.layerActive].frames[APP.frameActive].data)\n    const layerActive = APP.layerActive\n    const frameActive = APP.frameActive\n    \n    addToUndo(APP.tool)\n\n    VIEW.currUndoRef.undo = () => {\n      APP.frameActive = frameActive\n      APP.layerActive = layerActive\n      APP.layers[layerActive].frames[frameActive].data.set(copy.data)\n    }\n  }\n  \n  // Eye dropper\n  if (gestureEvent === 'end' && APP.tool === 'eye-dropper') {\n    const color = getPoint(target, currX, currY, APP.width, APP.height)\n    \n    if (color[3] !== 0) {\n      setRGB(color)\n    }\n  }\n\n  // Fill\n  if (gestureEvent === 'end' && APP.tool === 'fill') {\n    fill(target, currX, currY, APP.width, APP.height, APP.color.rgb)\n  }\n\n  // Points\n  if (APP.tool === 'pencil' || APP.tool === 'eraser') {\n    if (APP.tool === 'eraser') {\n      setBrushPoints(preview, currX, currY, APP.width, APP.height, [0, 0, 0, 50])\n    }\n    \n    line(prevX, prevY, currX, currY, (x, y) => {\n      setBrushPoints(target, x, y, APP.width, APP.height, APP.tool === 'pencil' ? APP.color.rgb : [0, 0, 0, 0])\n    })\n  }\n\n  // Geometry\n  if (APP.tool === 'line' || APP.tool === 'circle' || APP.tool === 'square') {\n    const funcs = { 'line': line, 'circle': circle, 'square': square }\n    \n    funcs[APP.tool](startX, startY, currX, currY, (x, y) => {\n      setBrushPoints(gestureEvent === 'start' || gestureEvent === 'resume' ? preview : target, x, y, APP.width, APP.height, APP.color.rgb)\n    })\n  }\n\n  // Move\n  if (APP.tool === 'move') {\n    if (gestureEvent === 'start') {\n      // Frame to Selection\n      VIEW.canvasSelection.ctx.putImageData(APP.layers[APP.layerActive].frames[APP.frameActive], 0, 0)\n      VIEW.canvasSelection.imgData = VIEW.canvasSelection.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      // Selection to Preview\n      VIEW.canvasPreview.ctx.putImageData(VIEW.canvasSelection.imgData, 0, 0)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      // Clear main canvas\n      APP.layers[APP.layerActive].frames[APP.frameActive] = new ImageData(APP.width, APP.height)\n    }\n\n    if (gestureEvent === 'resume') {\n      // Selection to Preview\n      VIEW.canvasPreview.ctx.putImageData(VIEW.canvasSelection.imgData, prevX - startX, prevY - startY)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n    }\n\n    if (gestureEvent === 'end') {\n      // Selection to Preview\n      VIEW.canvasPreview.ctx.putImageData(VIEW.canvasSelection.imgData, prevX - startX, prevY - startY)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      // Preview to Main\n      APP.layers[APP.layerActive].frames[APP.frameActive] = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      VIEW.canvasPreview.ctx.clearRect(0, 0, APP.width, APP.height)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n    }\n  }\n\n  // Setup Redo\n  if (gestureEvent === 'end' && APP.tool !== 'eye-dropper') {\n    const copy = new ImageData(APP.width, APP.height)\n    copy.data.set(APP.layers[APP.layerActive].frames[APP.frameActive].data)\n    const layerActive = APP.layerActive\n    const frameActive = APP.frameActive\n\n    VIEW.currUndoRef.redo = () => {\n      APP.frameActive = frameActive\n      APP.layerActive = layerActive\n      APP.layers[layerActive].frames[frameActive].data.set(copy.data)\n    }\n  }\n\n  VIEW.render()\n}\n\nexport const Canvas = () => {\n  return <div id='canvas-outer-scroll' class={`overflow fl-1 cursor-${APP.tool}`}>\n    <div id='canvas-inner-scroll' data-request='paintCanvas' data-hover='paintCanvas' class='fl fl-center fl-1' style='width: 1920px; height: 1920px;'>\n      <canvas                      \n        id='canvas-view'\n        width={APP.width}\n        height={APP.height}\n        style='width: 1920px; height: 1920px; transform: scale(.25); pointer-events: none;' />\n    </div>  \n  </div>\n}","import { h } from 'preact'\nimport { VIEW } from '../state'\nimport { undo, redo } from '../undo-redo'\n\nexport const Header = () => {\n  return <div class='h-40 bg-light bord-dark-b fl'>\n    <div class=\"fl w-full\">\n      <div class=\"fl-1 fl\">\n        <div class=\"fl bord-dark-r rel w-40\"\n          onMouseLeave={() => {\n            VIEW.file.open = false\n            VIEW.render()\n          }}>\n          <button\n            onClick={() => {\n              VIEW.file.open = !VIEW.file.open\n              VIEW.render()\n            }}\n            class=\"fl fl-center m-0 p-0 w-40\">\n            <img src=\"img/bars.svg\" />\n          </button>\n          <div\n            class=\"bg-light fl-column bord-dark abs z-5\"\n            style={`visibility: ${VIEW.file.open ? 'visible' : 'hidden'}; top: 10px; left: 10px;`}>\n              <button\n                onClick={() => {\n                  VIEW.newCanvas.open = true\n                  VIEW.file.open = false\n                  VIEW.render()\n                }}\n                class=\"m-0 p-h-15 h-40 fl fl-center-y\">\n                <img src={`img/new.svg`} />\n                <small class=\"bold p-h-10\" style='text-transform: capitalize;'>New</small>\n              </button>\n              <button\n                onClick={() => {\n                  VIEW.downloadCanvas.open = true\n                  VIEW.file.open = false\n                  VIEW.render()\n                }}\n                class=\"m-0 p-h-15 h-40 fl fl-center-y\">\n                <img src={`img/download.svg`} />\n                <small class=\"bold p-h-10\" style='text-transform: capitalize;'>download</small>\n              </button>\n          </div>\n        </div>\n        <div class='fl-1 fl fl-justify-center'>\n          <button\n            onClick={() => { undo() }}\n            class=\"fl fl-center m-0 p-0 w-40 bord-dark-l bord-dark-r\">\n            <img src=\"img/undo.svg\" />\n          </button>\n          <button\n            onClick={() => { redo() }}\n            class=\"fl fl-center m-0 p-0 w-40 bord-dark-r\">\n            <img src=\"img/redo.svg\" />\n          </button>\n        </div>\n      </div>\n      <div class=\"fl\" style=\"max-width: 241px; min-width: 241px;\">\n        \n      </div>\n    </div>\n  </div>\n\n}","import { h, render, Component } from 'preact'\nimport { APP, VIEW, ENV, initCanvases, newData } from './state'\nimport { setupKeyListeners } from './keyboard'\n\n// Components\nimport { Color } from './components/color'\nimport { Timeline } from './components/timeline'\nimport { Canvas, paintCanvas } from './components/canvas'\nimport { Header } from './components/header'\nimport { Toolbar } from './components/toolbar'\n\nconst downloadCanvas = (e) => {\n  const c = document.createElement('canvas')\n  const ctx = c.getContext('2d')\n  const height = APP.height * VIEW.downloadCanvas.size\n  const width = APP.width * VIEW.downloadCanvas.size\n\n  if (VIEW.downloadCanvas.type === 'frame') {\n    c.width = width\n    c.height = height\n\n    ctx.webkitImageSmoothingEnabled = false\n    ctx.mozImageSmoothingEnabled = false\n    ctx.imageSmoothingEnabled = false\n\n    APP.layers.forEach(layer => {\n      VIEW.canvasTemp.ctx.putImageData(layer.frames[APP.frameActive], 0, 0)\n      ctx.drawImage(VIEW.canvasView.dom, 0, 0, c.width, c.height)\n    })\n\n    const image = c.toDataURL('image/png').replace('image/png', 'image/octet-stream')\n    e.target.setAttribute('href', image)\n  }\n\n  if (VIEW.downloadCanvas.type === 'spritesheet') {\n    const totalWidth = APP.width * VIEW.downloadCanvas.size * APP.frameCount\n    c.width = totalWidth\n    c.height = height\n\n    ctx.webkitImageSmoothingEnabled = false\n    ctx.mozImageSmoothingEnabled = false\n    ctx.imageSmoothingEnabled = false\n\n    for (let frameI = 0; frameI < APP.frameCount; frameI++) {\n      APP.layers.forEach(layer => {\n        VIEW.canvasTemp.ctx.putImageData(layer.frames[frameI], 0, 0)\n        ctx.drawImage(VIEW.canvasTemp.dom, frameI * width, 0, width, height)\n      })\n    }\n\n    const image = c.toDataURL('image/png').replace('image/png', 'image/octet-stream')\n    e.target.setAttribute('href', image)\n  }\n\n\n\n  if (VIEW.downloadCanvas.type === 'numgrid') {\n    c.width = APP.width\n    c.height = APP.height\n\n    ctx.webkitImageSmoothingEnabled = false\n    ctx.mozImageSmoothingEnabled = false\n    ctx.imageSmoothingEnabled = false\n\n    APP.layers.forEach(layer => {\n      VIEW.canvasTemp.ctx.putImageData(layer.frames[APP.frameActive], 0, 0)\n      ctx.drawImage(VIEW.canvasView.dom, 0, 0, c.width, c.height)\n    })\n\n    const finalImage = ctx.getImageData(0, 0, c.width, c.height)\n\n    console.log(finalImage.data.length)\n\n    const areRGBAsEqual = (c1, a, c2, b) => {\n      return (\n        c1[a + 0] === c2[b + 0] &&\n        c1[a + 1] === c2[b + 1] &&\n        c1[a + 2] === c2[b + 2] &&\n        c1[a + 3] === c2[b + 3]\n      )\n    }\n\n    const newCanvas = document.createElement('canvas')\n    newCanvas.width = APP.width * 40\n    newCanvas.height = (APP.height * 40) + 40\n    const newCanvasCtx = newCanvas.getContext('2d')\n\n    let index = 0\n\n    let includedColors = []\n\n    for (let i = 0; i < finalImage.data.length; i += 4) {\n      let x = index % APP.width\n      let y = Math.floor(index / APP.height)\n\n      APP.palette.forEach((color, paletteIndex) => {\n        if (areRGBAsEqual(color, 0, [finalImage.data[i + 0], finalImage.data[i + 1], finalImage.data[i + 2], finalImage.data[i + 3]], 0)) {\n          newCanvasCtx.fillStyle = 'gray';\n          newCanvasCtx.font = '20px serif';\n          newCanvasCtx.fillText(paletteIndex, (x * 40) + 15, ((y + 2) * 40) - 15);\n          newCanvasCtx.strokeStyle = 'gray';\n          newCanvasCtx.strokeRect(x * 40, (y + 1) * 40, 40, 40);\n\n          let includeColor = true\n      \n          includedColors.forEach(colorPrep => {\n            if (areRGBAsEqual(colorPrep.color, 0, [finalImage.data[i + 0], finalImage.data[i + 1], finalImage.data[i + 2], finalImage.data[i + 3]], 0)) {\n              includeColor = false\n            }\n          })\n\n          if (includeColor) {\n            includedColors.push({\n              paletteIndex: paletteIndex,\n              color: [finalImage.data[i + 0], finalImage.data[i + 1], finalImage.data[i + 2], finalImage.data[i + 3]]\n            })\n          }\n        }\n      })\n\n      includedColors.forEach((includedColor, includedColorI)=> {\n        newCanvasCtx.font = '20px serif';\n        newCanvasCtx.fillText(includedColor.paletteIndex, (includedColorI * 80) + 15, 40);\n        newCanvasCtx.fillStyle = `rgba(${includedColor.color[0]}, ${includedColor.color[1]}, ${includedColor.color[2]}, 255)`\n        newCanvasCtx.fillRect((includedColorI * 80) + 40, 0, 40, 40)\n      })\n\n      \n\n      index += 1\n    }\n\n    const image = newCanvas.toDataURL('image/png').replace('image/png', 'image/octet-stream')\n    e.target.setAttribute('href', image)\n  }\n}\n\nclass View extends Component{\n  componentDidMount () {\n    VIEW.render = () => {\n      this.setState({}, () => {\n        VIEW.canvasTemp.ctx.clearRect(0, 0, APP.width, APP.height)\n        VIEW.canvasFinal.ctx.clearRect(0, 0, APP.width, APP.height)\n        VIEW.canvasView.ctx.clearRect(0, 0, APP.width, APP.height)\n\n        APP.layers.forEach((layer, i) => {\n          VIEW.canvasView.ctx.globalAlpha = 1\n\n          if (layer.hidden) return\n\n          // Onion skinning\n          if (APP.layerActive === i && VIEW.onionSkinning && !VIEW.isPlaying) {\n            const framesAhead = 3\n            const framesBehind = 3\n            const framesTotal = framesBehind + framesAhead\n\n            VIEW.canvasView.ctx.globalAlpha = .5\n\n            for (let a = framesAhead - framesTotal; a < framesAhead; a++) {\n              if (!layer.frames[APP.frameActive - a]) continue\n\n              const target = layer.frames[APP.frameActive - a] \n              VIEW.canvasTemp.ctx.putImageData(target, 0, 0)\n              VIEW.canvasView.ctx.drawImage(VIEW.canvasTemp.dom, 0, 0)\n            }\n          }\n\n          // Regular frame render\n          VIEW.canvasView.ctx.globalAlpha = 1\n\n          const target = layer.frames[APP.frameActive]\n\n          for (let b = 0; b < 2; b++) { // For whatever reason safari makes me do this twice\n            // Target Canvas\n            VIEW.canvasTemp.ctx.putImageData(target, 0, 0)\n            VIEW.canvasView.ctx.drawImage(VIEW.canvasTemp.dom, 0, 0)\n            \n            // Preview Canvas\n            if (APP.layerActive === i) {\n              VIEW.canvasTemp.ctx.putImageData(VIEW.canvasPreview.imgData, 0, 0)\n              VIEW.canvasView.ctx.drawImage(VIEW.canvasTemp.dom, 0, 0)\n            }\n          }\n        })\n        \n        const tile = 30\n\n        VIEW.canvasTimeline.width = APP.frameCount * tile * 2\n        VIEW.canvasTimeline.height = APP.layerCount * tile * 2\n        VIEW.canvasTimeline.style.width = `${APP.frameCount * tile}px`\n        VIEW.canvasTimeline.style.height = `${APP.layerCount * tile}px`\n        const ctx = VIEW.canvasTimeline.getContext('2d')\n\n        VIEW.canvasTimelineTemp.width = APP.frameCount * tile * 2\n        VIEW.canvasTimelineTemp.height = APP.layerCount * tile * 2\n        const ctxTemp = VIEW.canvasTimelineTemp.getContext('2d')\n\n        APP.layers.map((layer, li) => {\n          layer.frames.map((canvas, fi) => {\n            const w = tile * 2\n            const h = tile * 2\n            const x = fi * w\n            const y = li * h\n            const BG = APP.frameActive === fi && APP.layerActive === li\n                        ? 'rgba(52, 152, 219, 255)'\n                        : (APP.frameActive === fi || APP.layerActive === li)\n                          ? 'rgba(100, 100, 100, 255)'\n                          : 'rgba(50, 50, 50, 255)'\n\n\n            ctx.fillStyle = 'rgba(33, 33, 33, 255)'\n            ctx.fillRect(x, ((APP.layerCount - 1) * h) - y, w, h)\n            \n            ctx.fillStyle = BG\n            ctx.fillRect(x, ((APP.layerCount - 1) * h) - y, w - 2, h - 2)\n            \n            ctxTemp.putImageData(canvas, x + 5, (((APP.layerCount - 1) * h) - y) + 5, 0, 0, w - 13, h - 13)    \n          })\n        })\n\n        ctx.drawImage(VIEW.canvasTimelineTemp, 0, 0)\n      })\n    }\n\n    initCanvases()\n\n    this.funcs = { paintCanvas }\n\n    // View control customization\n    this.canvasOuterScroll = document.querySelector('#canvas-outer-scroll')\n    this.canvasInnerScroll = document.querySelector('#canvas-inner-scroll')\n\n    this.timelineScroll = {\n      isSyncingLeftScroll: false,\n      isSyncingRightScroll: false,\n      leftDiv: document.querySelector('#layers'),\n      rightDiv: document.querySelector('#frames')\n    }\n\n    this.timelineScrollController()\n    this.centerCanvas()\n\n    // Adding google analytics\n    window.dataLayer = window.dataLayer || [];\n    function gtag(){dataLayer.push(arguments);}\n    gtag('js', new Date());\n\n    gtag('config', 'UA-144729452-1');\n  }\n\n  centerCanvas () {\n    const outerW = this.canvasOuterScroll.offsetWidth\n    const innerW = this.canvasInnerScroll.offsetWidth\n    const outerH = this.canvasOuterScroll.offsetHeight\n    const innerH = this.canvasInnerScroll.offsetHeight\n    \n    this.canvasOuterScroll.scrollLeft = Math.floor((innerW - outerW) / 2) + 8\n    this.canvasOuterScroll.scrollTop = Math.floor((innerH - outerH) / 2) + 8\n  }\n\n  timelineScrollController () {\n    this.timelineScroll.leftDiv.addEventListener('scroll', (e) => {\n      if (!this.timelineScroll.isSyncingLeftScroll) {\n        this.timelineScroll.isSyncingRightScroll = true\n        this.timelineScroll.rightDiv.scrollTop = e.target.scrollTop\n      }\n      this.timelineScroll.isSyncingLeftScroll = false\n    })\n    \n    this.timelineScroll.rightDiv.addEventListener('scroll', (e) => {\n      if (!this.timelineScroll.isSyncingRightScroll) {\n        this.timelineScroll.isSyncingLeftScroll = true\n        this.timelineScroll.leftDiv.scrollTop = e.target.scrollTop\n      }\n      this.timelineScroll.isSyncingRightScroll = false\n    })\n  }\n\n  onGestureDown (e) {\n    if (!VIEW.isPlaying) \n\n    VIEW.window.request = e.target.dataset.request || ''\n    VIEW.window.mouseDown = true\n    VIEW.window.startX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.startY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n    VIEW.window.prevX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.prevY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n    VIEW.window.currX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.currY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n\n    if (VIEW.window.request) this.funcs[VIEW.window.request]('start')\n  }\n  \n  onGestureDrag (e) {\n    if (!VIEW.isPlaying) \n\n    VIEW.window.prevX = VIEW.window.currX\n    VIEW.window.prevY = VIEW.window.currY\n    VIEW.window.currX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.currY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n    \n    if (VIEW.window.request) this.funcs[VIEW.window.request]('resume')\n  \n    if (e.target.tagName !== 'INPUT') { // prevent block on input range elements\n      e.preventDefault() // block pull to refresh on mobile browsers\n    }\n  }\n\n  onGestureEnd (e) {\n    if (!VIEW.isPlaying)\n\n    if (VIEW.window.request) this.funcs[VIEW.window.request]('end')\n\n    VIEW.window.request = ''\n    VIEW.window.mouseDown = false\n    VIEW.window.startX = 0\n    VIEW.window.startY = 0\n    VIEW.window.prevX = 0\n    VIEW.window.prevY = 0\n    VIEW.window.currX = 0\n    VIEW.window.currY = 0\n  }\n\n  onGestureHover (e) {\n    if (!VIEW.isPlaying)\n\n    VIEW.window.prevX = VIEW.window.currX\n    VIEW.window.prevY = VIEW.window.currY\n    VIEW.window.currX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.currY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n\n    if (e.target.dataset.hover) this.funcs[e.target.dataset.hover]('hover')\n  }\n  \n  dragOrHover (e) {\n    if (VIEW.window.mouseDown) {\n      this.onGestureDrag(e)\n    } else {\n      this.onGestureHover(e)\n    }\n  }\n\n  render () {\n    return (\n      <div\n        class='h-full relative'\n        onMouseDown={(e) => { if (e.which === 1) this.onGestureDown(e); }}\n        onMouseMove={(e) => { this.dragOrHover(e) }}\n        onMouseUp={(e) => { this.onGestureEnd(e) }}\n        onMouseLeave={(e) => { this.onGestureEnd(e) }}>\n        {/* {ENV === 'DEV' && <div id='debugger' class='abs' style='right: 0px; left: 0px; width: 100px; height: 100px; background: white; z-index: 1000;'>\n          <canvas />\n        </div>} */}\n        <Header />\n        <div class='fl' style='height: calc(100% - 40px); '>\n          <Toolbar />\n          <div class='fl-column' style='width: calc(100% - 281px);'>\n            <Canvas />\n            <Timeline />\n          </div>\n          <div class='bg-light bord-dark-l fl-column' style=\"max-width: 241px; min-width: 241px;\">\n            <div class='bord-dark-b fl-column overflow'>\n              <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n                <small><b>Tool</b></small>\n              </div>\n              <div class='fl-1 overflow'>\n                <div class=\"fl fl-center p-10\">\n                  <small style=\"width: 150px; font-size: 11px;\">Brush Size</small>\n                  <div class='fl-1 select'>\n                    <select\n                      onInput={(e) => {\n                        VIEW.brushSize = parseInt(e.target.value)\n                      }}\n                      value={VIEW.brushSize}\n                      class=\"w-full\">\n                        {\n                          [1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((size, i) => {\n                            return <option value={i}>{size}</option>\n                          })\n                        }\n                    </select>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <Color />\n            <div class='bord-dark-b fl-column overflow' style='min-height: 249px; max-height: 249px;'>\n              <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n                <small><b>History</b></small>\n              </div>\n              <div class='fl-1 overflow'>\n                {\n                  VIEW.undo.map((entry, i) => {\n                    return <button class={`p-h-10 h-30 w-full txt-left fl fl-center-y no-ptr ${VIEW.undoPos === i ? 'bg-xlight' : ''}`} >\n                      <img width='10' height='10' style='margin-right: 10px;' src={`img/${entry.icon}`} />\n                      <small style='text-transform: capitalize; font-size: 11px;'><b>{entry.action}</b></small>\n                    </button>\n                  })\n                }\n              </div>\n            </div>\n          </div>\n        </div>\n        {VIEW.newCanvas.open && <div class=\"abs top left w-full h-full fl fl-justify-center\" style=\"z-index: 10;\">\n          <div class=\"w-full overflow-hidden\" style=\"max-width: 300px; margin-top: 175px;\">\n            <div class=\"fl fl-center bg-mid bord-dark p-v-5\" style='border-top-right-radius: 5px; border-top-left-radius: 5px;'><small><b>New Canvas</b></small></div>\n            <div class=\"p-10 bg-light bord-dark-l bord-dark-r bord-dark-b\" style='border-bottom-right-radius: 5px; border-bottom-left-radius: 5px;'>\n              <div class=\"m-5 p-v-5\">\n                <div class=\"fl fl-center\">\n                  <small class=\"bold\" style=\"width: 100px;\">Dimensions</small>\n                  <div class='fl-1 select'>\n                    <select\n                      onInput={(e) => {\n                        const val = e.target.value.split('x')\n                        VIEW.newCanvas.w = parseInt(val[0])\n                        VIEW.newCanvas.h = parseInt(val[1])\n                      }}\n                      class=\"w-full\">\n                      <option value=\"32x32\">32x32</option>\n                      <option value=\"50x50\">50x50</option>\n                      <option value=\"64x64\">64x64</option>\n                      <option value=\"100x100\">100x100</option>\n                      <option value=\"128x128\">128x128</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n              <div class=\"fl\" style=\"padding-top: 5px;\">\n                <button\n                  onClick={() => {\n                    VIEW.newCanvas.open = false\n                    VIEW.render()\n                  }}\n                  class=\"b-r-2 bold p-5 w-full bg-red m-5\">Cancel</button>\n                <button\n                  onClick={() => {\n                    newData(VIEW.newCanvas.w, VIEW.newCanvas.h)\n                    VIEW.newCanvas.open = false\n                    VIEW.render()\n                  }}\n                  class=\"b-r-2 bold p-5 w-full bg-green m-5\">Confirm</button>\n              </div>\n            </div>\n          </div>\n        </div>}\n        {VIEW.downloadCanvas.open && <div class=\"abs top left w-full h-full fl fl-center-x\" style=\"z-index: 10;\">\n          <div class=\"w-full\" style=\"max-width: 300px; overflow: hidden; margin-top: 175px;\">\n              <div class=\"fl fl-center bg-mid bord-dark p-v-5\" style='border-top-right-radius: 5px; border-top-left-radius: 5px;'><small class=\"bold\">Download</small></div>\n              <div class=\"p-10 bg-light bord-dark-l bord-dark-r bord-dark-b\" style='border-bottom-right-radius: 5px; border-bottom-left-radius: 5px;'>\n                <div class=\"m-5 p-v-5\">\n                  <div class=\"fl fl-center\">\n                    <small class=\"bold\" style=\"width: 100px;\">Type</small>\n                    <div class='fl-1 select'>\n                      <select\n                        onInput={(e) => {\n                          VIEW.downloadCanvas.type = e.target.value\n                        }}\n                        value={VIEW.downloadCanvas.type}\n                        id=\"config-download-size\" class=\"w-full\">\n                          <option value=\"frame\">Frame</option>\n                          <option value=\"spritesheet\">Spritesheet</option>\n                          <option value=\"numgrid\">Number Grid</option>\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"m-5 p-v-5\">\n                    <div class=\"fl fl-center\">\n                      <small class=\"bold\" style=\"width: 100px;\">Size</small>\n                      <div class='fl-1 select'>\n                        <select\n                          onInput={(e) => {\n                            VIEW.downloadCanvas.size = parseInt(e.target.value)\n                          }}\n                          value={VIEW.downloadCanvas.size}\n                          id=\"config-download-size\" class=\"w-full\">\n                            <option value=\"2\">2x</option>\n                            <option value=\"4\">4x</option>\n                            <option value=\"8\">8x</option>\n                            <option value=\"16\">16x</option>\n                            <option value=\"32\">32x</option>\n                            <option value=\"64\">64x</option>\n                        </select>\n                      </div>\n                    </div>\n                </div>\n                <div class=\"fl\" style=\"padding-top: 5px;\">\n                  <button\n                    onClick={() => {\n                      VIEW.downloadCanvas.open = false\n                      VIEW.render()\n                    }}\n                    class=\"b-r-2 bold p-5 w-full bg-red m-5\">Cancel</button>\n                  <a\n                    onClick={(e) => {\n                      downloadCanvas(e)\n                    }}\n                    class=\"w-full m-5 clickable\" download=\"pixel-art.png\" style=\"display: inline-block;\">\n                    <button class=\"b-r-2 bold p-5 w-full bg-green no-ptr\">Download</button>\n                  </a>\n                </div>\n              </div>\n          </div>\n        </div>}\n      </div>\n    )\n  }\n}\n\nconst loadData = ({ onLoaded, onError }) => {\n  //console.time('startRead')\n  localforage.getItem('pixel-art-app').then((stored) => {\n    //console.timeEnd('startRead')\n    for (const key in stored) {\n      APP[key] = stored[key]\n    }\n\n    onLoaded()\n  }).catch(function(err) {\n    console.log(err)\n    onError()\n  });\n}\n\nconst saveData = () => {\n  setTimeout(() => {\n    console.time('startwrite')\n    localforage.setItem('pixel-art-app', APP).then(function(value) {\n      console.timeEnd('startwrite')\n    }).catch(function(err) {\n      console.log(err);\n    });\n  }, 50)\n}\n\nconst onProgramStart = () => {\n  console.log('Program started.')\n\n  newData(64, 64, true)\n  render(<View />, document.body)\n  \n  loadData({\n    onLoaded: () => {\n      initCanvases()\n      VIEW.render()\n    },\n    onError: () => {}\n  })\n\n  setupKeyListeners()\n  \n  window.addEventListener('keyup', saveData)\n  window.addEventListener('mouseup', saveData)\n}\n\nwindow.addEventListener('load', onProgramStart)\nif (ENV === 'PROD') {\n  window.addEventListener('beforeunload', (event) => {\n    event.returnValue = `Are you sure you want to leave?`;\n  });\n}\n\n"],"names":["n","u","i","t","o","f","e","c","s","l","a","parentNode","removeChild","v","r","arguments","length","push","children","defaultProps","h","type","props","key","ref","__k","__","__b","__e","__d","__c","__h","constructor","__v","vnode","p","d","this","context","_","indexOf","w","base","k","g","__r","debounceRendering","sort","some","__P","$","__n","ownerSVGElement","j","m","y","b","A","P","Array","isArray","x","value","L","I","appendChild","nextSibling","insertBefore","setProperty","test","C","style","cssText","replace","toLowerCase","slice","N","z","addEventListener","removeEventListener","removeAttributeNS","setAttributeNS","removeAttribute","setAttribute","event","T","contextType","__E","prototype","render","M","sub","state","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","H","diffed","call","nodeType","localName","document","createTextNode","createElementNS","createElement","is","data","childNodes","dangerouslySetInnerHTML","attributes","name","__html","innerHTML","checked","current","unmount","componentWillUnmount","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","Promise","then","bind","resolve","setTimeout","const","RGBtoHSL","rgb","let","cmin","Math","min","cmax","max","delta","round","abs","toFixed","floor","ENV","window","location","href","includes","APP","VIEW","undefined","canvases","initCanvases","forEach","canvas","dom","querySelector","width","height","ctx","getContext","imgData","getImageData","canvasTimeline","canvasTimelineTemp","newData","preventOnMount","tool","frameActive","layerActive","frameCount","layerCount","layers","hidden","frames","ImageData","color","hsl","palette","Object","seal","initAppDefault","activeInput","id","val","request","mouseDown","startX","startY","prevX","prevY","currX","currY","file","open","newCanvas","downloadCanvas","size","brushSize","timerID","isPlaying","onionSkinning","undo","undoPos","currUndoRef","initViewDefault","addToUndo","action","splice","icon","redo","pop","setTool","Toolbar","class","map","onClick","src","keyMap","metaKey","shiftKey","shiftKeyMark","Date","now","metaKeyMark","alphaKeyMark","enableActiveInput","disableActiveInput","setActiveInput","setRGB","newRGB","setHSL","newHSL","HSLtoRGB","setRed","parseInt","target","setGreen","setBlue","setHue","setSaturation","setLightness","Color","func","item","onFocus","onFocusOut","onInput","filter","index","setTargetCanvas","frame","layer","console","error","seq","inserting","req","entry","set","timelineManager","disableUndoRedo","requestType","fill","cloneData","frameI","copy","layerActiveAfter","frameActiveAfter","layerCountAfter","frameCountAfter","swap","dir","step","active","temp","scheduler","Timeline","clearTimeout","li","layersEditHidden","offsetX","offsetY","line","endX","endY","dx","dy","xDir","yDir","lineX","lineY","circle","xCenter","yCenter","radius","sqrt","pow","circlePlot","square","paintCanvas","gestureEvent","canvasPreview","clearRect","preview","bb","canvasView","getBoundingClientRect","scaleX","scaleY","setBrushPoints","xStep","yStep","squareFilled","imgDataArr","Error","setPoint","getPoint","canvasImgData","linear_cords","pixel_stack","original_color","linearCord","getColorAtPixel","c1","c2","areRGBAsEqual","new_pixel","shift","reached_left","reached_right","canvasSelection","putImageData","Canvas","data-request","data-hover","Header","onMouseLeave","View","gtag","dataLayer","canvasTemp","canvasFinal","globalAlpha","framesAhead","drawImage","ctxTemp","fi","tile","BG","fillStyle","fillRect","funcs","canvasOuterScroll","canvasInnerScroll","timelineScroll","isSyncingLeftScroll","isSyncingRightScroll","leftDiv","rightDiv","timelineScrollController","centerCanvas","outerW","offsetWidth","innerW","outerH","offsetHeight","innerH","scrollLeft","scrollTop","onGestureDown","dataset","pageX","touches","pageY","onGestureDrag","tagName","preventDefault","onGestureEnd","onGestureHover","hover","dragOrHover","onMouseDown","which","onMouseMove","onMouseUp","split","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","imageSmoothingEnabled","image","toDataURL","totalWidth","finalImage","log","newCanvasCtx","includedColors","paletteIndex","font","fillText","strokeStyle","strokeRect","includeColor","colorPrep","includedColor","includedColorI","download","Component","saveData","time","localforage","setItem","timeEnd","catch","err","body","onLoaded","onError","getItem","stored","repeat","returnValue"],"mappings":"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"}