{"version":3,"file":"bundle.js","sources":["../node_modules/preact/dist/preact.module.js","../app/utils.js","../app/state.js","../app/undo-redo.js","../app/components/toolbar.js","../app/keyboard.js","../app/components/color.js","../app/components/timeline.js","../app/components/canvas.js","../app/components/header.js","../app/index.js"],"sourcesContent":["var n,l,u,i,t,r,o,f,e={},c=[],s=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function a(n,l){for(var u in l)n[u]=l[u];return n}function v(n){var l=n.parentNode;l&&l.removeChild(n)}function h(n,l,u){var i,t=arguments,r={};for(i in l)\"key\"!==i&&\"ref\"!==i&&(r[i]=l[i]);if(arguments.length>3)for(u=[u],i=3;i<arguments.length;i++)u.push(t[i]);if(null!=u&&(r.children=u),\"function\"==typeof n&&null!=n.defaultProps)for(i in n.defaultProps)void 0===r[i]&&(r[i]=n.defaultProps[i]);return p(n,r,l&&l.key,l&&l.ref,null)}function p(l,u,i,t,r){var o={type:l,props:u,key:i,ref:t,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r};return null==r&&(o.__v=o),n.vnode&&n.vnode(o),o}function y(){return{}}function d(n){return n.children}function m(n,l){this.props=n,this.context=l}function w(n,l){if(null==l)return n.__?w(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?w(n):null}function k(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return k(n)}}function g(l){(!l.__d&&(l.__d=!0)&&u.push(l)&&!i++||r!==n.debounceRendering)&&((r=n.debounceRendering)||t)(_)}function _(){for(var n;i=u.length;)n=u.sort(function(n,l){return n.__v.__b-l.__v.__b}),u=[],n.some(function(n){var l,u,i,t,r,o,f;n.__d&&(o=(r=(l=n).__v).__e,(f=l.__P)&&(u=[],(i=a({},r)).__v=i,t=A(f,r,i,l.__n,void 0!==f.ownerSVGElement,null,u,null==o?w(r):o),T(u,r),t!=o&&k(r)))})}function b(n,l,u,i,t,r,o,f,s){var a,h,p,y,d,m,k,g=u&&u.__k||c,_=g.length;if(f==e&&(f=null!=r?r[0]:_?w(u,0):null),a=0,l.__k=x(l.__k,function(u){if(null!=u){if(u.__=l,u.__b=l.__b+1,null===(p=g[a])||p&&u.key==p.key&&u.type===p.type)g[a]=void 0;else for(h=0;h<_;h++){if((p=g[h])&&u.key==p.key&&u.type===p.type){g[h]=void 0;break}p=null}if(y=A(n,u,p=p||e,i,t,r,o,f,s),(h=u.ref)&&p.ref!=h&&(k||(k=[]),p.ref&&k.push(p.ref,null,u),k.push(h,u.__c||y,u)),null!=y){var c;if(null==m&&(m=y),void 0!==u.__d)c=u.__d,u.__d=void 0;else if(r==p||y!=f||null==y.parentNode){n:if(null==f||f.parentNode!==n)n.appendChild(y),c=null;else{for(d=f,h=0;(d=d.nextSibling)&&h<_;h+=2)if(d==y)break n;n.insertBefore(y,f),c=f}\"option\"==l.type&&(n.value=\"\")}f=void 0!==c?c:y.nextSibling,\"function\"==typeof l.type&&(l.__d=f)}else f&&p.__e==f&&f.parentNode!=n&&(f=w(p))}return a++,u}),l.__e=m,null!=r&&\"function\"!=typeof l.type)for(a=r.length;a--;)null!=r[a]&&v(r[a]);for(a=_;a--;)null!=g[a]&&D(g[a],g[a]);if(k)for(a=0;a<k.length;a++)j(k[a],k[++a],k[++a])}function x(n,l,u){if(null==u&&(u=[]),null==n||\"boolean\"==typeof n)l&&u.push(l(null));else if(Array.isArray(n))for(var i=0;i<n.length;i++)x(n[i],l,u);else u.push(l?l(\"string\"==typeof n||\"number\"==typeof n?p(null,n,null,null,n):null!=n.__e||null!=n.__c?p(n.type,n.props,n.key,null,n.__v):n):n);return u}function P(n,l,u,i,t){var r;for(r in u)\"children\"===r||\"key\"===r||r in l||N(n,r,null,u[r],i);for(r in l)t&&\"function\"!=typeof l[r]||\"children\"===r||\"key\"===r||\"value\"===r||\"checked\"===r||u[r]===l[r]||N(n,r,l[r],u[r],i)}function C(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=\"number\"==typeof u&&!1===s.test(l)?u+\"px\":null==u?\"\":u}function N(n,l,u,i,t){var r,o,f,e,c;if(t?\"className\"===l&&(l=\"class\"):\"class\"===l&&(l=\"className\"),\"style\"===l)if(r=n.style,\"string\"==typeof u)r.cssText=u;else{if(\"string\"==typeof i&&(r.cssText=\"\",i=null),i)for(e in i)u&&e in u||C(r,e,\"\");if(u)for(c in u)i&&u[c]===i[c]||C(r,c,u[c])}else\"o\"===l[0]&&\"n\"===l[1]?(o=l!==(l=l.replace(/Capture$/,\"\")),f=l.toLowerCase(),l=(f in n?f:l).slice(2),u?(i||n.addEventListener(l,z,o),(n.l||(n.l={}))[l]=u):n.removeEventListener(l,z,o)):\"list\"!==l&&\"tagName\"!==l&&\"form\"!==l&&\"type\"!==l&&\"size\"!==l&&!t&&l in n?n[l]=null==u?\"\":u:\"function\"!=typeof u&&\"dangerouslySetInnerHTML\"!==l&&(l!==(l=l.replace(/^xlink:?/,\"\"))?null==u||!1===u?n.removeAttributeNS(\"http://www.w3.org/1999/xlink\",l.toLowerCase()):n.setAttributeNS(\"http://www.w3.org/1999/xlink\",l.toLowerCase(),u):null==u||!1===u&&!/^ar/.test(l)?n.removeAttribute(l):n.setAttribute(l,u))}function z(l){this.l[l.type](n.event?n.event(l):l)}function A(l,u,i,t,r,o,f,e,c){var s,v,h,p,y,w,k,g,_,x,P=u.type;if(void 0!==u.constructor)return null;(s=n.__b)&&s(u);try{n:if(\"function\"==typeof P){if(g=u.props,_=(s=P.contextType)&&t[s.__c],x=s?_?_.props.value:s.__:t,i.__c?k=(v=u.__c=i.__c).__=v.__E:(\"prototype\"in P&&P.prototype.render?u.__c=v=new P(g,x):(u.__c=v=new m(g,x),v.constructor=P,v.render=E),_&&_.sub(v),v.props=g,v.state||(v.state={}),v.context=x,v.__n=t,h=v.__d=!0,v.__h=[]),null==v.__s&&(v.__s=v.state),null!=P.getDerivedStateFromProps&&(v.__s==v.state&&(v.__s=a({},v.__s)),a(v.__s,P.getDerivedStateFromProps(g,v.__s))),p=v.props,y=v.state,h)null==P.getDerivedStateFromProps&&null!=v.componentWillMount&&v.componentWillMount(),null!=v.componentDidMount&&v.__h.push(v.componentDidMount);else{if(null==P.getDerivedStateFromProps&&g!==p&&null!=v.componentWillReceiveProps&&v.componentWillReceiveProps(g,x),!v.__e&&null!=v.shouldComponentUpdate&&!1===v.shouldComponentUpdate(g,v.__s,x)||u.__v===i.__v&&!v.__){for(v.props=g,v.state=v.__s,u.__v!==i.__v&&(v.__d=!1),v.__v=u,u.__e=i.__e,u.__k=i.__k,v.__h.length&&f.push(v),s=0;s<u.__k.length;s++)u.__k[s]&&(u.__k[s].__=u);break n}null!=v.componentWillUpdate&&v.componentWillUpdate(g,v.__s,x),null!=v.componentDidUpdate&&v.__h.push(function(){v.componentDidUpdate(p,y,w)})}v.context=x,v.props=g,v.state=v.__s,(s=n.__r)&&s(u),v.__d=!1,v.__v=u,v.__P=l,s=v.render(v.props,v.state,v.context),u.__k=null!=s&&s.type==d&&null==s.key?s.props.children:Array.isArray(s)?s:[s],null!=v.getChildContext&&(t=a(a({},t),v.getChildContext())),h||null==v.getSnapshotBeforeUpdate||(w=v.getSnapshotBeforeUpdate(p,y)),b(l,u,i,t,r,o,f,e,c),v.base=u.__e,v.__h.length&&f.push(v),k&&(v.__E=v.__=null),v.__e=!1}else null==o&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=$(i.__e,u,i,t,r,o,f,c);(s=n.diffed)&&s(u)}catch(l){u.__v=null,n.__e(l,u,i)}return u.__e}function T(l,u){n.__c&&n.__c(u,l),l.some(function(u){try{l=u.__h,u.__h=[],l.some(function(n){n.call(u)})}catch(l){n.__e(l,u.__v)}})}function $(n,l,u,i,t,r,o,f){var s,a,v,h,p,y=u.props,d=l.props;if(t=\"svg\"===l.type||t,null!=r)for(s=0;s<r.length;s++)if(null!=(a=r[s])&&((null===l.type?3===a.nodeType:a.localName===l.type)||n==a)){n=a,r[s]=null;break}if(null==n){if(null===l.type)return document.createTextNode(d);n=t?document.createElementNS(\"http://www.w3.org/2000/svg\",l.type):document.createElement(l.type,d.is&&{is:d.is}),r=null,f=!1}if(null===l.type)y!==d&&n.data!=d&&(n.data=d);else{if(null!=r&&(r=c.slice.call(n.childNodes)),v=(y=u.props||e).dangerouslySetInnerHTML,h=d.dangerouslySetInnerHTML,!f){if(y===e)for(y={},p=0;p<n.attributes.length;p++)y[n.attributes[p].name]=n.attributes[p].value;(h||v)&&(h&&v&&h.__html==v.__html||(n.innerHTML=h&&h.__html||\"\"))}P(n,d,y,t,f),h?l.__k=[]:(l.__k=l.props.children,b(n,l,u,i,\"foreignObject\"!==l.type&&t,r,o,e,f)),f||(\"value\"in d&&void 0!==(s=d.value)&&s!==n.value&&N(n,\"value\",s,y.value,!1),\"checked\"in d&&void 0!==(s=d.checked)&&s!==n.checked&&N(n,\"checked\",s,y.checked,!1))}return n}function j(l,u,i){try{\"function\"==typeof l?l(u):l.current=u}catch(l){n.__e(l,i)}}function D(l,u,i){var t,r,o;if(n.unmount&&n.unmount(l),(t=l.ref)&&(t.current&&t.current!==l.__e||j(t,null,u)),i||\"function\"==typeof l.type||(i=null!=(r=l.__e)),l.__e=l.__d=void 0,null!=(t=l.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(l){n.__e(l,u)}t.base=t.__P=null}if(t=l.__k)for(o=0;o<t.length;o++)t[o]&&D(t[o],u,i);null!=r&&v(r)}function E(n,l,u){return this.constructor(n,u)}function H(l,u,i){var t,r,f;n.__&&n.__(l,u),r=(t=i===o)?null:i&&i.__k||u.__k,l=h(d,null,[l]),f=[],A(u,(t?u:i||u).__k=l,r||e,e,void 0!==u.ownerSVGElement,i&&!t?[i]:r?null:c.slice.call(u.childNodes),f,i||e,t),T(f,l)}function I(n,l){H(n,l,o)}function L(n,l){var u,i;for(i in l=a(a({},n.props),l),arguments.length>2&&(l.children=c.slice.call(arguments,2)),u={},l)\"key\"!==i&&\"ref\"!==i&&(u[i]=l[i]);return p(n.type,u,l.key||n.key,l.ref||n.ref,null)}function M(n){var l={},u={__c:\"__cC\"+f++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var i,t=this;return this.getChildContext||(i=[],this.getChildContext=function(){return l[u.__c]=t,l},this.shouldComponentUpdate=function(n){t.props.value!==n.value&&i.some(function(l){l.context=n.value,g(l)})},this.sub=function(n){i.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){i.splice(i.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Consumer.contextType=u,u.Provider.__=u,u}n={__e:function(n,l){for(var u,i;l=l.__;)if((u=l.__c)&&!u.__)try{if(u.constructor&&null!=u.constructor.getDerivedStateFromError&&(i=!0,u.setState(u.constructor.getDerivedStateFromError(n))),null!=u.componentDidCatch&&(i=!0,u.componentDidCatch(n)),i)return g(u.__E=u)}catch(l){n=l}throw n}},l=function(n){return null!=n&&void 0===n.constructor},m.prototype.setState=function(n,l){var u;u=this.__s!==this.state?this.__s:this.__s=a({},this.state),\"function\"==typeof n&&(n=n(u,this.props)),n&&a(u,n),null!=n&&this.__v&&(l&&this.__h.push(l),g(this))},m.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),g(this))},m.prototype.render=d,u=[],i=0,t=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,o=e,f=0;export{H as render,I as hydrate,h as createElement,h,d as Fragment,y as createRef,l as isValidElement,m as Component,L as cloneElement,M as createContext,x as toChildArray,D as _unmount,n as options};\n//# sourceMappingURL=preact.module.js.map\n","\nexport const RGBtoHSL = (rgb) => {\n  // Make r, g, and b fractions of 1\n  let r = rgb[0] / 255\n  let g = rgb[1] / 255\n  let b = rgb[2] / 255\n\n  // Find greatest and smallest channel values\n  let cmin = Math.min(r, g, b)\n  let cmax = Math.max(r, g, b)\n  let delta = cmax - cmin\n  let h = 0\n  let s = 0\n  let l = 0\n\n  if (delta === 0) {\n    h = 0\n  } else if (cmax === r) {\n    h = ((g - b) / delta) % 6\n  } else if (cmax === g) {\n    h = (b - r) / delta + 2\n  } else {\n    h = (r - g) / delta + 4\n  }\n\n  h = Math.round(h * 60)\n\n  // Make negative hues positive behind 360°\n  if (h < 0) h += 360\n\n  l = (cmax + cmin) / 2\n\n  // Calculate saturation\n  s = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))\n\n  // Multiply l and s by 100\n  s = +(s * 100).toFixed(1)\n  l = +(l * 100).toFixed(1)\n\n  return [ Math.floor(h), Math.floor(s), Math.floor(l), 255 ]\n}\n\nexport const HSLtoRGB = (hsl) => {\n  const h = hsl[0]\n  const s = hsl[1] / 100\n  const l = hsl[2] / 100\n\n  let c = (1 - Math.abs(2 * l - 1)) * s\n  let x = c * (1 - Math.abs((hsl[0] / 60) % 2 - 1))\n  let m = l - c / 2\n  let r = 0\n  let g = 0\n  let b = 0\n\n  if (h >= 0 && h < 60) {\n    r = c; g = x; b = 0\n  } else if (h >= 60 && h < 120) {\n    r = x; g = c; b = 0\n  } else if (h >= 120 && h < 180) {\n    r = 0; g = c; b = x\n  } else if (h >= 180 && h < 240) {\n    r = 0; g = x; b = c\n  } else if (h >= 240 && h < 300) {\n    r = x; g = 0; b = c\n  } else if (h >= 300 && h < 360) {\n    r = c; g = 0; b = x\n  }\n\n  r = Math.round((r + m) * 255)\n  g = Math.round((g + m) * 255)\n  b = Math.round((b + m) * 255)\n\n  return [ r, g, b, 255 ]\n}","import { RGBtoHSL } from './utils'\n\nexport const ENV = window.location.href.includes('localhost:4000') ? 'DEV' : 'PROD'\nexport const APP = {}\nexport const VIEW = { render: undefined }\nexport const canvases = ['canvasSelection', 'canvasPreview', 'canvasTemp', 'canvasFinal', 'canvasView']\n\nconst initAppDefault = (w, h) => {\n  APP.width = w\n  APP.height = h\n  APP.tool = 'pencil'\n\n  APP.frameActive = 0\n  APP.layerActive = 0\n  APP.frameCount = 1 \n  APP.layerCount = 1  \n  APP.layers = [\n    {\n      name: 'Layer 1',\n      hidden: false,\n      frames: [new ImageData(w, h)]\n    }\n  ]\n  \n  APP.color = {}\n  APP.color.rgb = [100, 188, 156, 255]\n  APP.color.hsl = RGBtoHSL(APP.color.rgb)\n\n  APP.palette = [\n    [26, 188, 156, 255],\n    [46, 204, 113, 255],\n    [52, 152, 219, 255],\n    [155, 89, 182, 255],\n    [52, 73, 94, 255],\n    [22, 160, 133, 255],\n    [39, 174, 96, 255],\n    [41, 128, 185, 255],\n    [142, 68, 173, 255],\n    [44, 62, 80, 255],\n    [241, 196, 15, 255],\n    [230, 126, 34, 255],\n    [231, 76, 60, 255],\n    [236, 240, 241, 255],\n    [149, 165, 166, 255],\n    [243, 156, 18, 255],\n    [211, 84, 0, 255],\n    [192, 57, 43, 255],\n    [189, 195, 199, 255],\n    [127, 140, 141, 255]\n  ]\n  \n  Object.seal(APP)\n}\n\nexport const initCanvases = () => {\n  canvases.forEach(canvas => {\n    VIEW[canvas].dom = canvas === 'canvasView' ? document.querySelector('#canvas-view') : document.createElement('canvas')\n    VIEW[canvas].dom.width = APP.width\n    VIEW[canvas].dom.height = APP.height\n    VIEW[canvas].ctx = VIEW[canvas].dom.getContext('2d')\n    VIEW[canvas].imgData = VIEW[canvas].ctx.getImageData(0, 0, APP.width, APP.height)\n  })\n\n  VIEW.canvasTimeline = document.querySelector('#timeline-canvas')\n  VIEW.canvasTimelineTemp = document.createElement('canvas')\n}\n\nconst initViewDefault = (preventOnMount) => {\n  VIEW.activeInput = {\n    id: '',\n    val: ''\n  }\n\n  VIEW.window = {\n    request: '',\n    mouseDown: false,\n    startX: 0,\n    startY: 0,\n    prevX: 0,\n    prevY: 0,\n    currX: 0,\n    currY: 0\n  }\n\n  VIEW.file = { open: false }\n  VIEW.newCanvas = { open: false, w: 32, h: 32 }\n  VIEW.downloadCanvas = { open: false, size: 2, type: 'frame' }\n\n  VIEW.brushSize = 0\n\n  VIEW.timerID = undefined\n  VIEW.isPlaying = false\n  VIEW.onionSkinning = false\n\n  VIEW.undo = []\n  VIEW.undoPos = -1\n  VIEW.currUndoRef = {}\n  \n  VIEW.canvasTimeline = undefined\n  VIEW.canvasTimelineTemp = undefined\n\n  // need to reset these on new project\n  canvases.forEach(canvas => {\n    VIEW[canvas] = {\n      dom: undefined,\n      ctx: undefined,\n      imgData: undefined\n    }\n  })\n\n  if (preventOnMount !== true) {\n    initCanvases()\n  }\n\n  Object.seal(VIEW)\n}\n\nexport const newData = (w, h, preventOnMount) => {\n  initAppDefault(w, h)\n  initViewDefault(preventOnMount)\n}","import { VIEW } from './state'\n\nexport const addToUndo = (action, type = '') => {\n  VIEW.undo.splice(0, VIEW.undoPos + 1, {\n    icon: `${action}.svg`,\n    action: `${action} ${type}`,\n    undo: undo,\n    redo: redo\n  })\n\n  if (VIEW.undoPos >= 0) VIEW.undoPos = -1  \n  if (VIEW.undo.length > 50) VIEW.undo.pop()\n\n  VIEW.currUndoRef = VIEW.undo[VIEW.undoPos + 1]\n}\n\nexport const undo = () => {\n  if (VIEW.undoPos + 1 === VIEW.undo.length) return\n\n  VIEW.undoPos += 1\n  VIEW.undo[VIEW.undoPos].undo()\n\n  VIEW.render()\n}\n\nexport const redo = () => {\n  if (VIEW.undoPos - 1 === -2) return\n\n  if (VIEW.undo[VIEW.undoPos].redo) VIEW.undo[VIEW.undoPos].redo()\n  VIEW.undoPos -= 1\n\n  VIEW.render()\n}","import { h } from 'preact'\nimport { APP, VIEW } from '../state'\n\nexport const setTool = (tool) => {\n  APP.tool = tool\n  VIEW.render()\n}\n\nexport const Toolbar = () => {\n  return <div class='w-40 bg-light bord-dark-r'>\n    {\n      ['pencil', 'eraser', 'line', 'circle', 'square', 'fill', 'eye-dropper', 'move'].map(tool => \n        <button\n          onClick={() => { setTool(tool) }}\n          class=\"fl fl-center m-0 p-0 w-40 h-40 bord-dark-r\"\n          style={`${APP.tool === tool ? 'background: rgba(52, 152, 219, 255);' : ''}`}>\n          <img src={`img/${tool}.svg`} />\n        </button>\n      )\n    }\n  </div>\n}\n\n","import { undo, redo } from './undo-redo'\nimport { setTool } from './components/toolbar'\n\nconst keyMap = {\n  metaKey: {\n    z: undo\n  },\n  shiftKey: {\n    metaKey: {\n      z: redo\n    }\n  },\n  b: () => {\n    setTool('pencil')\n  },\n  e: () => {\n    setTool('eraser')\n  },\n  u: () => {\n    setTool('line')\n  },\n  g: () => {\n    setTool('fill')\n  },\n  l: () => {\n    setTool('eye-dropper')\n  },\n  v: () => {\n    setTool('move')\n  }\n}\n\nlet shiftKeyMark = Date.now()\nlet metaKeyMark = Date.now()\nlet alphaKeyMark = Date.now()\n\nexport const setupKeyListeners = () => {\n  window.addEventListener('keydown', (e) => {\n    if (e.target.tagName === 'INPUT') {\n      return\n    }\n\n    const key = e.key.toLowerCase()\n    \n    if (!e.repeat && key === 'meta') {\n      metaKeyMark = Date.now()\n    } \n\n    if (!e.repeat && key === 'shift') {\n      shiftKeyMark = Date.now()\n    } \n\n    if (!e.repeat && key === 'z') {\n      alphaKeyMark = Date.now()\n    }\n\n    if (e.shiftKey && e.metaKey) {\n      if ((shiftKeyMark < metaKeyMark < alphaKeyMark) && key === 'z') {\n        keyMap.shiftKey.metaKey['z']()\n      }\n    }\n    \n    if (!e.shiftKey && e.metaKey) {\n      if ((metaKeyMark < alphaKeyMark) && key === 'z') {\n        keyMap.metaKey['z']()\n      }\n    }\n\n    if (e.shiftKey && !e.metaKey) {\n      if ((shiftKeyMark < alphaKeyMark) && key === 'z') {\n        // keyMap.shiftKey['z']()\n      }\n    }\n\n    if (!e.shiftKey && !e.metaKey && keyMap[e.key.toLowerCase()]) {\n      keyMap[e.key.toLowerCase()]()\n    }\n  })\n}\n","import { h, render, createRef } from 'preact'\nimport { RGBtoHSL, HSLtoRGB } from '../utils'\nimport { APP, VIEW } from '../state'\nimport { addToUndo, undo, redo } from '../undo-redo'\n\nconst enableActiveInput = (id, val) => {\n  VIEW.activeInput.id = id\n  VIEW.activeInput.val = val\n  \n  VIEW.render()\n}\n\nconst disableActiveInput = () => {\n  VIEW.activeInput.id = ''\n  VIEW.activeInput.val = ''\n  \n  VIEW.render()\n}\n\nconst setActiveInput = (val) => {\n  VIEW.activeInput.val = val\n}\n\nexport const setRGB = (newRGB) => {\n  const rgb = newRGB\n  const hsl = RGBtoHSL(rgb)\n\n  APP.color.rgb = rgb\n  APP.color.hsl = hsl\n\n  VIEW.render()\n}\n\nconst setHSL = (newHSL) => {\n  const hsl = newHSL\n  const rgb = HSLtoRGB(hsl)\n\n  APP.color.hsl = hsl\n  APP.color.rgb = rgb\n  \n  VIEW.render()\n}\n\nconst setRed = (e) => {\n  const r = parseInt(e.target.value)\n\n  if (r >= 0 && r <= 255) {\n    const newRGB = [r, APP.color.rgb[1], APP.color.rgb[2], APP.color.rgb[3]]\n    setRGB(newRGB)\n  }\n}\n\nconst setGreen = (e) => {\n  const g = parseInt(e.target.value)\n\n  if (g >= 0 && g <= 255) {\n    const newRGB = [APP.color.rgb[0], g, APP.color.rgb[2], APP.color.rgb[3]]\n    setRGB(newRGB)\n  }\n}\n\nconst setBlue = (e) => {\n  const b = parseInt(e.target.value)\n\n  if (b >= 0 && b <= 255) {\n    const newRGB = [APP.color.rgb[0], APP.color.rgb[1], b, APP.color.rgb[3]]\n    setRGB(newRGB)\n  }\n}\n\nconst setHue = (e) => {\n  const h = parseInt(e.target.value)\n  \n  if (h >= 0 && h <= 360) {\n    const newHSL = [h, APP.color.hsl[1], APP.color.hsl[2], APP.color.hsl[3]]\n    setHSL(newHSL)\n  }\n}\n\nconst setSaturation = (e) => {\n  const s = parseInt(e.target.value)\n  \n  if (s >= 0 && s <= 100) {\n    const newHSL = [APP.color.hsl[0], s, APP.color.hsl[2], APP.color.hsl[3]]\n    setHSL(newHSL)\n  }\n}\n\nconst setLightness = (e) => {\n  const l = parseInt(e.target.value)\n  \n  if (l >= 0 && l <= 100) {\n    const newHSL = [APP.color.hsl[0], APP.color.hsl[1], l, APP.color.hsl[3]]\n    setHSL(newHSL)\n  }\n}\n\nconst setHex = () => {}\n\nconst paletteAdd = () => {\n  APP.palette.push(APP.color.rgb)\n  \n  VIEW.render()\n}\n\nconst paletteDelete = (i) => {\n  const index = APP.palette.indexOf(APP.color.rgb)\n\n  if (index !== -1) {\n    APP.palette.splice(index, 1)\n    VIEW.render()\n  } \n}\n\nexport const Color = () => {\n  return (\n    <div class='bord-dark-b fl-1'>\n      <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n        <small><b>Color</b></small>\n      </div>\n      <div class='fl-column overflow-none p-10'>\n        <div class='b-r-2 overflow-none fl-column'>\n          {\n            [\n              {\n                id: 'color-hue-range',\n                min: 0,\n                max: 360,\n                func: setHue,\n                style: `min-height: 26px; background: linear-gradient(to right, #ff0000 0%, #ffff00 17%, #00ff00 33%, #00ffff 50%, #0000ff 67%, #ff00ff 83%, #ff0000 100%);`\n              }, {\n                id: 'color-saturation-range',\n                min: 0,\n                max: 100,\n                func: setSaturation,\n                style: `min-height: 26px; background: linear-gradient(to right, hsl(${APP.color.hsl[0]}, 0%, 50%) 0%,hsl(${APP.color.hsl[0]}, 100%, 50%) 100%);`\n              }, {\n                id: 'color-lightness-range',\n                min: 0,\n                max: 100,\n                func: setLightness,\n                style: `min-height: 26px; background: linear-gradient(to right, hsl(${APP.color.hsl[0]}, 100%, 0%) 0%, hsl(${APP.color.hsl[0]}, 100%, 50%) 50%, hsl(${APP.color.hsl[0]}, 100%, 100%) 100%)`\n              }\n            ].map((item, i) => {\n              return <input\n                type='range'\n                min={item.min}\n                max={item.max}\n                style={item.style}\n                class='fl-1 m-0'\n                onFocus={(e) => {\n                  enableActiveInput(item.id, APP.color.hsl[i])\n                }}\n                onFocusOut={() => {\n                  disableActiveInput()\n                }}\n                onInput={(e) => {\n                  setActiveInput(e.target.value)\n                  item.func(e)\n                }}\n                value={VIEW.activeInput.id === item.id ? VIEW.activeInput.val : APP.color.hsl[i]}\n              />\n            })\n          }\n        </div>\n        <div class='p-v-10'>\n          <div class='fl fl-center-y' style='margin-bottom: 2px;'>\n            <small style='width: 50px; font-size: 11px;'>HSL</small>\n            {\n              [\n                {\n                  id: 'color-hue-text',\n                  func: setHue\n                }, {\n                  id: 'color-saturation-text',\n                  func: setSaturation\n                }, {\n                  id: 'color-lightness-text',\n                  func: setLightness\n                }\n              ].map((item, i) => {\n                return <input\n                  class='fl-1'\n                  type='number'\n                  style={`margin-right: ${i === 2 ? 0 : 2}px;`}\n                  onFocus={(e) => {\n                    enableActiveInput(item.id, APP.color.hsl[i])\n                  }}\n                  onFocusOut={() => {\n                    disableActiveInput()\n                  }}\n                  onInput={(e) => {\n                    setActiveInput(e.target.value)\n                    item.func(e)\n                  }}\n                  value={VIEW.activeInput.id === item.id ? VIEW.activeInput.val : APP.color.hsl[i]}\n                />\n              })\n            }\n          </div>\n          <div class='fl fl-center-y' style='margin-bottom: 2px;'>\n            <small style='width: 50px; font-size: 11px;'>RGB</small>\n            {\n              [\n                {\n                  id: 'color-red-text',\n                  func: setRed\n                }, {\n                  id: 'color-green-text',\n                  func: setGreen\n                }, {\n                  id: 'color-blue-text',\n                  func: setBlue\n                }\n              ].map((item, i) => {\n                return <input\n                  class='fl-1'\n                  type='number'\n                  style={`margin-right: ${i === 2 ? 0 : 2}px;`}\n                  onFocus={(e) => {\n                    enableActiveInput(item.id, APP.color.rgb[i])\n                  }}\n                  onFocusOut={() => {\n                    disableActiveInput()\n                  }}\n                  onInput={(e) => {\n                    setActiveInput(e.target.value)\n                    item.func(e)\n                  }}\n                  value={VIEW.activeInput.id === item.id ? VIEW.activeInput.val : APP.color.rgb[i]}\n                />\n              })\n            }\n          </div>\n          {/* <div class='fl fl-center-y'>\n            <small style='width: 50px; font-size: 11px;'>HEX</small>\n            <input class='fl-1' type='text' />\n          </div> */}\n        </div>\n        <div class='fl'>\n          <div\n            class='fl-1 no-ptr h-25 b-r-2'\n            style={`margin-right: 10px; background: rgba(${APP.color.rgb[0]}, ${APP.color.rgb[1]}, ${APP.color.rgb[2]}, 255); margin-bottom: 10px; `}>\n          </div>\n          {APP.palette.filter(c =>\n            APP.color.rgb[0] === c[0] &&\n            APP.color.rgb[1] === c[1] &&\n            APP.color.rgb[2] === c[2] &&\n            APP.color.rgb[3] === c[3])\n            .length === 0\n            ? <button\n                onClick={() => { paletteAdd() }}\n                class='w-30 h-25 fl fl-center bg-dark bord-dark b-r-2'>\n                <img src={`img/insert.svg`} />\n              </button>\n            : <button\n              onClick={() => { paletteDelete() }}\n              class='w-30 h-25 fl fl-center bg-dark bord-dark b-r-2'>\n              <img src={`img/delete.svg`} />\n            </button>\n          }\n        </div>\n        <div class='fl fl-wrap overflow-none b-r-2' style='align-content: baseline;'>\n          {\n            APP.palette.map(c =>\n              <button\n                onClick={() => {\n                  setRGB(c)\n                }}\n                class='m-0'\n                style={`\n                  width: 44px;\n                  min-height: 25px;\n                  background: rgba(${c[0]}, ${c[1]}, ${c[2]}, ${c[3]});\n                  border: ${\n                    APP.color.rgb[0] === c[0] &&\n                    APP.color.rgb[1] === c[1] &&\n                    APP.color.rgb[2] === c[2] &&\n                    APP.color.rgb[3] === c[3] ? '2px solid rgba(61,61,61, 1)' : '2px solid rgba(61,61,61, 0)'};\n                  box-shadow: inset 0px 0px 0px 1px rgba(255, 255, 255, ${\n                    APP.color.rgb[0] === c[0] &&\n                    APP.color.rgb[1] === c[1] &&\n                    APP.color.rgb[2] === c[2] &&\n                    APP.color.rgb[3] === c[3] ? '255' : '0'});\n                `} />\n            )\n          }\n        </div>\n      </div>\n    </div>\n  )\n}","import { h, render } from 'preact'\nimport { APP, VIEW } from '../state'\nimport { addToUndo } from '../undo-redo'\n\nconst setTargetCanvas = (frame, layer) => {\n  if (frame === undefined) console.error('setTargetCanvas - no frame given')\n  if (layer === undefined) console.error('setTargetCanvas - no layer given')\n\n  if (frame >= 0 && frame < APP.frameCount && layer >= 0 && layer <= APP.layerCount) {\n    APP.frameActive = frame\n    APP.layerActive = layer\n\n    VIEW.render()\n  }\n}\n\nconst seq = (request, type, data) => {\n  const inserting = request === 'insert' || request === 'duplicate'\n  \n  function action (req, ref, target, entry) {\n    if (req === 'insert') ref.splice(target + 1, 0, entry)\n    if (req === 'delete') ref.splice(target, 1)\n  }\n\n  if (type === 'layer') {\n    if (request === 'insert') {\n      action(request, APP.layers, APP.layerActive, data)\n    }\n\n    if (request === 'delete') {\n      action(request, APP.layers, APP.layerActive)\n    }\n  }\n\n  if (type === 'frame') {\n    if (request === 'insert') {\n      APP.layers.forEach((layer, i) => {\n        const entry = new ImageData(APP.width, APP.height)\n        entry.data.set(data[i].data)\n        action(request, layer.frames, APP.frameActive, entry)\n      })\n    }\n\n    if (request === 'delete') {\n      APP.layers.forEach(layer => {\n        action(request, layer.frames, APP.frameActive)\n      })\n    }\n  }\n\n  APP[`${type}Count`] += (inserting ? 1 : -1)\n\n  if (inserting) {\n    APP[`${type}Active`] += 1\n  } \n  \n  if (request === 'delete') {\n    if (APP[`${type}Active`] === APP[`${type}Count`]) {\n      APP[`${type}Active`] -= 1\n    } \n  }\n}\n\nexport const timelineManager = ({ type, request, requestType, data, disableUndoRedo }) => {\n  const layerActive = APP.layerActive\n  const frameActive = APP.frameActive\n  const layerCount = APP.layerCount\n  const frameCount = APP.frameCount\n\n  if (!disableUndoRedo) {\n    addToUndo(request, type)\n\n    VIEW.currUndoRef.redo = () => {\n      APP.frameCount = frameCount\n      APP.layerCount = layerCount\n      APP.frameActive = frameActive\n      APP.layerActive = layerActive\n      timelineManager({ type, request, requestType, data, disableUndoRedo: true })\n    }\n  }\n\n  const newData = type === 'layer' ? {\n    name: `Layer ${layerCount + 1}`,\n    hidden: false,\n    frames: new Array(frameCount).fill(undefined).map(frame => new ImageData(APP.width, APP.height))\n  } : new Array(APP.layerCount)\n    .fill(undefined)\n    .map(item => {\n      return new ImageData(APP.width, APP.height)\n    })\n  \n  const cloneData = type === 'layer' ? {\n    name: `${APP.layers[layerActive].name} ${requestType === 'clone' ? '(Copy)' : ''}`,\n    hidden: false,\n    frames: new Array(frameCount)\n      .fill(undefined)\n      .map((frame, frameI) => {\n        const imgData = new ImageData(APP.width, APP.height)\n        imgData.data.set(APP.layers[layerActive].frames[frameI].data)\n        return imgData\n      })\n  } : new Array(layerCount)\n      .fill(undefined)\n      .map((item, i) => {\n        const copy = new ImageData(APP.width, APP.height)\n        copy.data.set(APP.layers[i].frames[frameActive].data)\n        return copy\n      })\n  \n  if ((type === 'layer' || type === 'frame') && (requestType === 'new' || requestType === 'clone')) {\n    seq('insert', type, requestType === 'new' ? newData : cloneData)\n  }\n\n  if ((type === 'layer' || type === 'frame') && request === 'delete') {\n    if (APP[`${type}Count`] - 1 === 0) {\n      seq('delete', type)\n      if (type === 'layer') newData.name = 'Layer 1'\n      seq('insert', type, newData)\n    } else {\n      seq('delete', type)\n    }\n  }\n\n  const layerActiveAfter = APP.layerActive\n  const frameActiveAfter = APP.frameActive\n  const layerCountAfter = APP.layerCount\n  const frameCountAfter = APP.frameCount\n  \n  if (!disableUndoRedo) {\n    VIEW.currUndoRef.undo = () => {\n      APP.frameCount = frameCountAfter\n      APP.layerCount = layerCountAfter\n  \n      if (type === 'layer') {\n        APP.frameActive = frameActiveAfter\n        \n        if (request === 'insert') {\n          APP.layerActive = layerActiveAfter\n          seq('delete', type)\n        }\n  \n        if (request === 'delete' && layerCount !== 1) {\n          APP.layerActive = layerActive - 1\n          seq('insert', type, cloneData)\n        }\n\n        if (request === 'delete' && layerCount === 1) {\n          seq('delete', type)\n          seq('insert', type, cloneData)\n        }\n      }\n\n      if (type === 'frame') {\n        APP.layerActive = layerActiveAfter\n        \n        if (request === 'insert') {\n          APP.frameActive = frameActiveAfter\n          seq('delete', type)\n        }\n  \n        if (request === 'delete' && frameCount !== 1) {\n          APP.frameActive = frameActive - 1\n          seq('insert', type, cloneData)\n        }\n\n        if (request === 'delete' && frameCount === 1) {\n          seq('delete', type)\n          seq('insert', type, cloneData)\n        }\n      }\n    }\n  }\n\n  VIEW.render()\n}\n\nconst swap = (type, dir) => {\n  const step = dir === 'up' ? -1 : 1\n  const active = type === 'layer' ? 'layerActive' : 'frameActive'\n  const length = type === 'layer' ? APP.layerCount : APP.frameCount\n\n  if (APP[active] + step === -1) return\n  if (APP[active] + step === length) return\n\n  if (type === 'layer') {\n    const temp = APP.layers[APP.layerActive + step]\n    APP.layers[APP.layerActive + step] = APP.layers[APP.layerActive]\n    APP.layers[APP.layerActive] = temp\n  }\n\n  if (type === 'frame') {\n    APP.layers.forEach(layer => {\n      const temp = layer.frames[APP.frameActive + step]\n      layer.frames[APP.frameActive + step] = layer.frames[APP.frameActive]\n      layer.frames[APP.frameActive] = temp\n    })\n  }\n\n  APP[active] += step\n\n  VIEW.render()\n}\n\nconst layersEditHidden = (i) => {\n  APP.layers[i].hidden = !APP.layers[i].hidden\n  VIEW.render()\n}\n\nconst nextFrame = () => {\n  APP.frameActive = (APP.frameActive + 1) % APP.frameCount\n  VIEW.render()\n}\n\nconst lastFrame = () => {\n  APP.frameActive = APP.frameActive - 1 === -1 ? APP.frameCount - 1 : APP.frameActive - 1\n  VIEW.render()\n}\n\n// Animation\nconst scheduler = () => {\n  APP.frameActive = (APP.frameActive + 1) % APP.frameCount\n  VIEW.render()\n  VIEW.timerID = setTimeout(scheduler, 100)\n}\n\nconst togglePlay = () => {\n  if (APP.frameCount === 1) return\n\n  if (VIEW.isPlaying) {\n    clearTimeout(VIEW.timerID)\n  } else {\n    scheduler()\n  }\n  \n  VIEW.isPlaying = !VIEW.isPlaying\n  VIEW.render()\n}\n\nexport const Timeline= () => {\n  return (\n    <div class='bg-light bord-dark-t fl-column' style='height: 250px;'>\n        <div class='fl w-full bord-dark-b h-30'>\n          <div class='fl fl-justify-between bord-dark-r' style='width: 210px;'>\n            {/* <div style='width: 90px;' class='p-h-10 fl fl-center-y bord-dark-r'>\n              <small><b>Layers</b></small>\n            </div> */}\n            <div class='fl'>\n              <button\n                onClick={() => { if (APP.layerCount < 30) timelineManager({ type:'layer', request: 'insert', requestType: 'new' }) }}\n                class='w-30 fl fl-center bord-dark-r' >\n                <img src={`img/insert.svg`} />\n              </button>\n              <button\n                onClick={() => { timelineManager({ type:'layer', request: 'insert', requestType: 'clone' }) }}\n                class='w-30 fl fl-center bord-dark-r' >\n                <img src={`img/clone.svg`} />\n              </button>\n              <button\n                onClick={() => { swap('layer', 'down') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/up.svg`} />\n              </button>\n              <button\n                onClick={() => { swap('layer', 'up') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/down.svg`} />\n              </button>\n              <button\n                onClick={() => { timelineManager({ type:'layer', request: 'delete' }) }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/delete.svg`} />\n              </button>\n            </div>\n          </div>\n          <div class='fl fl-1'>\n            <div class='fl'>\n              <button\n                onClick={() => { VIEW.onionSkinning = !VIEW.onionSkinning; VIEW.render() }}\n                class=\"fl fl-center m-0 p-0 w-30 bord-dark-r\"\n                style={VIEW.onionSkinning ? 'background: rgba(52, 152, 219, 255);' : ''}>\n                <img src=\"img/onion.svg\" />\n              </button>\n            </div>\n            <div class='fl-1 fl fl-justify-center'>\n              <div class='fl'>\n                <button\n                  onClick={() => { lastFrame() }}\n                  class=\"fl fl-center m-0 p-0 w-30 bord-dark-r bord-dark-l\" >\n                  <img src=\"img/lastframe.svg\" />\n                </button>\n                <button\n                  onClick={() => { togglePlay() }}\n                  class=\"fl fl-center m-0 p-0 w-30 bord-dark-r\" >\n                  <img src={`img/${VIEW.isPlaying ? 'stop.svg' : 'play.svg'}`} />\n                </button>\n                <button\n                  onClick={() => { nextFrame() }}\n                  class=\"fl fl-center m-0 p-0 w-30 bord-dark-r\" >\n                  <img src=\"img/nextframe.svg\" />\n                </button>\n              </div>\n            </div>\n            <div class='fl'>\n              <button\n                onClick={() => { if (!VIEW.isPlaying && APP.frameCount < 50) timelineManager({ type: 'frame', request: 'insert', requestType: 'new' }) }}\n                class='w-30 fl fl-center bord-dark-r bord-dark-l'>\n                <img src={`img/insert.svg`} />\n              </button>\n              <button\n                onClick={() => { timelineManager({ type:'frame', request: 'insert', requestType: 'clone' }) }}\n                class='w-30 fl fl-center bord-dark-r' >\n                <img src={`img/clone.svg`} />\n              </button>\n              <button\n                onClick={() => { if (!VIEW.isPlaying) swap('frame', 'up') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/up.svg`} style='transform: rotate(-90deg);'/>\n              </button>\n              <button\n                onClick={() => { if (!VIEW.isPlaying) swap('frame', 'down') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/down.svg`} style='transform: rotate(-90deg);' />\n              </button>\n              <button\n                onClick={() => { if (!VIEW.isPlaying) timelineManager({ type:'frame', request: 'delete' }) }}\n                class='w-30 fl fl-center'>\n                <img src={`img/delete.svg`} />\n              </button>\n            </div>\n          </div>\n        </div>\n        <div class='fl bg-mid' style='height: calc(100% - 30px);'>\n          <div id='layers' class='overflow hide-scroll' style='padding-bottom: 30px;'>\n            <div class='bord-dark-r fl-col-reverse' style='width: 210px;'>\n              {\n                APP.layers.map((layer, li) => {\n                  return <div\n                    class='fl bord-dark-b h-30'\n                    style={`background: ${APP.layerActive === li ? 'rgb(100, 100, 100)' :''};`}>\n                    <button\n                      style={`${layer.hidden ? 'background: rgba(52, 152, 219, 255);' : ''}`}\n                      onClick={() => { layersEditHidden(li) }}\n                      class='w-30 h-30 fl fl-center bord-dark-b'>\n                      <img src={`img/${layer.hidden ? 'eye-active.svg' : 'eye.svg'}`} />\n                    </button>\n                    <button\n                      onClick={() => { setTargetCanvas(APP.frameActive, li) }}\n                      class='fl-1 txt-left'>\n                      <small style='font-size: 11px;'><b>{layer.name}</b></small>\n                    </button>\n                  </div>\n                })\n              }\n            </div>\n          </div>\n          <div id='frames' class='fl-1 overflow hide-scroll' style='padding-bottom: 30px;'>\n            <canvas id='timeline-canvas' style='cursor: pointer;' onClick={(e) => {\n              const x = Math.floor(e.offsetX / 30)\n              const y = (APP.layerCount - 1) - Math.floor(e.offsetY / 30)\n              \n              setTargetCanvas(x, y)\n            }}/>\n          </div>\n        </div>\n      </div>\n  )\n}","import { h, render } from 'preact'\nimport { APP, VIEW } from '../state'\nimport { addToUndo } from '../undo-redo'\nimport { setRGB } from './color'\n\nconst getPoint = (imgDataArr, x, y, w, h) => {\n  if (!imgDataArr) throw Error(`setPoint: ${imgDataArr} undefined`)\n  if (!imgDataArr.length) throw Error(`setPoint: ${imgDataArr} not a valid array`)\n\n  if (x >= 0 && x < w && y >= 0 && y < h) { // check bounds\n    const i = (x + w * y) * 4\n    return [\n      imgDataArr[i + 0],\n      imgDataArr[i + 1],\n      imgDataArr[i + 2],\n      imgDataArr[i + 3]\n    ]\n  }\n\n  return [0, 0, 0, 0]\n}\n\nconst setPoint = (imgDataArr, x, y, w, h, color) => {\n  if (!imgDataArr) throw Error(`setPoint: ${imgDataArr} undefined`)\n  if (!imgDataArr.length) throw Error(`setPoint: ${imgDataArr} not a valid array`)\n  \n  if (x >= 0 && x < w && y >= 0 && y < h) { // check bounds\n    const i = (x + w * y) * 4\n    imgDataArr[i + 0] = color[0]\n    imgDataArr[i + 1] = color[1]\n    imgDataArr[i + 2] = color[2]\n    imgDataArr[i + 3] = color[3]\n  }\n}\n\nconst areRGBAsEqual = (c1, a, c2, b) => {\n  return (\n    c1[a + 0] === c2[b + 0] &&\n    c1[a + 1] === c2[b + 1] &&\n    c1[a + 2] === c2[b + 2] &&\n    c1[a + 3] === c2[b + 3]\n  )\n}\n\nconst getColorAtPixel = (data, x, y, w) => {\n  const linearCord = (y * w + x) * 4\n\n  return [\n    data[linearCord + 0],\n    data[linearCord + 1],\n    data[linearCord + 2],\n    data[linearCord + 3]\n  ]\n}\n\nconst fill = (canvasImgData, startX, startY, w, h, color) => { // http://www.williammalone.com/articles/html5-canvas-javascript-paint-bucket-tool/\n  var linear_cords = (startY * w + startX) * 4;\n\n  var pixel_stack = [{ x: startX, y: startY }];\n  var original_color = getColorAtPixel(canvasImgData, startX, startY, w);\n\n  if (areRGBAsEqual(color, 0, original_color, 0)) {\n    return\n  }\n\n  while (pixel_stack.length > 0) {\n    var new_pixel = pixel_stack.shift();\n    var x = new_pixel.x;\n    var y = new_pixel.y;\n\n    linear_cords = (y * w + x) * 4;\n\n    while (\n      y-- >= 0 &&\n      canvasImgData[linear_cords + 0] === original_color[0] &&\n      canvasImgData[linear_cords + 1] === original_color[1] &&\n      canvasImgData[linear_cords + 2] === original_color[2] &&\n      canvasImgData[linear_cords + 3] === original_color[3]) {\n        linear_cords -= w * 4;\n    }\n\n    linear_cords += w * 4;\n    y++;\n\n    var reached_left = false;\n    var reached_right = false;\n\n    while (\n      y++ < h &&\n      canvasImgData[linear_cords + 0] === original_color[0] &&\n      canvasImgData[linear_cords + 1] === original_color[1] &&\n      canvasImgData[linear_cords + 2] === original_color[2] &&\n      canvasImgData[linear_cords + 3] === original_color[3]\n    ) {\n      canvasImgData[linear_cords + 0] = color[0];\n      canvasImgData[linear_cords + 1] = color[1];\n      canvasImgData[linear_cords + 2] = color[2];\n      canvasImgData[linear_cords + 3] = color[3];\n\n      if (x > 0) {\n        if (\n          canvasImgData[linear_cords - 4 + 0] === original_color[0] &&\n          canvasImgData[linear_cords - 4 + 1] === original_color[1] &&\n          canvasImgData[linear_cords - 4 + 2] === original_color[2] &&\n          canvasImgData[linear_cords - 4 + 3] === original_color[3]\n        ) {\n          if (!reached_left) {\n            pixel_stack.push({ x: x - 1, y: y });\n            reached_left = true;\n          }\n        } else if (reached_left) {\n          reached_left = false;\n        }\n      }\n  \n      if (x < w - 1) {\n        if (\n          canvasImgData[linear_cords + 4 + 0] === original_color[0] &&\n          canvasImgData[linear_cords + 4 + 1] === original_color[1] &&\n          canvasImgData[linear_cords + 4 + 2] === original_color[2] &&\n          canvasImgData[linear_cords + 4 + 3] === original_color[3]\n        ) {\n          if (!reached_right) {\n            pixel_stack.push({ x: x + 1, y: y });\n            reached_right = true;\n          }\n        } else if (reached_right) {\n          reached_right = false;\n        }\n      }\n      \n      linear_cords += w * 4;\n    }\n  }\n}\n\nconst line = (startX, startY, endX, endY, func) => {\n  let dx = Math.abs(endX - startX)\n  let dy = Math.abs(endY - startY)\n\n  let xDir = endX - startX >= 0 ? 1 : -1\n  let yDir = endY - startY >= 0 ? 1 : -1\n  \n  let lineX = startX\n  let lineY = startY\n\n  let step = dx >= dy ? dx : dy\n\n  dx = dx / step\n  dy = dy / step\n  \n  let i = 0\n  while (i < step) {\n    func(Math.floor(lineX), Math.floor(lineY))\n\n    lineX += (dx * xDir)\n    lineY += (dy * yDir)\n    i += 1\n  }\n\n  func(Math.floor(lineX), Math.floor(lineY))\n}\n\nconst circle = (xCenter, yCenter, currX, currY, func) => {\n  let radius = Math.floor(Math.sqrt(Math.pow((currX - xCenter), 2) + Math.pow((currY - yCenter), 2)))\n\n  if (radius <= 0) return\n\n  let x = 0\n  let y = radius\n  let p = 1 - radius\n\n  const circlePlot = () => {\n    func(xCenter + x, yCenter + y)\n    func(xCenter + y, yCenter + x)\n    func(xCenter - x, yCenter + y)\n    func(xCenter - y, yCenter + x)\n    func(xCenter + x, yCenter - y)\n    func(xCenter + y, yCenter - x)\n    func(xCenter - x, yCenter - y)\n    func(xCenter - y, yCenter - x)\n  }\n\n  // Plot first set of points\n  circlePlot(xCenter, yCenter, x, y)\n\n  while (x <= y) {\n    x++\n    if (p < 0) {\n      p += 2 * x + 1 // Mid point is inside therefore y remains same\n    } else { // Mid point is outside the circle so y decreases\n      y--\n      p += 2 * (x - y) + 1\n    }\n\n    circlePlot(xCenter, yCenter, x, y)\n  }\n}\n\nconst squareFilled = (startX, startY, endX, endY, w, h, color, func) => {\n  let points = []\n\n  let dx = Math.abs(endX - startX)\n  let dy = Math.abs(endY - startY)\n\n  let xDir = endX - startX >= 0 ? 1 : -1\n  let yDir = endY - startY >= 0 ? 1 : -1\n\n  let lineX = startX\n  let lineY = startY\n\n  let xStep = 0\n  let yStep = 0\n\n  while (xStep <= dx) {\n    yStep = 0\n    lineY = startY\n\n    while (yStep <= dy) {\n      func(lineX, lineY)\n      //points.push({ x: lineX, y: lineY })\n\n      lineY += (1 * yDir)\n      yStep += 1\n    }\n\n    lineX += (1 * xDir)\n    xStep += 1\n  }\n\n  return points\n}\n\nconst square = (startX, startY, endX, endY, func) => {\n  let dx = Math.abs(endX - startX)\n  let dy = Math.abs(endY - startY)\n\n  let xDir = endX - startX >= 0 ? 1 : -1\n  let yDir = endY - startY >= 0 ? 1 : -1\n\n  let lineX = startX\n  let lineY = startY\n  let i = 0\n\n  func(lineX, lineY)\n\n  while (i < dx) {\n    lineX += (1 * xDir)\n    func(lineX, startY)\n    func(lineX, (startY + (dy * yDir)))\n    i += 1\n  }\n\n  i = 0\n\n  while (i < dy) {\n    lineY += (1 * yDir)\n    func(startX, lineY)\n    func((startX + (dx * xDir)), lineY)\n    i += 1\n  }\n}\n\nexport const paintCanvas = (gestureEvent) => {\n  // Reset\n  VIEW.canvasPreview.ctx.clearRect(0, 0, APP.width, APP.height)\n  VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n  // Whole or Selection\n  const target = APP.layers[APP.layerActive].frames[APP.frameActive].data // or selection buffer\n  const preview = VIEW.canvasPreview.imgData.data\n\n  // Translate coordinates based on current screen position and canvas scale\n  const bb = VIEW.canvasView.dom.getBoundingClientRect()\n\n  const scaleX = bb.width / VIEW.canvasView.dom.width\n  const scaleY = bb.height / VIEW.canvasView.dom.height\n\n  const startX = Math.floor((VIEW.window.startX - bb.x) / scaleX)\n  const startY = Math.floor((VIEW.window.startY - bb.y) / scaleY)\n  const prevX = Math.floor((VIEW.window.prevX - bb.x) / scaleX)\n  const prevY = Math.floor((VIEW.window.prevY - bb.y) / scaleY)\n  const currX = Math.floor((VIEW.window.currX - bb.x) / scaleX)\n  const currY = Math.floor((VIEW.window.currY - bb.y) / scaleY)\n\n  const setBrushPoints = (canvas, x, y, w, h, color) => {\n    squareFilled(x - VIEW.brushSize, y - VIEW.brushSize, x + VIEW.brushSize, y + VIEW.brushSize, w, h, color, (x, y) => {\n      setPoint(canvas, x, y, w, h, color)\n    })\n  }\n\n  if (gestureEvent === 'hover' && APP.tool !== 'eye-dropper' && APP.tool !== 'move') {\n    setBrushPoints(preview, currX, currY, APP.width, APP.height, APP.tool !== 'eraser' ? APP.color.rgb : [0, 0, 0, 50])\n    VIEW.render()\n\n    return\n  }\n\n  // Setup Undo\n  if (gestureEvent === 'start' && APP.tool !== 'eye-dropper') {\n    const copy = new ImageData(APP.width, APP.height)\n    copy.data.set(APP.layers[APP.layerActive].frames[APP.frameActive].data)\n    const layerActive = APP.layerActive\n    const frameActive = APP.frameActive\n    \n    addToUndo(APP.tool)\n\n    VIEW.currUndoRef.undo = () => {\n      APP.frameActive = frameActive\n      APP.layerActive = layerActive\n      APP.layers[layerActive].frames[frameActive].data.set(copy.data)\n    }\n  }\n  \n  // Eye dropper\n  if (gestureEvent === 'end' && APP.tool === 'eye-dropper') {\n    const color = getPoint(target, currX, currY, APP.width, APP.height)\n    \n    if (color[3] !== 0) {\n      setRGB(color)\n    }\n  }\n\n  // Fill\n  if (gestureEvent === 'end' && APP.tool === 'fill') {\n    fill(target, currX, currY, APP.width, APP.height, APP.color.rgb)\n  }\n\n  // Points\n  if (APP.tool === 'pencil' || APP.tool === 'eraser') {\n    if (APP.tool === 'eraser') {\n      setBrushPoints(preview, currX, currY, APP.width, APP.height, [0, 0, 0, 50])\n    }\n    \n    line(prevX, prevY, currX, currY, (x, y) => {\n      setBrushPoints(target, x, y, APP.width, APP.height, APP.tool === 'pencil' ? APP.color.rgb : [0, 0, 0, 0])\n    })\n  }\n\n  // Geometry\n  if (APP.tool === 'line' || APP.tool === 'circle' || APP.tool === 'square') {\n    const funcs = { 'line': line, 'circle': circle, 'square': square }\n    \n    funcs[APP.tool](startX, startY, currX, currY, (x, y) => {\n      setBrushPoints(gestureEvent === 'start' || gestureEvent === 'resume' ? preview : target, x, y, APP.width, APP.height, APP.color.rgb)\n    })\n  }\n\n  // Move\n  if (APP.tool === 'move') {\n    if (gestureEvent === 'start') {\n      // Frame to Selection\n      VIEW.canvasSelection.ctx.putImageData(APP.layers[APP.layerActive].frames[APP.frameActive], 0, 0)\n      VIEW.canvasSelection.imgData = VIEW.canvasSelection.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      // Selection to Preview\n      VIEW.canvasPreview.ctx.putImageData(VIEW.canvasSelection.imgData, 0, 0)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      // Clear main canvas\n      APP.layers[APP.layerActive].frames[APP.frameActive] = new ImageData(APP.width, APP.height)\n    }\n\n    if (gestureEvent === 'resume') {\n      // Selection to Preview\n      VIEW.canvasPreview.ctx.putImageData(VIEW.canvasSelection.imgData, prevX - startX, prevY - startY)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n    }\n\n    if (gestureEvent === 'end') {\n      // Selection to Preview\n      VIEW.canvasPreview.ctx.putImageData(VIEW.canvasSelection.imgData, prevX - startX, prevY - startY)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      // Preview to Main\n      APP.layers[APP.layerActive].frames[APP.frameActive] = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      VIEW.canvasPreview.ctx.clearRect(0, 0, APP.width, APP.height)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n    }\n  }\n\n  // Setup Redo\n  if (gestureEvent === 'end' && APP.tool !== 'eye-dropper') {\n    const copy = new ImageData(APP.width, APP.height)\n    copy.data.set(APP.layers[APP.layerActive].frames[APP.frameActive].data)\n    const layerActive = APP.layerActive\n    const frameActive = APP.frameActive\n\n    VIEW.currUndoRef.redo = () => {\n      APP.frameActive = frameActive\n      APP.layerActive = layerActive\n      APP.layers[layerActive].frames[frameActive].data.set(copy.data)\n    }\n  }\n\n  VIEW.render()\n}\n\nexport const Canvas = () => {\n  return <div id='canvas-outer-scroll' class={`overflow fl-1 cursor-${APP.tool}`}>\n    <div id='canvas-inner-scroll' data-request='paintCanvas' data-hover='paintCanvas' class='fl fl-center fl-1' style='width: 1920px; height: 1920px;'>\n      <canvas                      \n        id='canvas-view'\n        width={APP.width}\n        height={APP.height}\n        style='width: 1920px; height: 1920px; transform: scale(.25); pointer-events: none;' />\n    </div>  \n  </div>\n}","import { h } from 'preact'\nimport { VIEW } from '../state'\nimport { undo, redo } from '../undo-redo'\n\nexport const Header = () => {\n  return <div class='h-40 bg-light bord-dark-b fl'>\n    <div class=\"fl w-full\">\n      <div class=\"fl-1 fl\">\n        <div class=\"fl bord-dark-r rel w-40\"\n          onMouseLeave={() => {\n            VIEW.file.open = false\n            VIEW.render()\n          }}>\n          <button\n            onClick={() => {\n              VIEW.file.open = !VIEW.file.open\n              VIEW.render()\n            }}\n            class=\"fl fl-center m-0 p-0 w-40\">\n            <img src=\"img/bars.svg\" />\n          </button>\n          <div\n            class=\"bg-light fl-column bord-dark abs z-5\"\n            style={`visibility: ${VIEW.file.open ? 'visible' : 'hidden'}; top: 10px; left: 10px;`}>\n              <button\n                onClick={() => {\n                  VIEW.newCanvas.open = true\n                  VIEW.file.open = false\n                  VIEW.render()\n                }}\n                class=\"m-0 p-h-15 h-40 fl fl-center-y\">\n                <img src={`img/new.svg`} />\n                <small class=\"bold p-h-10\" style='text-transform: capitalize;'>New</small>\n              </button>\n              <button\n                onClick={() => {\n                  VIEW.downloadCanvas.open = true\n                  VIEW.file.open = false\n                  VIEW.render()\n                }}\n                class=\"m-0 p-h-15 h-40 fl fl-center-y\">\n                <img src={`img/download.svg`} />\n                <small class=\"bold p-h-10\" style='text-transform: capitalize;'>download</small>\n              </button>\n          </div>\n        </div>\n        <div class='fl-1 fl fl-justify-center'>\n          <button\n            onClick={() => { undo() }}\n            class=\"fl fl-center m-0 p-0 w-40 bord-dark-l bord-dark-r\">\n            <img src=\"img/undo.svg\" />\n          </button>\n          <button\n            onClick={() => { redo() }}\n            class=\"fl fl-center m-0 p-0 w-40 bord-dark-r\">\n            <img src=\"img/redo.svg\" />\n          </button>\n        </div>\n      </div>\n      <div class=\"fl\" style=\"max-width: 241px; min-width: 241px;\">\n        \n      </div>\n    </div>\n  </div>\n\n}","import { h, render, Component } from 'preact'\nimport { APP, VIEW, ENV, initCanvases, newData } from './state'\nimport { setupKeyListeners } from './keyboard'\n\n// Components\nimport { Color } from './components/color'\nimport { Timeline } from './components/timeline'\nimport { Canvas, paintCanvas } from './components/canvas'\nimport { Header } from './components/header'\nimport { Toolbar } from './components/toolbar'\n\nconst downloadCanvas = (e) => {\n  const c = document.createElement('canvas')\n  const ctx = c.getContext('2d')\n  const height = APP.height * VIEW.downloadCanvas.size\n  const width = APP.width * VIEW.downloadCanvas.size\n\n  if (VIEW.downloadCanvas.type === 'frame') {\n    c.width = width\n    c.height = height\n\n    ctx.webkitImageSmoothingEnabled = false\n    ctx.mozImageSmoothingEnabled = false\n    ctx.imageSmoothingEnabled = false\n\n    APP.layers.forEach(layer => {\n      VIEW.canvasTemp.ctx.putImageData(layer.frames[APP.frameActive], 0, 0)\n      ctx.drawImage(VIEW.canvasView.dom, 0, 0, c.width, c.height)\n    })\n\n    const image = c.toDataURL('image/png').replace('image/png', 'image/octet-stream')\n    e.target.setAttribute('href', image)\n  }\n\n  if (VIEW.downloadCanvas.type === 'spritesheet') {\n    const totalWidth = APP.width * VIEW.downloadCanvas.size * APP.frameCount\n    c.width = totalWidth\n    c.height = height\n\n    ctx.webkitImageSmoothingEnabled = false\n    ctx.mozImageSmoothingEnabled = false\n    ctx.imageSmoothingEnabled = false\n\n    for (let frameI = 0; frameI < APP.frameCount; frameI++) {\n      APP.layers.forEach(layer => {\n        VIEW.canvasTemp.ctx.putImageData(layer.frames[frameI], 0, 0)\n        ctx.drawImage(VIEW.canvasTemp.dom, frameI * width, 0, width, height)\n      })\n    }\n\n    const image = c.toDataURL('image/png').replace('image/png', 'image/octet-stream')\n    e.target.setAttribute('href', image)\n  }\n\n\n\n  if (VIEW.downloadCanvas.type === 'numgrid') {\n    c.width = APP.width\n    c.height = APP.height\n\n    ctx.webkitImageSmoothingEnabled = false\n    ctx.mozImageSmoothingEnabled = false\n    ctx.imageSmoothingEnabled = false\n\n    APP.layers.forEach(layer => {\n      VIEW.canvasTemp.ctx.putImageData(layer.frames[APP.frameActive], 0, 0)\n      ctx.drawImage(VIEW.canvasView.dom, 0, 0, c.width, c.height)\n    })\n\n    const finalImage = ctx.getImageData(0, 0, c.width, c.height)\n\n    console.log(finalImage.data.length)\n\n    const areRGBAsEqual = (c1, a, c2, b) => {\n      return (\n        c1[a + 0] === c2[b + 0] &&\n        c1[a + 1] === c2[b + 1] &&\n        c1[a + 2] === c2[b + 2] &&\n        c1[a + 3] === c2[b + 3]\n      )\n    }\n\n    const newCanvas = document.createElement('canvas')\n    newCanvas.width = APP.width * 40\n    newCanvas.height = APP.height * 40\n    const newCanvasCtx = newCanvas.getContext('2d')\n\n    let index = 0\n\n    for (let i = 0; i < finalImage.data.length; i += 4) {\n      let x = index % APP.width\n      let y = Math.floor(index / APP.height)\n\n      \n\n      APP.palette.forEach((color, paletteIndex) => {\n        if (areRGBAsEqual(color, 0, [finalImage.data[i + 0], finalImage.data[i + 1], finalImage.data[i + 2], finalImage.data[i + 3]], 0)) {\n          // newCanvasCtx.fillR\n          // console.log(paletteIndex)\n          console.log(x, y)\n          newCanvasCtx.font = '20px serif';\n\n          newCanvasCtx.fillText(paletteIndex, (x * 40) + 15, ((y + 1) * 40) - 15);\n          newCanvasCtx.strokeStyle = 'black';\n          newCanvasCtx.strokeRect(x * 40, y * 40, 40, 40);\n        }\n      })\n\n      index += 1\n    }\n\n    const image = newCanvas.toDataURL('image/png').replace('image/png', 'image/octet-stream')\n    e.target.setAttribute('href', image)\n  }\n}\n\nclass View extends Component{\n  componentDidMount () {\n    VIEW.render = () => {\n      this.setState({}, () => {\n        VIEW.canvasTemp.ctx.clearRect(0, 0, APP.width, APP.height)\n        VIEW.canvasFinal.ctx.clearRect(0, 0, APP.width, APP.height)\n        VIEW.canvasView.ctx.clearRect(0, 0, APP.width, APP.height)\n\n        APP.layers.forEach((layer, i) => {\n          VIEW.canvasView.ctx.globalAlpha = 1\n\n          if (layer.hidden) return\n\n          // Onion skinning\n          if (APP.layerActive === i && VIEW.onionSkinning && !VIEW.isPlaying) {\n            const framesAhead = 3\n            const framesBehind = 3\n            const framesTotal = framesBehind + framesAhead\n\n            VIEW.canvasView.ctx.globalAlpha = .5\n\n            for (let a = framesAhead - framesTotal; a < framesAhead; a++) {\n              if (!layer.frames[APP.frameActive - a]) continue\n\n              const target = layer.frames[APP.frameActive - a] \n              VIEW.canvasTemp.ctx.putImageData(target, 0, 0)\n              VIEW.canvasView.ctx.drawImage(VIEW.canvasTemp.dom, 0, 0)\n            }\n          }\n\n          // Regular frame render\n          VIEW.canvasView.ctx.globalAlpha = 1\n\n          const target = layer.frames[APP.frameActive]\n\n          for (let b = 0; b < 2; b++) { // For whatever reason safari makes me do this twice\n            // Target Canvas\n            VIEW.canvasTemp.ctx.putImageData(target, 0, 0)\n            VIEW.canvasView.ctx.drawImage(VIEW.canvasTemp.dom, 0, 0)\n            \n            // Preview Canvas\n            if (APP.layerActive === i) {\n              VIEW.canvasTemp.ctx.putImageData(VIEW.canvasPreview.imgData, 0, 0)\n              VIEW.canvasView.ctx.drawImage(VIEW.canvasTemp.dom, 0, 0)\n            }\n          }\n        })\n        \n        const tile = 30\n\n        VIEW.canvasTimeline.width = APP.frameCount * tile * 2\n        VIEW.canvasTimeline.height = APP.layerCount * tile * 2\n        VIEW.canvasTimeline.style.width = `${APP.frameCount * tile}px`\n        VIEW.canvasTimeline.style.height = `${APP.layerCount * tile}px`\n        const ctx = VIEW.canvasTimeline.getContext('2d')\n\n        VIEW.canvasTimelineTemp.width = APP.frameCount * tile * 2\n        VIEW.canvasTimelineTemp.height = APP.layerCount * tile * 2\n        const ctxTemp = VIEW.canvasTimelineTemp.getContext('2d')\n\n        APP.layers.map((layer, li) => {\n          layer.frames.map((canvas, fi) => {\n            const w = tile * 2\n            const h = tile * 2\n            const x = fi * w\n            const y = li * h\n            const BG = APP.frameActive === fi && APP.layerActive === li\n                        ? 'rgba(52, 152, 219, 255)'\n                        : (APP.frameActive === fi || APP.layerActive === li)\n                          ? 'rgba(100, 100, 100, 255)'\n                          : 'rgba(50, 50, 50, 255)'\n\n\n            ctx.fillStyle = 'rgba(33, 33, 33, 255)'\n            ctx.fillRect(x, ((APP.layerCount - 1) * h) - y, w, h)\n            \n            ctx.fillStyle = BG\n            ctx.fillRect(x, ((APP.layerCount - 1) * h) - y, w - 2, h - 2)\n            \n            ctxTemp.putImageData(canvas, x + 5, (((APP.layerCount - 1) * h) - y) + 5, 0, 0, w - 13, h - 13)    \n          })\n        })\n\n        ctx.drawImage(VIEW.canvasTimelineTemp, 0, 0)\n      })\n    }\n\n    initCanvases()\n\n    this.funcs = { paintCanvas }\n\n    // View control customization\n    this.canvasOuterScroll = document.querySelector('#canvas-outer-scroll')\n    this.canvasInnerScroll = document.querySelector('#canvas-inner-scroll')\n\n    this.timelineScroll = {\n      isSyncingLeftScroll: false,\n      isSyncingRightScroll: false,\n      leftDiv: document.querySelector('#layers'),\n      rightDiv: document.querySelector('#frames')\n    }\n\n    this.timelineScrollController()\n    this.centerCanvas()\n\n    // Adding google analytics\n    window.dataLayer = window.dataLayer || [];\n    function gtag(){dataLayer.push(arguments);}\n    gtag('js', new Date());\n\n    gtag('config', 'UA-144729452-1');\n  }\n\n  centerCanvas () {\n    const outerW = this.canvasOuterScroll.offsetWidth\n    const innerW = this.canvasInnerScroll.offsetWidth\n    const outerH = this.canvasOuterScroll.offsetHeight\n    const innerH = this.canvasInnerScroll.offsetHeight\n    \n    this.canvasOuterScroll.scrollLeft = Math.floor((innerW - outerW) / 2) + 8\n    this.canvasOuterScroll.scrollTop = Math.floor((innerH - outerH) / 2) + 8\n  }\n\n  timelineScrollController () {\n    this.timelineScroll.leftDiv.addEventListener('scroll', (e) => {\n      if (!this.timelineScroll.isSyncingLeftScroll) {\n        this.timelineScroll.isSyncingRightScroll = true\n        this.timelineScroll.rightDiv.scrollTop = e.target.scrollTop\n      }\n      this.timelineScroll.isSyncingLeftScroll = false\n    })\n    \n    this.timelineScroll.rightDiv.addEventListener('scroll', (e) => {\n      if (!this.timelineScroll.isSyncingRightScroll) {\n        this.timelineScroll.isSyncingLeftScroll = true\n        this.timelineScroll.leftDiv.scrollTop = e.target.scrollTop\n      }\n      this.timelineScroll.isSyncingRightScroll = false\n    })\n  }\n\n  onGestureDown (e) {\n    if (!VIEW.isPlaying) \n\n    VIEW.window.request = e.target.dataset.request || ''\n    VIEW.window.mouseDown = true\n    VIEW.window.startX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.startY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n    VIEW.window.prevX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.prevY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n    VIEW.window.currX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.currY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n\n    if (VIEW.window.request) this.funcs[VIEW.window.request]('start')\n  }\n  \n  onGestureDrag (e) {\n    if (!VIEW.isPlaying) \n\n    VIEW.window.prevX = VIEW.window.currX\n    VIEW.window.prevY = VIEW.window.currY\n    VIEW.window.currX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.currY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n    \n    if (VIEW.window.request) this.funcs[VIEW.window.request]('resume')\n  \n    if (e.target.tagName !== 'INPUT') { // prevent block on input range elements\n      e.preventDefault() // block pull to refresh on mobile browsers\n    }\n  }\n\n  onGestureEnd (e) {\n    if (!VIEW.isPlaying)\n\n    if (VIEW.window.request) this.funcs[VIEW.window.request]('end')\n\n    VIEW.window.request = ''\n    VIEW.window.mouseDown = false\n    VIEW.window.startX = 0\n    VIEW.window.startY = 0\n    VIEW.window.prevX = 0\n    VIEW.window.prevY = 0\n    VIEW.window.currX = 0\n    VIEW.window.currY = 0\n  }\n\n  onGestureHover (e) {\n    if (!VIEW.isPlaying)\n\n    VIEW.window.prevX = VIEW.window.currX\n    VIEW.window.prevY = VIEW.window.currY\n    VIEW.window.currX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.currY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n\n    if (e.target.dataset.hover) this.funcs[e.target.dataset.hover]('hover')\n  }\n  \n  dragOrHover (e) {\n    if (VIEW.window.mouseDown) {\n      this.onGestureDrag(e)\n    } else {\n      this.onGestureHover(e)\n    }\n  }\n\n  render () {\n    return (\n      <div\n        class='h-full relative'\n        onMouseDown={(e) => { if (e.which === 1) this.onGestureDown(e); }}\n        onMouseMove={(e) => { this.dragOrHover(e) }}\n        onMouseUp={(e) => { this.onGestureEnd(e) }}\n        onMouseLeave={(e) => { this.onGestureEnd(e) }}>\n        {/* {ENV === 'DEV' && <div id='debugger' class='abs' style='right: 0px; left: 0px; width: 100px; height: 100px; background: white; z-index: 1000;'>\n          <canvas />\n        </div>} */}\n        <Header />\n        <div class='fl' style='height: calc(100% - 40px); '>\n          <Toolbar />\n          <div class='fl-column' style='width: calc(100% - 281px);'>\n            <Canvas />\n            <Timeline />\n          </div>\n          <div class='bg-light bord-dark-l fl-column' style=\"max-width: 241px; min-width: 241px;\">\n            <div class='bord-dark-b fl-column overflow'>\n              <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n                <small><b>Tool</b></small>\n              </div>\n              <div class='fl-1 overflow'>\n                <div class=\"fl fl-center p-10\">\n                  <small style=\"width: 150px; font-size: 11px;\">Brush Size</small>\n                  <div class='fl-1 select'>\n                    <select\n                      onInput={(e) => {\n                        VIEW.brushSize = parseInt(e.target.value)\n                      }}\n                      value={VIEW.brushSize}\n                      class=\"w-full\">\n                        {\n                          [1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((size, i) => {\n                            return <option value={i}>{size}</option>\n                          })\n                        }\n                    </select>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <Color />\n            <div class='bord-dark-b fl-column overflow' style='min-height: 249px; max-height: 249px;'>\n              <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n                <small><b>History</b></small>\n              </div>\n              <div class='fl-1 overflow'>\n                {\n                  VIEW.undo.map((entry, i) => {\n                    return <button class={`p-h-10 h-30 w-full txt-left fl fl-center-y no-ptr ${VIEW.undoPos === i ? 'bg-xlight' : ''}`} >\n                      <img width='10' height='10' style='margin-right: 10px;' src={`img/${entry.icon}`} />\n                      <small style='text-transform: capitalize; font-size: 11px;'><b>{entry.action}</b></small>\n                    </button>\n                  })\n                }\n              </div>\n            </div>\n          </div>\n        </div>\n        {VIEW.newCanvas.open && <div class=\"abs top left w-full h-full fl fl-justify-center\" style=\"z-index: 10;\">\n          <div class=\"w-full overflow-hidden\" style=\"max-width: 300px; margin-top: 175px;\">\n            <div class=\"fl fl-center bg-mid bord-dark p-v-5\" style='border-top-right-radius: 5px; border-top-left-radius: 5px;'><small><b>New Canvas</b></small></div>\n            <div class=\"p-10 bg-light bord-dark-l bord-dark-r bord-dark-b\" style='border-bottom-right-radius: 5px; border-bottom-left-radius: 5px;'>\n              <div class=\"m-5 p-v-5\">\n                <div class=\"fl fl-center\">\n                  <small class=\"bold\" style=\"width: 100px;\">Dimensions</small>\n                  <div class='fl-1 select'>\n                    <select\n                      onInput={(e) => {\n                        const val = e.target.value.split('x')\n                        VIEW.newCanvas.w = parseInt(val[0])\n                        VIEW.newCanvas.h = parseInt(val[1])\n                      }}\n                      class=\"w-full\">\n                      <option value=\"32x32\">32x32</option>\n                      <option value=\"50x50\">50x50</option>\n                      <option value=\"64x64\">64x64</option>\n                      <option value=\"100x100\">100x100</option>\n                      <option value=\"128x128\">128x128</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n              <div class=\"fl\" style=\"padding-top: 5px;\">\n                <button\n                  onClick={() => {\n                    VIEW.newCanvas.open = false\n                    VIEW.render()\n                  }}\n                  class=\"b-r-2 bold p-5 w-full bg-red m-5\">Cancel</button>\n                <button\n                  onClick={() => {\n                    newData(VIEW.newCanvas.w, VIEW.newCanvas.h)\n                    VIEW.newCanvas.open = false\n                    VIEW.render()\n                  }}\n                  class=\"b-r-2 bold p-5 w-full bg-green m-5\">Confirm</button>\n              </div>\n            </div>\n          </div>\n        </div>}\n        {VIEW.downloadCanvas.open && <div class=\"abs top left w-full h-full fl fl-center-x\" style=\"z-index: 10;\">\n          <div class=\"w-full\" style=\"max-width: 300px; overflow: hidden; margin-top: 175px;\">\n              <div class=\"fl fl-center bg-mid bord-dark p-v-5\" style='border-top-right-radius: 5px; border-top-left-radius: 5px;'><small class=\"bold\">Download</small></div>\n              <div class=\"p-10 bg-light bord-dark-l bord-dark-r bord-dark-b\" style='border-bottom-right-radius: 5px; border-bottom-left-radius: 5px;'>\n                <div class=\"m-5 p-v-5\">\n                  <div class=\"fl fl-center\">\n                    <small class=\"bold\" style=\"width: 100px;\">Type</small>\n                    <div class='fl-1 select'>\n                      <select\n                        onInput={(e) => {\n                          VIEW.downloadCanvas.type = e.target.value\n                        }}\n                        value={VIEW.downloadCanvas.type}\n                        id=\"config-download-size\" class=\"w-full\">\n                          <option value=\"frame\">Frame</option>\n                          <option value=\"spritesheet\">Spritesheet</option>\n                          <option value=\"numgrid\">Number Grid</option>\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"m-5 p-v-5\">\n                    <div class=\"fl fl-center\">\n                      <small class=\"bold\" style=\"width: 100px;\">Size</small>\n                      <div class='fl-1 select'>\n                        <select\n                          onInput={(e) => {\n                            VIEW.downloadCanvas.size = parseInt(e.target.value)\n                          }}\n                          value={VIEW.downloadCanvas.size}\n                          id=\"config-download-size\" class=\"w-full\">\n                            <option value=\"2\">2x</option>\n                            <option value=\"4\">4x</option>\n                            <option value=\"8\">8x</option>\n                            <option value=\"16\">16x</option>\n                            <option value=\"32\">32x</option>\n                            <option value=\"64\">64x</option>\n                        </select>\n                      </div>\n                    </div>\n                </div>\n                <div class=\"fl\" style=\"padding-top: 5px;\">\n                  <button\n                    onClick={() => {\n                      VIEW.downloadCanvas.open = false\n                      VIEW.render()\n                    }}\n                    class=\"b-r-2 bold p-5 w-full bg-red m-5\">Cancel</button>\n                  <a\n                    onClick={(e) => {\n                      downloadCanvas(e)\n                    }}\n                    class=\"w-full m-5 clickable\" download=\"pixel-art.png\" style=\"display: inline-block;\">\n                    <button class=\"b-r-2 bold p-5 w-full bg-green no-ptr\">Download</button>\n                  </a>\n                </div>\n              </div>\n          </div>\n        </div>}\n      </div>\n    )\n  }\n}\n\nconst loadData = ({ onLoaded, onError }) => {\n  //console.time('startRead')\n  localforage.getItem('pixel-art-app').then((stored) => {\n    //console.timeEnd('startRead')\n    for (const key in stored) {\n      APP[key] = stored[key]\n    }\n\n    onLoaded()\n  }).catch(function(err) {\n    console.log(err)\n    onError()\n  });\n}\n\nconst saveData = () => {\n  setTimeout(() => {\n    console.time('startwrite')\n    localforage.setItem('pixel-art-app', APP).then(function(value) {\n      console.timeEnd('startwrite')\n    }).catch(function(err) {\n      console.log(err);\n    });\n  }, 50)\n}\n\nconst onProgramStart = () => {\n  console.log('Program started.')\n\n  newData(64, 64, true)\n  render(<View />, document.body)\n  \n  loadData({\n    onLoaded: () => {\n      initCanvases()\n      VIEW.render()\n    },\n    onError: () => {}\n  })\n\n  setupKeyListeners()\n  \n  window.addEventListener('keyup', saveData)\n  window.addEventListener('mouseup', saveData)\n}\n\nwindow.addEventListener('load', onProgramStart)\nif (ENV === 'PROD') {\n  window.addEventListener('beforeunload', (event) => {\n    event.returnValue = `Are you sure you want to leave?`;\n  });\n}\n\n"],"names":["n","u","i","t","r","o","e","c","s","a","l","v","parentNode","removeChild","h","arguments","length","push","children","defaultProps","p","key","ref","type","props","__k","__","__b","__e","__d","__c","constructor","__v","vnode","d","m","this","context","w","indexOf","k","base","g","debounceRendering","_","sort","some","f","__P","A","__n","ownerSVGElement","T","b","y","x","appendChild","nextSibling","insertBefore","value","D","j","Array","isArray","C","setProperty","test","N","style","cssText","replace","toLowerCase","slice","addEventListener","z","removeEventListener","removeAttributeNS","setAttributeNS","removeAttribute","setAttribute","event","P","contextType","__E","prototype","render","E","sub","state","__h","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","__r","getChildContext","getSnapshotBeforeUpdate","$","diffed","call","nodeType","localName","document","createTextNode","createElementNS","createElement","is","data","childNodes","dangerouslySetInnerHTML","attributes","name","__html","innerHTML","checked","current","unmount","componentWillUnmount","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","Promise","then","bind","resolve","setTimeout","const","RGBtoHSL","rgb","let","cmin","Math","min","cmax","max","delta","round","abs","toFixed","floor","ENV","window","location","href","includes","APP","VIEW","undefined","canvases","initCanvases","forEach","canvas","dom","querySelector","width","height","ctx","getContext","imgData","getImageData","canvasTimeline","canvasTimelineTemp","newData","preventOnMount","tool","frameActive","layerActive","frameCount","layerCount","layers","hidden","frames","ImageData","color","hsl","palette","Object","seal","initAppDefault","activeInput","id","val","request","mouseDown","startX","startY","prevX","prevY","currX","currY","file","open","newCanvas","downloadCanvas","size","brushSize","timerID","isPlaying","onionSkinning","undo","undoPos","currUndoRef","initViewDefault","addToUndo","action","splice","icon","redo","pop","setTool","Toolbar","class","map","onClick","src","keyMap","metaKey","shiftKey","shiftKeyMark","Date","now","metaKeyMark","alphaKeyMark","enableActiveInput","disableActiveInput","setActiveInput","setRGB","newRGB","setHSL","newHSL","HSLtoRGB","setRed","parseInt","target","setGreen","setBlue","setHue","setSaturation","setLightness","Color","func","item","onFocus","onFocusOut","onInput","filter","index","setTargetCanvas","frame","layer","console","error","seq","inserting","req","entry","set","timelineManager","disableUndoRedo","requestType","fill","cloneData","frameI","copy","layerActiveAfter","frameActiveAfter","layerCountAfter","frameCountAfter","swap","dir","step","active","temp","scheduler","Timeline","clearTimeout","li","layersEditHidden","offsetX","offsetY","line","endX","endY","dx","dy","xDir","yDir","lineX","lineY","circle","xCenter","yCenter","radius","sqrt","pow","circlePlot","square","paintCanvas","gestureEvent","canvasPreview","clearRect","preview","bb","canvasView","getBoundingClientRect","scaleX","scaleY","setBrushPoints","xStep","yStep","squareFilled","imgDataArr","Error","setPoint","getPoint","canvasImgData","linear_cords","pixel_stack","original_color","linearCord","getColorAtPixel","c1","c2","areRGBAsEqual","new_pixel","shift","reached_left","reached_right","canvasSelection","putImageData","Canvas","data-request","data-hover","Header","onMouseLeave","View","gtag","dataLayer","canvasTemp","canvasFinal","globalAlpha","framesAhead","drawImage","ctxTemp","fi","tile","BG","fillStyle","fillRect","funcs","canvasOuterScroll","canvasInnerScroll","timelineScroll","isSyncingLeftScroll","isSyncingRightScroll","leftDiv","rightDiv","timelineScrollController","centerCanvas","outerW","offsetWidth","innerW","outerH","offsetHeight","innerH","scrollLeft","scrollTop","onGestureDown","dataset","pageX","touches","pageY","onGestureDrag","tagName","preventDefault","onGestureEnd","onGestureHover","hover","dragOrHover","onMouseDown","which","onMouseMove","onMouseUp","split","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","imageSmoothingEnabled","image","toDataURL","totalWidth","finalImage","log","newCanvasCtx","paletteIndex","font","fillText","strokeStyle","strokeRect","download","Component","saveData","time","localforage","setItem","timeEnd","catch","err","body","onLoaded","onError","getItem","stored","repeat","returnValue"],"mappings":"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"}