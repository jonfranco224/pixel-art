{"version":3,"file":"bundle.js","sources":["../node_modules/preact/dist/preact.module.js","../app/utils.js","../app/data.js","../app/undo-redo.js","../app/color.js","../app/canvas.js","../app/keyboard.js","../app/timeline.js","../app/index.js"],"sourcesContent":["var n,l,u,i,t,r,o,f,e={},c=[],s=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function a(n,l){for(var u in l)n[u]=l[u];return n}function v(n){var l=n.parentNode;l&&l.removeChild(n)}function h(n,l,u){var i,t=arguments,r={};for(i in l)\"key\"!==i&&\"ref\"!==i&&(r[i]=l[i]);if(arguments.length>3)for(u=[u],i=3;i<arguments.length;i++)u.push(t[i]);if(null!=u&&(r.children=u),\"function\"==typeof n&&null!=n.defaultProps)for(i in n.defaultProps)void 0===r[i]&&(r[i]=n.defaultProps[i]);return p(n,r,l&&l.key,l&&l.ref,null)}function p(l,u,i,t,r){var o={type:l,props:u,key:i,ref:t,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r};return null==r&&(o.__v=o),n.vnode&&n.vnode(o),o}function y(){return{}}function d(n){return n.children}function m(n,l){this.props=n,this.context=l}function w(n,l){if(null==l)return n.__?w(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?w(n):null}function k(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return k(n)}}function g(l){(!l.__d&&(l.__d=!0)&&u.push(l)&&!i++||r!==n.debounceRendering)&&((r=n.debounceRendering)||t)(_)}function _(){for(var n;i=u.length;)n=u.sort(function(n,l){return n.__v.__b-l.__v.__b}),u=[],n.some(function(n){var l,u,i,t,r,o,f;n.__d&&(o=(r=(l=n).__v).__e,(f=l.__P)&&(u=[],(i=a({},r)).__v=i,t=A(f,r,i,l.__n,void 0!==f.ownerSVGElement,null,u,null==o?w(r):o),T(u,r),t!=o&&k(r)))})}function b(n,l,u,i,t,r,o,f,s){var a,h,p,y,d,m,k,g=u&&u.__k||c,_=g.length;if(f==e&&(f=null!=r?r[0]:_?w(u,0):null),a=0,l.__k=x(l.__k,function(u){if(null!=u){if(u.__=l,u.__b=l.__b+1,null===(p=g[a])||p&&u.key==p.key&&u.type===p.type)g[a]=void 0;else for(h=0;h<_;h++){if((p=g[h])&&u.key==p.key&&u.type===p.type){g[h]=void 0;break}p=null}if(y=A(n,u,p=p||e,i,t,r,o,f,s),(h=u.ref)&&p.ref!=h&&(k||(k=[]),p.ref&&k.push(p.ref,null,u),k.push(h,u.__c||y,u)),null!=y){var c;if(null==m&&(m=y),void 0!==u.__d)c=u.__d,u.__d=void 0;else if(r==p||y!=f||null==y.parentNode){n:if(null==f||f.parentNode!==n)n.appendChild(y),c=null;else{for(d=f,h=0;(d=d.nextSibling)&&h<_;h+=2)if(d==y)break n;n.insertBefore(y,f),c=f}\"option\"==l.type&&(n.value=\"\")}f=void 0!==c?c:y.nextSibling,\"function\"==typeof l.type&&(l.__d=f)}else f&&p.__e==f&&f.parentNode!=n&&(f=w(p))}return a++,u}),l.__e=m,null!=r&&\"function\"!=typeof l.type)for(a=r.length;a--;)null!=r[a]&&v(r[a]);for(a=_;a--;)null!=g[a]&&D(g[a],g[a]);if(k)for(a=0;a<k.length;a++)j(k[a],k[++a],k[++a])}function x(n,l,u){if(null==u&&(u=[]),null==n||\"boolean\"==typeof n)l&&u.push(l(null));else if(Array.isArray(n))for(var i=0;i<n.length;i++)x(n[i],l,u);else u.push(l?l(\"string\"==typeof n||\"number\"==typeof n?p(null,n,null,null,n):null!=n.__e||null!=n.__c?p(n.type,n.props,n.key,null,n.__v):n):n);return u}function P(n,l,u,i,t){var r;for(r in u)\"children\"===r||\"key\"===r||r in l||N(n,r,null,u[r],i);for(r in l)t&&\"function\"!=typeof l[r]||\"children\"===r||\"key\"===r||\"value\"===r||\"checked\"===r||u[r]===l[r]||N(n,r,l[r],u[r],i)}function C(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=\"number\"==typeof u&&!1===s.test(l)?u+\"px\":null==u?\"\":u}function N(n,l,u,i,t){var r,o,f,e,c;if(t?\"className\"===l&&(l=\"class\"):\"class\"===l&&(l=\"className\"),\"style\"===l)if(r=n.style,\"string\"==typeof u)r.cssText=u;else{if(\"string\"==typeof i&&(r.cssText=\"\",i=null),i)for(e in i)u&&e in u||C(r,e,\"\");if(u)for(c in u)i&&u[c]===i[c]||C(r,c,u[c])}else\"o\"===l[0]&&\"n\"===l[1]?(o=l!==(l=l.replace(/Capture$/,\"\")),f=l.toLowerCase(),l=(f in n?f:l).slice(2),u?(i||n.addEventListener(l,z,o),(n.l||(n.l={}))[l]=u):n.removeEventListener(l,z,o)):\"list\"!==l&&\"tagName\"!==l&&\"form\"!==l&&\"type\"!==l&&\"size\"!==l&&!t&&l in n?n[l]=null==u?\"\":u:\"function\"!=typeof u&&\"dangerouslySetInnerHTML\"!==l&&(l!==(l=l.replace(/^xlink:?/,\"\"))?null==u||!1===u?n.removeAttributeNS(\"http://www.w3.org/1999/xlink\",l.toLowerCase()):n.setAttributeNS(\"http://www.w3.org/1999/xlink\",l.toLowerCase(),u):null==u||!1===u&&!/^ar/.test(l)?n.removeAttribute(l):n.setAttribute(l,u))}function z(l){this.l[l.type](n.event?n.event(l):l)}function A(l,u,i,t,r,o,f,e,c){var s,v,h,p,y,w,k,g,_,x,P=u.type;if(void 0!==u.constructor)return null;(s=n.__b)&&s(u);try{n:if(\"function\"==typeof P){if(g=u.props,_=(s=P.contextType)&&t[s.__c],x=s?_?_.props.value:s.__:t,i.__c?k=(v=u.__c=i.__c).__=v.__E:(\"prototype\"in P&&P.prototype.render?u.__c=v=new P(g,x):(u.__c=v=new m(g,x),v.constructor=P,v.render=E),_&&_.sub(v),v.props=g,v.state||(v.state={}),v.context=x,v.__n=t,h=v.__d=!0,v.__h=[]),null==v.__s&&(v.__s=v.state),null!=P.getDerivedStateFromProps&&(v.__s==v.state&&(v.__s=a({},v.__s)),a(v.__s,P.getDerivedStateFromProps(g,v.__s))),p=v.props,y=v.state,h)null==P.getDerivedStateFromProps&&null!=v.componentWillMount&&v.componentWillMount(),null!=v.componentDidMount&&v.__h.push(v.componentDidMount);else{if(null==P.getDerivedStateFromProps&&g!==p&&null!=v.componentWillReceiveProps&&v.componentWillReceiveProps(g,x),!v.__e&&null!=v.shouldComponentUpdate&&!1===v.shouldComponentUpdate(g,v.__s,x)||u.__v===i.__v&&!v.__){for(v.props=g,v.state=v.__s,u.__v!==i.__v&&(v.__d=!1),v.__v=u,u.__e=i.__e,u.__k=i.__k,v.__h.length&&f.push(v),s=0;s<u.__k.length;s++)u.__k[s]&&(u.__k[s].__=u);break n}null!=v.componentWillUpdate&&v.componentWillUpdate(g,v.__s,x),null!=v.componentDidUpdate&&v.__h.push(function(){v.componentDidUpdate(p,y,w)})}v.context=x,v.props=g,v.state=v.__s,(s=n.__r)&&s(u),v.__d=!1,v.__v=u,v.__P=l,s=v.render(v.props,v.state,v.context),u.__k=null!=s&&s.type==d&&null==s.key?s.props.children:Array.isArray(s)?s:[s],null!=v.getChildContext&&(t=a(a({},t),v.getChildContext())),h||null==v.getSnapshotBeforeUpdate||(w=v.getSnapshotBeforeUpdate(p,y)),b(l,u,i,t,r,o,f,e,c),v.base=u.__e,v.__h.length&&f.push(v),k&&(v.__E=v.__=null),v.__e=!1}else null==o&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=$(i.__e,u,i,t,r,o,f,c);(s=n.diffed)&&s(u)}catch(l){u.__v=null,n.__e(l,u,i)}return u.__e}function T(l,u){n.__c&&n.__c(u,l),l.some(function(u){try{l=u.__h,u.__h=[],l.some(function(n){n.call(u)})}catch(l){n.__e(l,u.__v)}})}function $(n,l,u,i,t,r,o,f){var s,a,v,h,p,y=u.props,d=l.props;if(t=\"svg\"===l.type||t,null!=r)for(s=0;s<r.length;s++)if(null!=(a=r[s])&&((null===l.type?3===a.nodeType:a.localName===l.type)||n==a)){n=a,r[s]=null;break}if(null==n){if(null===l.type)return document.createTextNode(d);n=t?document.createElementNS(\"http://www.w3.org/2000/svg\",l.type):document.createElement(l.type,d.is&&{is:d.is}),r=null,f=!1}if(null===l.type)y!==d&&n.data!=d&&(n.data=d);else{if(null!=r&&(r=c.slice.call(n.childNodes)),v=(y=u.props||e).dangerouslySetInnerHTML,h=d.dangerouslySetInnerHTML,!f){if(y===e)for(y={},p=0;p<n.attributes.length;p++)y[n.attributes[p].name]=n.attributes[p].value;(h||v)&&(h&&v&&h.__html==v.__html||(n.innerHTML=h&&h.__html||\"\"))}P(n,d,y,t,f),h?l.__k=[]:(l.__k=l.props.children,b(n,l,u,i,\"foreignObject\"!==l.type&&t,r,o,e,f)),f||(\"value\"in d&&void 0!==(s=d.value)&&s!==n.value&&N(n,\"value\",s,y.value,!1),\"checked\"in d&&void 0!==(s=d.checked)&&s!==n.checked&&N(n,\"checked\",s,y.checked,!1))}return n}function j(l,u,i){try{\"function\"==typeof l?l(u):l.current=u}catch(l){n.__e(l,i)}}function D(l,u,i){var t,r,o;if(n.unmount&&n.unmount(l),(t=l.ref)&&(t.current&&t.current!==l.__e||j(t,null,u)),i||\"function\"==typeof l.type||(i=null!=(r=l.__e)),l.__e=l.__d=void 0,null!=(t=l.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(l){n.__e(l,u)}t.base=t.__P=null}if(t=l.__k)for(o=0;o<t.length;o++)t[o]&&D(t[o],u,i);null!=r&&v(r)}function E(n,l,u){return this.constructor(n,u)}function H(l,u,i){var t,r,f;n.__&&n.__(l,u),r=(t=i===o)?null:i&&i.__k||u.__k,l=h(d,null,[l]),f=[],A(u,(t?u:i||u).__k=l,r||e,e,void 0!==u.ownerSVGElement,i&&!t?[i]:r?null:c.slice.call(u.childNodes),f,i||e,t),T(f,l)}function I(n,l){H(n,l,o)}function L(n,l){var u,i;for(i in l=a(a({},n.props),l),arguments.length>2&&(l.children=c.slice.call(arguments,2)),u={},l)\"key\"!==i&&\"ref\"!==i&&(u[i]=l[i]);return p(n.type,u,l.key||n.key,l.ref||n.ref,null)}function M(n){var l={},u={__c:\"__cC\"+f++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var i,t=this;return this.getChildContext||(i=[],this.getChildContext=function(){return l[u.__c]=t,l},this.shouldComponentUpdate=function(n){t.props.value!==n.value&&i.some(function(l){l.context=n.value,g(l)})},this.sub=function(n){i.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){i.splice(i.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Consumer.contextType=u,u.Provider.__=u,u}n={__e:function(n,l){for(var u,i;l=l.__;)if((u=l.__c)&&!u.__)try{if(u.constructor&&null!=u.constructor.getDerivedStateFromError&&(i=!0,u.setState(u.constructor.getDerivedStateFromError(n))),null!=u.componentDidCatch&&(i=!0,u.componentDidCatch(n)),i)return g(u.__E=u)}catch(l){n=l}throw n}},l=function(n){return null!=n&&void 0===n.constructor},m.prototype.setState=function(n,l){var u;u=this.__s!==this.state?this.__s:this.__s=a({},this.state),\"function\"==typeof n&&(n=n(u,this.props)),n&&a(u,n),null!=n&&this.__v&&(l&&this.__h.push(l),g(this))},m.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),g(this))},m.prototype.render=d,u=[],i=0,t=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,o=e,f=0;export{H as render,I as hydrate,h as createElement,h,d as Fragment,y as createRef,l as isValidElement,m as Component,L as cloneElement,M as createContext,x as toChildArray,D as _unmount,n as options};\n//# sourceMappingURL=preact.module.js.map\n","\nexport const RGBtoHSL = (rgb) => {\n  // Make r, g, and b fractions of 1\n  let r = rgb[0] / 255\n  let g = rgb[1] / 255\n  let b = rgb[2] / 255\n\n  // Find greatest and smallest channel values\n  let cmin = Math.min(r, g, b)\n  let cmax = Math.max(r, g, b)\n  let delta = cmax - cmin\n  let h = 0\n  let s = 0\n  let l = 0\n\n  if (delta === 0) {\n    h = 0\n  } else if (cmax === r) {\n    h = ((g - b) / delta) % 6\n  } else if (cmax === g) {\n    h = (b - r) / delta + 2\n  } else {\n    h = (r - g) / delta + 4\n  }\n\n  h = Math.round(h * 60)\n\n  // Make negative hues positive behind 360Â°\n  if (h < 0) h += 360\n\n  l = (cmax + cmin) / 2\n\n  // Calculate saturation\n  s = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))\n\n  // Multiply l and s by 100\n  s = +(s * 100).toFixed(1)\n  l = +(l * 100).toFixed(1)\n\n  return [ Math.floor(h), Math.floor(s), Math.floor(l), 255 ]\n}\n\nexport const HSLtoRGB = (hsl) => {\n  const h = hsl[0]\n  const s = hsl[1] / 100\n  const l = hsl[2] / 100\n\n  let c = (1 - Math.abs(2 * l - 1)) * s\n  let x = c * (1 - Math.abs((hsl[0] / 60) % 2 - 1))\n  let m = l - c / 2\n  let r = 0\n  let g = 0\n  let b = 0\n\n  if (h >= 0 && h < 60) {\n    r = c; g = x; b = 0\n  } else if (h >= 60 && h < 120) {\n    r = x; g = c; b = 0\n  } else if (h >= 120 && h < 180) {\n    r = 0; g = c; b = x\n  } else if (h >= 180 && h < 240) {\n    r = 0; g = x; b = c\n  } else if (h >= 240 && h < 300) {\n    r = x; g = 0; b = c\n  } else if (h >= 300 && h < 360) {\n    r = c; g = 0; b = x\n  }\n\n  r = Math.round((r + m) * 255)\n  g = Math.round((g + m) * 255)\n  b = Math.round((b + m) * 255)\n\n  return [ r, g, b, 255 ]\n}","import { RGBtoHSL } from './utils'\n\nexport const APP = {}\nexport const VIEW = { render: undefined }\nexport const canvases = ['canvasSelection', 'canvasPreview', 'canvasTemp', 'canvasFinal', 'canvasView']\n\nconst initAppDefault = (w, h) => {\n  APP.width = w\n  APP.height = h\n  APP.tool = 'pencil'\n\n  APP.frameActive = 0\n  APP.layerActive = 0\n  APP.frameCount = 1 \n  APP.layerCount = 1  \n  APP.layers = [\n    {\n      name: 'Layer 1',\n      hidden: false,\n      frames: [new ImageData(w, h)]\n    }\n  ]\n  \n  APP.color = {}\n  APP.color.rgb = [100, 188, 156, 255]\n  APP.color.hsl = RGBtoHSL(APP.color.rgb)\n\n  APP.palette = [\n    [26, 188, 156, 255],\n    [46, 204, 113, 255],\n    [52, 152, 219, 255],\n    [155, 89, 182, 255],\n    [52, 73, 94, 255],\n    [22, 160, 133, 255],\n    [39, 174, 96, 255],\n    [41, 128, 185, 255],\n    [142, 68, 173, 255],\n    [44, 62, 80, 255],\n    [241, 196, 15, 255],\n    [230, 126, 34, 255],\n    [231, 76, 60, 255],\n    [236, 240, 241, 255],\n    [149, 165, 166, 255],\n    [243, 156, 18, 255],\n    [211, 84, 0, 255],\n    [192, 57, 43, 255],\n    [189, 195, 199, 255],\n    [127, 140, 141, 255]\n  ]\n  \n  Object.seal(APP)\n}\n\nexport const initCanvases = () => {\n  canvases.forEach(canvas => {\n    VIEW[canvas].dom = canvas === 'canvasView' ? document.querySelector('#canvas-view') : document.createElement('canvas')\n    VIEW[canvas].dom.width = APP.width\n    VIEW[canvas].dom.height = APP.height\n    VIEW[canvas].ctx = VIEW[canvas].dom.getContext('2d')\n    VIEW[canvas].imgData = VIEW[canvas].ctx.getImageData(0, 0, APP.width, APP.height)\n  })\n}\n\nconst initViewDefault = (preventOnMount) => {\n  VIEW.file = { open: false }\n  VIEW.color = { open: false }\n  VIEW.newCanvas = { open: false, w: 32, h: 32 }\n  VIEW.downloadCanvas = { open: false, size: 2, type: 'frame' }\n\n  VIEW.window = {\n    request: '',\n    mouseDown: false,\n    startX: 0,\n    startY: 0,\n    prevX: 0,\n    prevY: 0,\n    currX: 0,\n    currY: 0\n  }\n\n  VIEW.brushSize = 0\n\n  VIEW.timerID = undefined\n  VIEW.isPlaying = false\n  VIEW.onionSkinning = false\n\n  VIEW.undo = []\n  VIEW.undoPos = -1\n  VIEW.currUndoRef = {}\n\n  // need to reset these on new project\n  canvases.forEach(canvas => {\n    VIEW[canvas] = {\n      dom: undefined,\n      ctx: undefined,\n      imgData: undefined\n    }\n  })\n\n  if (preventOnMount !== true) {\n    initCanvases()\n  }\n\n  Object.seal(VIEW)\n}\n\nexport const newData = (w, h, preventOnMount) => {\n  initAppDefault(w, h)\n  initViewDefault(preventOnMount)\n}","import { VIEW } from './data'\n\nexport const addToUndo = (action, type = '') => {\n  VIEW.undo.splice(0, VIEW.undoPos + 1, {\n    icon: `${action}.svg`,\n    action: `${action} ${type}`,\n    undo: undo,\n    redo: redo\n  })\n\n  if (VIEW.undoPos >= 0) VIEW.undoPos = -1  \n  if (VIEW.undo.length > 50) VIEW.undo.pop()\n\n  VIEW.currUndoRef = VIEW.undo[VIEW.undoPos + 1]\n}\n\nexport const undo = () => {\n  if (VIEW.undoPos + 1 === VIEW.undo.length) return\n\n  VIEW.undoPos += 1\n  VIEW.undo[VIEW.undoPos].undo()\n\n  VIEW.render()\n}\n\nexport const redo = () => {\n  if (VIEW.undoPos - 1 === -2) return\n\n  if (VIEW.undo[VIEW.undoPos].redo) VIEW.undo[VIEW.undoPos].redo()\n  VIEW.undoPos -= 1\n\n  VIEW.render()\n}","import { h, render } from 'preact'\nimport { RGBtoHSL, HSLtoRGB } from './utils'\nimport { APP, VIEW, canvases } from './data'\nimport { addToUndo, undo, redo } from './undo-redo'\n\n// Colors\nconst colorSetHSL = (hsl) => {\n  APP.color.hsl = hsl\n  APP.color.rgb = HSLtoRGB(hsl)\n\n  VIEW.render()\n}\n\nexport const colorSetRGB = (rgb) => {\n  APP.color.rgb = rgb\n  APP.color.hsl = RGBtoHSL(rgb)\n\n  VIEW.render()\n}\n\nconst paletteAdd = () => {\n  APP.palette.push(APP.color.rgb)\n  \n  VIEW.render()\n}\n\nconst paletteDelete = (i) => {\n  const index = APP.palette.indexOf(APP.color.rgb)\n\n  if (index !== -1) {\n    APP.palette.splice(index, 1)\n    VIEW.render()\n  } \n}\n\nexport const Color = () => {\n  return (\n    <div>\n      <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n        <small><b>Color</b></small>\n      </div>\n      <div class='fl fl-justify-between'>\n        <div class='fl-1 fl fl-center-y p-h-10 bord-dark-b h-30 bord-dark-b'>\n          <div\n            class='no-ptr h-30'\n            style={`min-height: 18px; width: 18px; border-radius: 100%; background: rgba(${APP.color.rgb[0]}, ${APP.color.rgb[1]}, ${APP.color.rgb[2]}, 255);`} />\n        </div>\n        <div class='fl bord-dark-b h-30'>\n          {APP.palette.filter(c =>\n            APP.color.rgb[0] === c[0] &&\n            APP.color.rgb[1] === c[1] &&\n            APP.color.rgb[2] === c[2] &&\n            APP.color.rgb[3] === c[3])\n            .length === 0 &&\n              <button\n                onClick={() => { paletteAdd() }}\n                class='w-30 fl fl-center rel bord-dark-l'>\n                <img src={`img/insert.svg`} />\n              </button>\n          }\n          {APP.palette.filter(c =>\n            APP.color.rgb[0] === c[0] &&\n            APP.color.rgb[1] === c[1] &&\n            APP.color.rgb[2] === c[2] &&\n            APP.color.rgb[3] === c[3])\n            .length !== 0 &&\n            <button\n              onClick={() => { paletteDelete() }}\n              class='w-30 fl fl-center bord-dark-l'>\n              <img src={`img/delete.svg`} />\n            </button>\n          }\n        </div>\n          \n      </div>\n      <div\n        onInput={(e) => {\n          const hsl = [APP.color.hsl[0], APP.color.hsl[1], APP.color.hsl[2], APP.color.hsl[3]]\n          hsl[parseInt(e.target.dataset.index)] = parseInt(e.target.value)\n          \n          colorSetHSL(hsl)\n        }}\n        class='bg-light fl-column p-10 b-r-2 overflow-none'>\n        <div class='b-r-2 overflow-none'>\n          <div class='fl-column'>\n            <form class='fl-column' autocomplete='off'>\n              <input\n                id='hsl'\n                data-index='0'\n                type='range'\n                class='w-full m-0'\n                style='height: 25px; background: linear-gradient(to right, #ff0000 0%, #ffff00 17%, #00ff00 33%, #00ffff 50%, #0000ff 67%, #ff00ff 83%, #ff0000 100%);'\n                min='0'\n                max='359'\n                value={APP.color.hsl[0]}/>\n            </form>\n          </div>\n          <div class='fl-column'>\n            <form class='fl-column' autocomplete='off'>\n              <input\n                value={APP.color.hsl[1]}\n                data-index='1'\n                type='range'\n                class='w-full m-0'\n                style={`height: 25px; background: linear-gradient(to right, hsl(${APP.color.hsl[0]}, 0%, 50%) 0%,hsl(${APP.color.hsl[0]}, 100%, 50%) 100%);`}/>\n            </form>\n          </div>\n          <div class='fl-column'>\n            <form class='fl-column' autocomplete='off'>\n              <input\n                value={APP.color.hsl[2]}\n                data-index='2'\n                type='range'\n                class='w-full m-0'\n                style={`height: 25px; background: linear-gradient(to right, hsl(${APP.color.hsl[0]}, 100%, 0%) 0%, hsl(${APP.color.hsl[0]}, 100%, 50%) 50%, hsl(${APP.color.hsl[0]}, 100%, 100%) 100%)`}/>\n            </form>\n        </div>\n        </div>\n      </div>\n      <div class='p-h-10 bord-dark-b' style='padding-bottom: 10px;'>\n        <div class='fl fl-wrap b-r-2 overflow-none' style='align-content: baseline;'>\n          {\n            APP.palette.map(c =>\n              <button\n                onClick={() => {\n                  colorSetRGB(c)\n                }}\n                class='m-0'\n                style={`\n                  width: 44px;\n                  min-height: 25px;\n                  background: rgba(${c[0]}, ${c[1]}, ${c[2]}, ${c[3]});\n                  border: ${\n                    APP.color.rgb[0] === c[0] &&\n                    APP.color.rgb[1] === c[1] &&\n                    APP.color.rgb[2] === c[2] &&\n                    APP.color.rgb[3] === c[3] ? '2px solid rgba(61,61,61, 1)' : '2px solid rgba(61,61,61, 0)'};\n                  box-shadow: inset 0px 0px 0px 1px rgba(255, 255, 255, ${\n                    APP.color.rgb[0] === c[0] &&\n                    APP.color.rgb[1] === c[1] &&\n                    APP.color.rgb[2] === c[2] &&\n                    APP.color.rgb[3] === c[3] ? '255' : '0'});\n                `} />\n            )\n          }\n        </div>\n      </div>\n    </div>\n  )\n}","import { h, render } from 'preact'\nimport { APP, VIEW, canvases } from './data'\nimport { addToUndo } from './undo-redo'\nimport { colorSetRGB } from './color'\n\nexport const setTool = (tool) => {\n  APP.tool = tool\n  VIEW.render()\n}\n\nconst getPoint = (imgDataArr, x, y, w, h) => {\n  if (!imgDataArr) throw Error(`setPoint: ${imgDataArr} undefined`)\n  if (!imgDataArr.length) throw Error(`setPoint: ${imgDataArr} not a valid array`)\n\n  if (x >= 0 && x < w && y >= 0 && y < h) { // check bounds\n    const i = (x + w * y) * 4\n    return [\n      imgDataArr[i + 0],\n      imgDataArr[i + 1],\n      imgDataArr[i + 2],\n      imgDataArr[i + 3]\n    ]\n  }\n\n  return [0, 0, 0, 0]\n}\n\nconst setPoint = (imgDataArr, x, y, w, h, color) => {\n  if (!imgDataArr) throw Error(`setPoint: ${imgDataArr} undefined`)\n  if (!imgDataArr.length) throw Error(`setPoint: ${imgDataArr} not a valid array`)\n  \n  if (x >= 0 && x < w && y >= 0 && y < h) { // check bounds\n    const i = (x + w * y) * 4\n    imgDataArr[i + 0] = color[0]\n    imgDataArr[i + 1] = color[1]\n    imgDataArr[i + 2] = color[2]\n    imgDataArr[i + 3] = color[3]\n  }\n}\n\nconst areRGBAsEqual = (c1, a, c2, b) => {\n  return (\n    c1[a + 0] === c2[b + 0] &&\n    c1[a + 1] === c2[b + 1] &&\n    c1[a + 2] === c2[b + 2] &&\n    c1[a + 3] === c2[b + 3]\n  )\n}\n\nconst getColorAtPixel = (data, x, y, w) => {\n  const linearCord = (y * w + x) * 4\n\n  return [\n    data[linearCord + 0],\n    data[linearCord + 1],\n    data[linearCord + 2],\n    data[linearCord + 3]\n  ]\n}\n\nconst fill = (canvasImgData, startX, startY, w, h, color) => { // http://www.williammalone.com/articles/html5-canvas-javascript-paint-bucket-tool/\n  var linear_cords = (startY * w + startX) * 4;\n\n  var pixel_stack = [{ x: startX, y: startY }];\n  var original_color = getColorAtPixel(canvasImgData, startX, startY, w);\n\n  if (areRGBAsEqual(color, 0, original_color, 0)) {\n    return\n  }\n\n  while (pixel_stack.length > 0) {\n    var new_pixel = pixel_stack.shift();\n    var x = new_pixel.x;\n    var y = new_pixel.y;\n\n    linear_cords = (y * w + x) * 4;\n\n    while (\n      y-- >= 0 &&\n      canvasImgData[linear_cords + 0] === original_color[0] &&\n      canvasImgData[linear_cords + 1] === original_color[1] &&\n      canvasImgData[linear_cords + 2] === original_color[2] &&\n      canvasImgData[linear_cords + 3] === original_color[3]) {\n        linear_cords -= w * 4;\n    }\n\n    linear_cords += w * 4;\n    y++;\n\n    var reached_left = false;\n    var reached_right = false;\n\n    while (\n      y++ < h &&\n      canvasImgData[linear_cords + 0] === original_color[0] &&\n      canvasImgData[linear_cords + 1] === original_color[1] &&\n      canvasImgData[linear_cords + 2] === original_color[2] &&\n      canvasImgData[linear_cords + 3] === original_color[3]\n    ) {\n      canvasImgData[linear_cords + 0] = color[0];\n      canvasImgData[linear_cords + 1] = color[1];\n      canvasImgData[linear_cords + 2] = color[2];\n      canvasImgData[linear_cords + 3] = color[3];\n\n      if (x > 0) {\n        if (\n          canvasImgData[linear_cords - 4 + 0] === original_color[0] &&\n          canvasImgData[linear_cords - 4 + 1] === original_color[1] &&\n          canvasImgData[linear_cords - 4 + 2] === original_color[2] &&\n          canvasImgData[linear_cords - 4 + 3] === original_color[3]\n        ) {\n          if (!reached_left) {\n            pixel_stack.push({ x: x - 1, y: y });\n            reached_left = true;\n          }\n        } else if (reached_left) {\n          reached_left = false;\n        }\n      }\n  \n      if (x < w - 1) {\n        if (\n          canvasImgData[linear_cords + 4 + 0] === original_color[0] &&\n          canvasImgData[linear_cords + 4 + 1] === original_color[1] &&\n          canvasImgData[linear_cords + 4 + 2] === original_color[2] &&\n          canvasImgData[linear_cords + 4 + 3] === original_color[3]\n        ) {\n          if (!reached_right) {\n            pixel_stack.push({ x: x + 1, y: y });\n            reached_right = true;\n          }\n        } else if (reached_right) {\n          reached_right = false;\n        }\n      }\n      \n      linear_cords += w * 4;\n    }\n  }\n}\n\nconst line = (startX, startY, endX, endY, func) => {\n  let dx = Math.abs(endX - startX)\n  let dy = Math.abs(endY - startY)\n\n  let xDir = endX - startX >= 0 ? 1 : -1\n  let yDir = endY - startY >= 0 ? 1 : -1\n  \n  let lineX = startX\n  let lineY = startY\n\n  let step = dx >= dy ? dx : dy\n\n  dx = dx / step\n  dy = dy / step\n  \n  let i = 0\n  while (i < step) {\n    func(Math.floor(lineX), Math.floor(lineY))\n\n    lineX += (dx * xDir)\n    lineY += (dy * yDir)\n    i += 1\n  }\n\n  func(Math.floor(lineX), Math.floor(lineY))\n}\n\nconst circle = (xCenter, yCenter, currX, currY, func) => {\n  let radius = Math.floor(Math.sqrt(Math.pow((currX - xCenter), 2) + Math.pow((currY - yCenter), 2)))\n\n  if (radius <= 0) return\n\n  let x = 0\n  let y = radius\n  let p = 1 - radius\n\n  const circlePlot = () => {\n    func(xCenter + x, yCenter + y)\n    func(xCenter + y, yCenter + x)\n    func(xCenter - x, yCenter + y)\n    func(xCenter - y, yCenter + x)\n    func(xCenter + x, yCenter - y)\n    func(xCenter + y, yCenter - x)\n    func(xCenter - x, yCenter - y)\n    func(xCenter - y, yCenter - x)\n  }\n\n  // Plot first set of points\n  circlePlot(xCenter, yCenter, x, y)\n\n  while (x <= y) {\n    x++\n    if (p < 0) {\n      p += 2 * x + 1 // Mid point is inside therefore y remains same\n    } else { // Mid point is outside the circle so y decreases\n      y--\n      p += 2 * (x - y) + 1\n    }\n\n    circlePlot(xCenter, yCenter, x, y)\n  }\n}\n\nfunction squareFilled (startX, startY, endX, endY, w, h, color, func) {\n  let points = []\n\n  let dx = Math.abs(endX - startX)\n  let dy = Math.abs(endY - startY)\n\n  let xDir = endX - startX >= 0 ? 1 : -1\n  let yDir = endY - startY >= 0 ? 1 : -1\n\n  let lineX = startX\n  let lineY = startY\n\n  let xStep = 0\n  let yStep = 0\n\n  while (xStep <= dx) {\n    yStep = 0\n    lineY = startY\n\n    while (yStep <= dy) {\n      func(lineX, lineY)\n      //points.push({ x: lineX, y: lineY })\n\n      lineY += (1 * yDir)\n      yStep += 1\n    }\n\n    lineX += (1 * xDir)\n    xStep += 1\n  }\n\n  return points\n}\n\nconst square = (startX, startY, endX, endY, func) => {\n  let dx = Math.abs(endX - startX)\n  let dy = Math.abs(endY - startY)\n\n  let xDir = endX - startX >= 0 ? 1 : -1\n  let yDir = endY - startY >= 0 ? 1 : -1\n\n  let lineX = startX\n  let lineY = startY\n  let i = 0\n\n  func(lineX, lineY)\n\n  while (i < dx) {\n    lineX += (1 * xDir)\n    func(lineX, startY)\n    func(lineX, (startY + (dy * yDir)))\n    i += 1\n  }\n\n  i = 0\n\n  while (i < dy) {\n    lineY += (1 * yDir)\n    func(startX, lineY)\n    func((startX + (dx * xDir)), lineY)\n    i += 1\n  }\n}\n\nexport const paintCanvas = (gestureEvent) => {\n  // Reset\n  VIEW.canvasPreview.ctx.clearRect(0, 0, APP.width, APP.height)\n  VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n  // Whole or Selection\n  const target = APP.layers[APP.layerActive].frames[APP.frameActive].data // or selection buffer\n  const preview = VIEW.canvasPreview.imgData.data\n\n  // Translate coordinates based on current screen position and canvas scale\n  const bb = VIEW.canvasView.dom.getBoundingClientRect()\n\n  const scaleX = bb.width / VIEW.canvasView.dom.width\n  const scaleY = bb.height / VIEW.canvasView.dom.height\n\n  const startX = Math.floor((VIEW.window.startX - bb.x) / scaleX)\n  const startY = Math.floor((VIEW.window.startY - bb.y) / scaleY)\n  const prevX = Math.floor((VIEW.window.prevX - bb.x) / scaleX)\n  const prevY = Math.floor((VIEW.window.prevY - bb.y) / scaleY)\n  const currX = Math.floor((VIEW.window.currX - bb.x) / scaleX)\n  const currY = Math.floor((VIEW.window.currY - bb.y) / scaleY)\n\n  const setBrushPoints = (canvas, x, y, w, h, color) => {\n    squareFilled(x - VIEW.brushSize, y - VIEW.brushSize, x + VIEW.brushSize, y + VIEW.brushSize, w, h, color, (x, y) => {\n      setPoint(canvas, x, y, w, h, color)\n    })\n  }\n\n  if (gestureEvent === 'hover' && APP.tool !== 'eye-dropper' && APP.tool !== 'move') {\n    setBrushPoints(preview, currX, currY, APP.width, APP.height, APP.tool !== 'eraser' ? APP.color.rgb : [0, 0, 0, 50])\n    VIEW.render()\n\n    return\n  }\n\n  // Setup Undo\n  if (gestureEvent === 'start' && APP.tool !== 'eye-dropper') {\n    const copy = new ImageData(APP.width, APP.height)\n    copy.data.set(APP.layers[APP.layerActive].frames[APP.frameActive].data)\n    const layerActive = APP.layerActive\n    const frameActive = APP.frameActive\n    \n    addToUndo(APP.tool)\n\n    VIEW.currUndoRef.undo = () => {\n      APP.frameActive = frameActive\n      APP.layerActive = layerActive\n      APP.layers[layerActive].frames[frameActive].data.set(copy.data)\n    }\n  }\n  \n  // Eye dropper\n  if (gestureEvent === 'end' && APP.tool === 'eye-dropper') {\n    const color = getPoint(target, currX, currY, APP.width, APP.height)\n    \n    if (color[3] !== 0) {\n      colorSetRGB(color)\n    }\n  }\n\n  // Fill\n  if (gestureEvent === 'end' && APP.tool === 'fill') {\n    fill(target, currX, currY, APP.width, APP.height, APP.color.rgb)\n  }\n\n  // Points\n  if (APP.tool === 'pencil' || APP.tool === 'eraser') {\n    if (APP.tool === 'eraser') {\n      setBrushPoints(preview, currX, currY, APP.width, APP.height, [0, 0, 0, 50])\n    }\n    \n    line(prevX, prevY, currX, currY, (x, y) => {\n      setBrushPoints(target, x, y, APP.width, APP.height, APP.tool === 'pencil' ? APP.color.rgb : [0, 0, 0, 0])\n    })\n  }\n\n  // Geometry\n  if (APP.tool === 'line' || APP.tool === 'circle' || APP.tool === 'square') {\n    const funcs = { 'line': line, 'circle': circle, 'square': square }\n    \n    funcs[APP.tool](startX, startY, currX, currY, (x, y) => {\n      setBrushPoints(gestureEvent === 'start' || gestureEvent === 'resume' ? preview : target, x, y, APP.width, APP.height, APP.color.rgb)\n    })\n  }\n\n  // Move\n  if (APP.tool === 'move') {\n    if (gestureEvent === 'start') {\n      // Frame to Selection\n      VIEW.canvasSelection.ctx.putImageData(APP.layers[APP.layerActive].frames[APP.frameActive], 0, 0)\n      VIEW.canvasSelection.imgData = VIEW.canvasSelection.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      // Selection to Preview\n      VIEW.canvasPreview.ctx.putImageData(VIEW.canvasSelection.imgData, 0, 0)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      // Clear main canvas\n      APP.layers[APP.layerActive].frames[APP.frameActive] = new ImageData(APP.width, APP.height)\n    }\n\n    if (gestureEvent === 'resume') {\n      // Selection to Preview\n      VIEW.canvasPreview.ctx.putImageData(VIEW.canvasSelection.imgData, prevX - startX, prevY - startY)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n    }\n\n    if (gestureEvent === 'end') {\n      // Selection to Preview\n      VIEW.canvasPreview.ctx.putImageData(VIEW.canvasSelection.imgData, prevX - startX, prevY - startY)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      // Preview to Main\n      APP.layers[APP.layerActive].frames[APP.frameActive] = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n\n      VIEW.canvasPreview.ctx.clearRect(0, 0, APP.width, APP.height)\n      VIEW.canvasPreview.imgData = VIEW.canvasPreview.ctx.getImageData(0, 0, APP.width, APP.height)\n    }\n  }\n\n  // Setup Redo\n  if (gestureEvent === 'end' && APP.tool !== 'eye-dropper') {\n    const copy = new ImageData(APP.width, APP.height)\n    copy.data.set(APP.layers[APP.layerActive].frames[APP.frameActive].data)\n    const layerActive = APP.layerActive\n    const frameActive = APP.frameActive\n\n    VIEW.currUndoRef.redo = () => {\n      APP.frameActive = frameActive\n      APP.layerActive = layerActive\n      APP.layers[layerActive].frames[frameActive].data.set(copy.data)\n    }\n  }\n\n  VIEW.render()\n}\n\nexport const Canvas = () => {\n  return <div id='canvas-inner-scroll' data-request='paintCanvas' data-hover='paintCanvas' class='fl fl-center fl-1' style='width: 1920px; height: 1920px;'>\n    <canvas                      \n      id='canvas-view'\n      width={APP.width}\n      height={APP.height}\n      style='width: 1920px; height: 1920px; transform: scale(.25); pointer-events: none;' />\n  </div>\n}","import { undo, redo } from './undo-redo'\nimport { setTool } from './canvas'\n\nconst keyMap = {\n  metaKey: {\n    z: undo\n  },\n  shiftKey: {\n    metaKey: {\n      z: redo\n    }\n  },\n  b: () => {\n    setTool('pencil')\n  },\n  e: () => {\n    setTool('eraser')\n  },\n  u: () => {\n    setTool('line')\n  },\n  g: () => {\n    setTool('fill')\n  },\n  l: () => {\n    setTool('eye-dropper')\n  },\n  v: () => {\n    setTool('move')\n  }\n}\n\nlet shiftKeyMark = Date.now()\nlet metaKeyMark = Date.now()\nlet alphaKeyMark = Date.now()\n\nexport const setupKeyListeners = () => {\n  window.addEventListener('keydown', (e) => {\n    const key = e.key.toLowerCase()\n    \n    if (!e.repeat && key === 'meta') {\n      metaKeyMark = Date.now()\n    } \n\n    if (!e.repeat && key === 'shift') {\n      shiftKeyMark = Date.now()\n    } \n\n    if (!e.repeat && key === 'z') {\n      alphaKeyMark = Date.now()\n    }\n\n    if (e.shiftKey && e.metaKey) {\n      if ((shiftKeyMark < metaKeyMark < alphaKeyMark) && key === 'z') {\n        keyMap.shiftKey.metaKey['z']()\n      }\n    }\n    \n    if (!e.shiftKey && e.metaKey) {\n      if ((metaKeyMark < alphaKeyMark) && key === 'z') {\n        keyMap.metaKey['z']()\n      }\n    }\n\n    if (e.shiftKey && !e.metaKey) {\n      if ((shiftKeyMark < alphaKeyMark) && key === 'z') {\n        // keyMap.shiftKey['z']()\n      }\n    }\n\n    if (!e.shiftKey && !e.metaKey && keyMap[e.key.toLowerCase()]) {\n      keyMap[e.key.toLowerCase()]()\n    }\n  })\n}\n","import { h, render } from 'preact'\nimport { APP, VIEW, canvases } from './data'\nimport { addToUndo } from './undo-redo'\n\nconst setTargetCanvas = (frame, layer) => {\n  if (frame === undefined) console.error('setTargetCanvas - no frame given')\n  if (layer === undefined) console.error('setTargetCanvas - no layer given')\n\n  APP.frameActive = frame\n  APP.layerActive = layer\n\n  VIEW.render()\n}\n\nconst seq = (request, type, data) => {\n  const inserting = request === 'insert' || request === 'duplicate'\n  \n  function action (req, ref, target, entry) {\n    if (req === 'insert') ref.splice(target + 1, 0, entry)\n    if (req === 'delete') ref.splice(target, 1)\n  }\n\n  if (type === 'layer') {\n    if (request === 'insert') {\n      action(request, APP.layers, APP.layerActive, data)\n    }\n\n    if (request === 'delete') {\n      action(request, APP.layers, APP.layerActive)\n    }\n  }\n\n  if (type === 'frame') {\n    if (request === 'insert') {\n      APP.layers.forEach((layer, i) => {\n        const entry = new ImageData(APP.width, APP.height)\n        entry.data.set(data[i].data)\n        action(request, layer.frames, APP.frameActive, entry)\n      })\n    }\n\n    if (request === 'delete') {\n      APP.layers.forEach(layer => {\n        action(request, layer.frames, APP.frameActive)\n      })\n    }\n  }\n\n  APP[`${type}Count`] += (inserting ? 1 : -1)\n\n  if (inserting) {\n    APP[`${type}Active`] += 1\n  } \n  \n  if (request === 'delete') {\n    if (APP[`${type}Active`] === APP[`${type}Count`]) {\n      APP[`${type}Active`] -= 1\n    } \n  }\n}\n\nexport const timelineManager = ({ type, request, requestType, data, disableUndoRedo }) => {\n  const layerActive = APP.layerActive\n  const frameActive = APP.frameActive\n  const layerCount = APP.layerCount\n  const frameCount = APP.frameCount\n\n  if (!disableUndoRedo) {\n    addToUndo(request, type)\n\n    VIEW.currUndoRef.redo = () => {\n      APP.frameCount = frameCount\n      APP.layerCount = layerCount\n      APP.frameActive = frameActive\n      APP.layerActive = layerActive\n      timelineManager({ type, request, requestType, data, disableUndoRedo: true })\n    }\n  }\n\n  const newData = type === 'layer' ? {\n    name: `Layer ${layerCount + 1}`,\n    hidden: false,\n    frames: new Array(frameCount).fill(undefined).map(frame => new ImageData(APP.width, APP.height))\n  } : new Array(APP.layerCount)\n    .fill(undefined)\n    .map(item => {\n      return new ImageData(APP.width, APP.height)\n    })\n  \n  const cloneData = type === 'layer' ? {\n    name: `${APP.layers[layerActive].name} ${requestType === 'clone' ? '(Copy)' : ''}`,\n    hidden: false,\n    frames: new Array(frameCount)\n      .fill(undefined)\n      .map((frame, frameI) => {\n        const imgData = new ImageData(APP.width, APP.height)\n        imgData.data.set(APP.layers[layerActive].frames[frameI].data)\n        return imgData\n      })\n  } : new Array(layerCount)\n      .fill(undefined)\n      .map((item, i) => {\n        const copy = new ImageData(APP.width, APP.height)\n        copy.data.set(APP.layers[i].frames[frameActive].data)\n        return copy\n      })\n  \n  if ((type === 'layer' || type === 'frame') && (requestType === 'new' || requestType === 'clone')) {\n    seq('insert', type, requestType === 'new' ? newData : cloneData)\n  }\n\n  if ((type === 'layer' || type === 'frame') && request === 'delete') {\n    if (APP[`${type}Count`] - 1 === 0) {\n      seq('delete', type)\n      if (type === 'layer') newData.name = 'Layer 1'\n      seq('insert', type, newData)\n    } else {\n      seq('delete', type)\n    }\n  }\n\n  const layerActiveAfter = APP.layerActive\n  const frameActiveAfter = APP.frameActive\n  const layerCountAfter = APP.layerCount\n  const frameCountAfter = APP.frameCount\n  \n  if (!disableUndoRedo) {\n    VIEW.currUndoRef.undo = () => {\n      APP.frameCount = frameCountAfter\n      APP.layerCount = layerCountAfter\n  \n      if (type === 'layer') {\n        APP.frameActive = frameActiveAfter\n        \n        if (request === 'insert') {\n          APP.layerActive = layerActiveAfter\n          seq('delete', type)\n        }\n  \n        if (request === 'delete' && layerCount !== 1) {\n          APP.layerActive = layerActive - 1\n          seq('insert', type, cloneData)\n        }\n\n        if (request === 'delete' && layerCount === 1) {\n          seq('delete', type)\n          seq('insert', type, cloneData)\n        }\n      }\n\n      if (type === 'frame') {\n        APP.layerActive = layerActiveAfter\n        \n        if (request === 'insert') {\n          APP.frameActive = frameActiveAfter\n          seq('delete', type)\n        }\n  \n        if (request === 'delete' && frameCount !== 1) {\n          APP.frameActive = frameActive - 1\n          seq('insert', type, cloneData)\n        }\n\n        if (request === 'delete' && frameCount === 1) {\n          seq('delete', type)\n          seq('insert', type, cloneData)\n        }\n      }\n    }\n  }\n\n  VIEW.render()\n}\n\nconst swap = (type, dir) => {\n  const step = dir === 'up' ? -1 : 1\n  const active = type === 'layer' ? 'layerActive' : 'frameActive'\n  const length = type === 'layer' ? APP.layerCount : APP.frameCount\n\n  if (APP[active] + step === -1) return\n  if (APP[active] + step === length) return\n\n  if (type === 'layer') {\n    const temp = APP.layers[APP.layerActive + step]\n    APP.layers[APP.layerActive + step] = APP.layers[APP.layerActive]\n    APP.layers[APP.layerActive] = temp\n  }\n\n  if (type === 'frame') {\n    APP.layers.forEach(layer => {\n      const temp = layer.frames[APP.frameActive + step]\n      layer.frames[APP.frameActive + step] = layer.frames[APP.frameActive]\n      layer.frames[APP.frameActive] = temp\n    })\n  }\n\n  APP[active] += step\n\n  VIEW.render()\n}\n\nconst layersEditHidden = (i) => {\n  APP.layers[i].hidden = !APP.layers[i].hidden\n  VIEW.render()\n}\n\nconst nextFrame = () => {\n  APP.frameActive = (APP.frameActive + 1) % APP.frameCount\n  VIEW.render()\n}\n\nconst lastFrame = () => {\n  APP.frameActive = APP.frameActive - 1 === -1 ? APP.frameCount - 1 : APP.frameActive - 1\n  VIEW.render()\n}\n\n// Animation\nconst scheduler = () => {\n  APP.frameActive = (APP.frameActive + 1) % APP.frameCount\n  VIEW.render()\n  VIEW.timerID = setTimeout(scheduler, 100)\n}\n\nconst togglePlay = () => {\n  if (APP.frameCount === 1) return\n\n  if (VIEW.isPlaying) {\n    clearTimeout(VIEW.timerID)\n  } else {\n    scheduler()\n  }\n  \n  VIEW.isPlaying = !VIEW.isPlaying\n  VIEW.render()\n}\n\nexport const Timeline= () => {\n  return (\n    <div class='bg-light bord-dark-t fl-column' style='height: 250px;'>\n        <div class='fl w-full bord-dark-b h-30'>\n          <div class='fl fl-justify-between bord-dark-r' style='width: 210px;'>\n            {/* <div style='width: 90px;' class='p-h-10 fl fl-center-y bord-dark-r'>\n              <small><b>Layers</b></small>\n            </div> */}\n            <div class='fl'>\n              <button\n                onClick={() => { if (APP.layerCount < 30) timelineManager({ type:'layer', request: 'insert', requestType: 'new' }) }}\n                class='w-30 fl fl-center bord-dark-r' >\n                <img src={`img/insert.svg`} />\n              </button>\n              <button\n                onClick={() => { timelineManager({ type:'layer', request: 'insert', requestType: 'clone' }) }}\n                class='w-30 fl fl-center bord-dark-r' >\n                <img src={`img/clone.svg`} />\n              </button>\n              <button\n                onClick={() => { swap('layer', 'down') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/up.svg`} />\n              </button>\n              <button\n                onClick={() => { swap('layer', 'up') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/down.svg`} />\n              </button>\n              <button\n                onClick={() => { timelineManager({ type:'layer', request: 'delete' }) }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/delete.svg`} />\n              </button>\n            </div>\n          </div>\n          <div class='fl fl-1'>\n            <div class='fl'>\n              <button\n                onClick={() => { VIEW.onionSkinning = !VIEW.onionSkinning; VIEW.render() }}\n                class=\"fl fl-center m-0 p-0 w-30 bord-dark-r\"\n                style={VIEW.onionSkinning ? 'background: rgba(52, 152, 219, 255);' : ''}>\n                <img src=\"img/onion.svg\" />\n              </button>\n            </div>\n            <div class='fl-1 fl fl-justify-center'>\n              <div class='fl'>\n                <button\n                  onClick={() => { lastFrame() }}\n                  class=\"fl fl-center m-0 p-0 w-30 bord-dark-r bord-dark-l\" >\n                  <img src=\"img/lastframe.svg\" />\n                </button>\n                <button\n                  onClick={() => { togglePlay() }}\n                  class=\"fl fl-center m-0 p-0 w-30 bord-dark-r\" >\n                  <img src={`img/${VIEW.isPlaying ? 'stop.svg' : 'play.svg'}`} />\n                </button>\n                <button\n                  onClick={() => { nextFrame() }}\n                  class=\"fl fl-center m-0 p-0 w-30 bord-dark-r\" >\n                  <img src=\"img/nextframe.svg\" />\n                </button>\n              </div>\n            </div>\n            <div class='fl'>\n              <button\n                onClick={() => { if (!VIEW.isPlaying && APP.frameCount < 50) timelineManager({ type: 'frame', request: 'insert', requestType: 'new' }) }}\n                class='w-30 fl fl-center bord-dark-r bord-dark-l'>\n                <img src={`img/insert.svg`} />\n              </button>\n              <button\n                onClick={() => { timelineManager({ type:'frame', request: 'insert', requestType: 'clone' }) }}\n                class='w-30 fl fl-center bord-dark-r' >\n                <img src={`img/clone.svg`} />\n              </button>\n              <button\n                onClick={() => { if (!VIEW.isPlaying) swap('frame', 'up') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/up.svg`} style='transform: rotate(-90deg);'/>\n              </button>\n              <button\n                onClick={() => { if (!VIEW.isPlaying) swap('frame', 'down') }}\n                class='w-30 fl fl-center bord-dark-r'>\n                <img src={`img/down.svg`} style='transform: rotate(-90deg);' />\n              </button>\n              <button\n                onClick={() => { if (!VIEW.isPlaying) timelineManager({ type:'frame', request: 'delete' }) }}\n                class='w-30 fl fl-center'>\n                <img src={`img/delete.svg`} />\n              </button>\n            </div>\n          </div>\n        </div>\n        <div class='fl bg-mid' style='height: calc(100% - 30px);'>\n          <div id='layers' class='overflow hide-scroll' style='padding-bottom: 30px;'>\n            <div class='bord-dark-r fl-col-reverse' style='width: 210px;'>\n              {\n                APP.layers.map((layer, li) => {\n                  return <div\n                    class='fl bord-dark-b h-30'\n                    style={`background: ${APP.layerActive === li ? 'rgb(100, 100, 100)' :''};`}>\n                    <button\n                      style={`${layer.hidden ? 'background: rgba(52, 152, 219, 255);' : ''}`}\n                      onClick={() => { layersEditHidden(li) }}\n                      class='w-30 h-30 fl fl-center bord-dark-b'>\n                      <img src={`img/${layer.hidden ? 'eye-active.svg' : 'eye.svg'}`} />\n                    </button>\n                    <button\n                      onClick={() => { setTargetCanvas(APP.frameActive, li) }}\n                      class='fl-1 txt-left'>\n                      <small style='font-size: 11px;'><b>{layer.name}</b></small>\n                    </button>\n                  </div>\n                })\n              }\n            </div>\n          </div>\n          <div id='frames' class='fl-1 overflow hide-scroll' style='padding-bottom: 30px;'>\n            <div class='fl-col-reverse'>\n              {\n                APP.layers.map((layer, li) => {\n                  return <div\n                    class='fl'>\n                    {\n                      layer.frames.map((canvas, fi) => {\n                        return <button\n                          onClick={() => { setTargetCanvas(fi, li) }}\n                          class='w-30 h-30 fl fl-center bord-dark-r bord-dark-b bg-light rel'\n                          style={`\n                            background: ${\n                              APP.frameActive === fi && APP.layerActive === li\n                                ? 'rgba(52, 152, 219, 255)'\n                                : (APP.frameActive === fi || APP.layerActive === li)\n                                  ? 'rgba(100, 100, 100, 255)'\n                                  : 'rgba(0, 0, 0, 0)'\n                            };`}>\n                          <div class='abs bottom right p-5' ><small style='font-size: 8px;'><b>{fi + 1}</b></small></div>\n                          {/* <div class='bg-white' style='border-radius: 100%; width: 8px; height: 8px;' /> */}\n                        </button>\n                      })\n                    }\n                  </div>\n                })\n              }\n            </div>\n          </div>\n        </div>\n      </div>\n  )\n}","import { h, render, Component } from 'preact'\nimport { APP, VIEW, initCanvases, newData } from './data'\nimport { undo, redo } from './undo-redo'\nimport { setTool } from './canvas'\nimport { setupKeyListeners } from './keyboard'\n\n// Components\nimport { Color } from './color'\nimport { Timeline } from './timeline'\nimport { Canvas, paintCanvas } from './canvas'\n\nconst loadData = ({ onLoaded, onError }) => {\n  //console.time('startRead')\n  localforage.getItem('pixel-art-app').then((stored) => {\n    //console.timeEnd('startRead')\n    for (const key in stored) {\n      APP[key] = stored[key]\n    }\n\n    onLoaded()\n  }).catch(function(err) {\n    console.log(err)\n    onError()\n  });\n}\n\nconst saveData = () => {\n  //console.time('startwrite')\n  localforage.setItem('pixel-art-app', APP).then(function(value) {\n    // This will output `1`.\n    //console.timeEnd('startwrite')\n  }).catch(function(err) {\n    // This code runs if there were any errors\n    console.log(err);\n  });\n}\n\nconst downloadCanvas = (e) => {\n  const c = document.createElement('canvas')\n  const ctx = c.getContext('2d')\n  const height = APP.height * VIEW.downloadCanvas.size\n  const width = APP.width * VIEW.downloadCanvas.size\n\n  if (VIEW.downloadCanvas.type === 'frame') {\n    c.width = width\n    c.height = height\n\n    ctx.webkitImageSmoothingEnabled = false\n    ctx.mozImageSmoothingEnabled = false\n    ctx.imageSmoothingEnabled = false\n\n    APP.layers.forEach(layer => {\n      VIEW.canvasTemp.ctx.putImageData(layer.frames[APP.frameActive], 0, 0)\n      ctx.drawImage(VIEW.canvasView.dom, 0, 0, c.width, c.height)\n    })\n  }\n\n  if (VIEW.downloadCanvas.type === 'spritesheet') {\n    const totalWidth = APP.width * VIEW.downloadCanvas.size * APP.frameCount\n    c.width = totalWidth\n    c.height = height\n\n    ctx.webkitImageSmoothingEnabled = false\n    ctx.mozImageSmoothingEnabled = false\n    ctx.imageSmoothingEnabled = false\n\n    console.log(APP.frameCount)\n    for (let frameI = 0; frameI < APP.frameCount; frameI++) {\n      APP.layers.forEach(layer => {\n        VIEW.canvasTemp.ctx.putImageData(layer.frames[frameI], 0, 0)\n        ctx.drawImage(VIEW.canvasTemp.dom, frameI * width, 0, width, height)\n      })\n    }\n  }\n\n  const image = c.toDataURL('image/png').replace('image/png', 'image/octet-stream')\n  e.target.setAttribute('href', image)\n}\n\nclass View extends Component{\n  componentDidMount () {\n    VIEW.render = () => {\n      this.setState({}, () => {\n        VIEW.canvasTemp.ctx.clearRect(0, 0, APP.width, APP.height)\n        VIEW.canvasFinal.ctx.clearRect(0, 0, APP.width, APP.height)\n        VIEW.canvasView.ctx.clearRect(0, 0, APP.width, APP.height)\n\n        APP.layers.forEach((layer, i) => {\n          VIEW.canvasView.ctx.globalAlpha = 1\n\n          if (layer.hidden) return\n\n          // Onion skinning\n          if (APP.layerActive === i && VIEW.onionSkinning && !VIEW.isPlaying) {\n            const framesAhead = 3\n            const framesBehind = 3\n            const framesTotal = framesBehind + framesAhead\n\n            VIEW.canvasView.ctx.globalAlpha = .5\n\n            for (let a = framesAhead - framesTotal; a < framesAhead; a++) {\n              if (!layer.frames[APP.frameActive - a]) continue\n\n              const target = layer.frames[APP.frameActive - a] \n              VIEW.canvasTemp.ctx.putImageData(target, 0, 0)\n              VIEW.canvasView.ctx.drawImage(VIEW.canvasTemp.dom, 0, 0)\n            }\n          }\n\n          // Regular frame render\n          VIEW.canvasView.ctx.globalAlpha = 1\n\n          const target = layer.frames[APP.frameActive]\n\n          for (let b = 0; b < 2; b++) { // For whatever reason safari makes me do this twice\n            // Target Canvas\n            VIEW.canvasTemp.ctx.putImageData(target, 0, 0)\n            VIEW.canvasView.ctx.drawImage(VIEW.canvasTemp.dom, 0, 0)\n            \n            // Preview Canvas\n            if (APP.layerActive === i) {\n              VIEW.canvasTemp.ctx.putImageData(VIEW.canvasPreview.imgData, 0, 0)\n              VIEW.canvasView.ctx.drawImage(VIEW.canvasTemp.dom, 0, 0)\n            }\n          }\n        })\n      })\n    }\n\n    initCanvases()\n\n    this.funcs = { paintCanvas }\n\n    // View control customization\n    this.canvasOuterScroll = document.querySelector('#canvas-outer-scroll')\n    this.canvasInnerScroll = document.querySelector('#canvas-inner-scroll')\n\n    this.timelineScroll = {\n      isSyncingLeftScroll: false,\n      isSyncingRightScroll: false,\n      leftDiv: document.querySelector('#layers'),\n      rightDiv: document.querySelector('#frames')\n    }\n\n    this.timelineScrollController()\n    this.centerCanvas()\n\n    // Adding google analytics\n    window.dataLayer = window.dataLayer || [];\n    function gtag(){dataLayer.push(arguments);}\n    gtag('js', new Date());\n\n    gtag('config', 'UA-144729452-1');\n  }\n\n  centerCanvas () {\n    const outerW = this.canvasOuterScroll.offsetWidth\n    const innerW = this.canvasInnerScroll.offsetWidth\n    const outerH = this.canvasOuterScroll.offsetHeight\n    const innerH = this.canvasInnerScroll.offsetHeight\n    \n    this.canvasOuterScroll.scrollLeft = Math.floor((innerW - outerW) / 2) + 8\n    this.canvasOuterScroll.scrollTop = Math.floor((innerH - outerH) / 2) + 8\n  }\n\n  timelineScrollController () {\n    this.timelineScroll.leftDiv.addEventListener('scroll', (e) => {\n      if (!this.timelineScroll.isSyncingLeftScroll) {\n        this.timelineScroll.isSyncingRightScroll = true\n        this.timelineScroll.rightDiv.scrollTop = e.target.scrollTop\n      }\n      this.timelineScroll.isSyncingLeftScroll = false\n    })\n    \n    this.timelineScroll.rightDiv.addEventListener('scroll', (e) => {\n      if (!this.timelineScroll.isSyncingRightScroll) {\n        this.timelineScroll.isSyncingLeftScroll = true\n        this.timelineScroll.leftDiv.scrollTop = e.target.scrollTop\n      }\n      this.timelineScroll.isSyncingRightScroll = false\n    })\n  }\n\n  onGestureDown (e) {\n    if (!VIEW.isPlaying) \n\n    VIEW.window.request = e.target.dataset.request || ''\n    VIEW.window.mouseDown = true\n    VIEW.window.startX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.startY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n    VIEW.window.prevX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.prevY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n    VIEW.window.currX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.currY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n\n    if (VIEW.window.request) this.funcs[VIEW.window.request]('start')\n  }\n  \n  onGestureDrag (e) {\n    if (!VIEW.isPlaying) \n\n    VIEW.window.prevX = VIEW.window.currX\n    VIEW.window.prevY = VIEW.window.currY\n    VIEW.window.currX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.currY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n    \n    if (VIEW.window.request) this.funcs[VIEW.window.request]('resume')\n  \n    if (e.target.tagName !== 'INPUT') { // prevent block on input range elements\n      e.preventDefault() // block pull to refresh on mobile browsers\n    }\n  }\n\n  onGestureEnd (e) {\n    if (!VIEW.isPlaying)\n\n    if (VIEW.window.request) this.funcs[VIEW.window.request]('end')\n\n    VIEW.window.request = ''\n    VIEW.window.mouseDown = false\n    VIEW.window.startX = 0\n    VIEW.window.startY = 0\n    VIEW.window.prevX = 0\n    VIEW.window.prevY = 0\n    VIEW.window.currX = 0\n    VIEW.window.currY = 0\n\n    setTimeout(() => {\n      saveData()\n    }, 50)\n  }\n\n  onGestureHover (e) {\n    if (!VIEW.isPlaying)\n\n    VIEW.window.prevX = VIEW.window.currX\n    VIEW.window.prevY = VIEW.window.currY\n    VIEW.window.currX = (e.pageX === undefined) ? e.touches[0].pageX : e.pageX\n    VIEW.window.currY = (e.pageY === undefined) ? e.touches[0].pageY : e.pageY\n\n    if (e.target.dataset.hover) this.funcs[e.target.dataset.hover]('hover')\n  }\n  \n  dragOrHover (e) {\n    if (VIEW.window.mouseDown) {\n      this.onGestureDrag(e)\n    } else {\n      this.onGestureHover(e)\n    }\n  }\n\n  render () {\n    return (\n      <div\n        class='h-full relative'\n        onMouseDown={(e) => { if (e.which === 1) this.onGestureDown(e); }}\n        onMouseMove={(e) => { this.dragOrHover(e) }}\n        onMouseUp={(e) => { this.onGestureEnd(e) }}>\n        <div class='h-40 bg-light bord-dark-b fl'>\n          <div class=\"fl w-full\">\n            <div class=\"fl-1 fl\">\n              <div class=\"fl bord-dark-r rel w-40\"\n                onMouseLeave={() => {\n                  VIEW.file.open = false\n                  VIEW.render()\n                }}>\n                <button\n                  onClick={() => {\n                    VIEW.file.open = !VIEW.file.open\n                    VIEW.render()\n                  }}\n                  class=\"fl fl-center m-0 p-0 w-40\">\n                  <img src=\"img/bars.svg\" />\n                </button>\n                <div\n                  class=\"bg-light fl-column bord-dark abs z-5\"\n                  style={`visibility: ${VIEW.file.open ? 'visible' : 'hidden'}; top: 10px; left: 10px;`}>\n                    <button\n                      onClick={() => {\n                        VIEW.newCanvas.open = true\n                        VIEW.file.open = false\n                        VIEW.render()\n                      }}\n                      class=\"m-0 p-h-15 h-40 fl fl-center-y\">\n                      <img src={`img/new.svg`} />\n                      <small class=\"bold p-h-10\" style='text-transform: capitalize;'>New</small>\n                    </button>\n                    <button\n                      onClick={() => {\n                        VIEW.downloadCanvas.open = true\n                        VIEW.file.open = false\n                        VIEW.render()\n                      }}\n                      class=\"m-0 p-h-15 h-40 fl fl-center-y\">\n                      <img src={`img/download.svg`} />\n                      <small class=\"bold p-h-10\" style='text-transform: capitalize;'>download</small>\n                    </button>\n                </div>\n              </div>\n              <div class='fl-1 fl fl-justify-center'>\n                <button\n                  onClick={() => { undo() }}\n                  class=\"fl fl-center m-0 p-0 w-40 bord-dark-l bord-dark-r\">\n                  <img src=\"img/undo.svg\" />\n                </button>\n                <button\n                  onClick={() => { redo() }}\n                  class=\"fl fl-center m-0 p-0 w-40 bord-dark-r\">\n                  <img src=\"img/redo.svg\" />\n                </button>\n              </div>\n            </div>\n            <div class=\"fl\" style=\"max-width: 241px; min-width: 241px;\">\n              \n            </div>\n          </div>\n        </div>\n        <div class='fl' style='height: calc(100% - 40px); '>\n          <div class='w-40 bg-light bord-dark-r'>\n            {\n              ['pencil', 'eraser', 'line', 'circle', 'square', 'fill', 'eye-dropper', 'move'].map(tool => \n                <button\n                  onClick={() => { setTool(tool) }}\n                  class=\"fl fl-center m-0 p-0 w-40 h-40 bord-dark-r\"\n                  style={`${APP.tool === tool ? 'background: rgba(52, 152, 219, 255);' : ''}`}>\n                  <img src={`img/${tool}.svg`} />\n                </button>\n              )\n            }\n          </div>\n          <div class='fl-column' style='width: calc(100% - 281px);'>\n            <div\n              id='canvas-outer-scroll'\n              class={`overflow fl-1 cursor-${APP.tool}`}>\n              <Canvas />\n            </div>\n            <Timeline />\n            {/* <div class='fl-1 h-full fl'>\n              <div class='fl-1 fl-column h-full' style='width: calc(100% - 281px);'>\n                <Canvas />\n                <Timeline />\n              </div>\n            </div> */}\n          </div>\n          <div class='bg-light bord-dark-l fl-column' style=\"max-width: 241px; min-width: 241px;\">\n            <div class='bord-dark-b fl-column overflow'>\n              <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n                <small><b>Tool</b></small>\n              </div>\n              <div class='fl-1 overflow'>\n                <div class=\"fl fl-center p-10\">\n                  <small class=\"bold\" style=\"width: 150px;\">Brush Size</small>\n                  <select\n                    onInput={(e) => {\n                      VIEW.brushSize = parseInt(e.target.value)\n                    }}\n                    value={VIEW.brushSize}\n                    class=\"w-full\">\n                      {\n                        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((size, i) => {\n                          return <option value={i}>{size}</option>\n                        })\n                      }\n                  </select>\n                </div>\n              </div>\n            </div>\n            <Color />\n            <div class='fl-1 bord-dark-b fl-column overflow'>\n              <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n                <small><b>History</b></small>\n              </div>\n              <div class='fl-1 overflow'>\n                {\n                  VIEW.undo.map((entry, i) => {\n                    return <button class={`p-h-10 h-30 w-full txt-left fl fl-center-y ${VIEW.undoPos === i ? 'bg-xlight' : ''}`} >\n                      <img width='10' height='10' style='margin-right: 10px;' src={`img/${entry.icon}`} />\n                      <small style='text-transform: capitalize; font-size: 11px;'><b>{entry.action}</b></small>\n                    </button>\n                  })\n                }\n              </div>\n            </div>\n            <div style='min-height: 249px; max-height: 249px;'>\n              <div class='h-30 bg-mid bord-dark-b fl fl-center-y p-h-10'>\n                <small><b>Timeline</b></small>\n              </div>\n              <div class='overflow fl-1'>\n                \n              </div>\n            </div>\n          </div>\n        </div>\n        {VIEW.newCanvas.open && <div class=\"abs top left w-full h-full fl fl-justify-center\" style=\"z-index: 10;\">\n          <div class=\"w-full overflow-hidden\" style=\"max-width: 300px; margin-top: 175px;\">\n            <div class=\"fl fl-center bg-mid bord-dark p-v-5\" style='border-top-right-radius: 5px; border-top-left-radius: 5px;'><small><b>New Canvas</b></small></div>\n            <div class=\"p-10 bg-light bord-dark-l bord-dark-r bord-dark-b\" style='border-bottom-right-radius: 5px; border-bottom-left-radius: 5px;'>\n              <div class=\"m-5 p-v-5\">\n                <div class=\"fl fl-center\">\n                  <small class=\"bold\" style=\"width: 150px;\">Dimensions</small>\n                  <select\n                    onInput={(e) => {\n                      const val = e.target.value.split('x')\n                      VIEW.newCanvas.w = parseInt(val[0])\n                      VIEW.newCanvas.h = parseInt(val[1])\n                    }}\n                    class=\"w-full\">\n                    <option value=\"32x32\">32x32</option>\n                    <option value=\"50x50\">50x50</option>\n                    <option value=\"64x64\">64x64</option>\n                    <option value=\"100x100\">100x100</option>\n                    <option value=\"128x128\">128x128</option>\n                  </select>\n                </div>\n              </div>\n              <div class=\"fl\" style=\"padding-top: 5px;\">\n                <button\n                  onClick={() => {\n                    VIEW.newCanvas.open = false\n                    VIEW.render()\n                  }}\n                  class=\"b-r-2 bold p-5 w-full bg-red m-5\">Cancel</button>\n                <button\n                  onClick={() => {\n                    newData(VIEW.newCanvas.w, VIEW.newCanvas.h)\n                    VIEW.newCanvas.open = false\n                    VIEW.render()\n                  }}\n                  class=\"b-r-2 bold p-5 w-full bg-green m-5\">Confirm</button>\n              </div>\n            </div>\n          </div>\n        </div>}\n        {VIEW.downloadCanvas.open && <div class=\"abs top left w-full h-full fl fl-center-x\" style=\"z-index: 10;\">\n          <div class=\"w-full\" style=\"max-width: 300px; overflow: hidden; margin-top: 175px;\">\n              <div class=\"fl fl-center bg-mid bord-dark p-v-5\" style='border-top-right-radius: 5px; border-top-left-radius: 5px;'><small class=\"bold\">Download</small></div>\n              <div class=\"p-10 bg-light bord-dark-l bord-dark-r bord-dark-b\" style='border-bottom-right-radius: 5px; border-bottom-left-radius: 5px;'>\n                <div class=\"m-5 p-v-5\">\n                  <div class=\"fl fl-center\">\n                    <small class=\"bold\" style=\"width: 150px;\">Type</small>\n                    <select\n                      onInput={(e) => {\n                        VIEW.downloadCanvas.type = e.target.value\n                      }}\n                      value={VIEW.downloadCanvas.type}\n                      id=\"config-download-size\" class=\"w-full\">\n                        <option value=\"frame\">Frame</option>\n                        <option value=\"spritesheet\">Spritesheet</option>\n                    </select>\n                  </div>\n                </div>\n                <div class=\"m-5 p-v-5\">\n                    <div class=\"fl fl-center\">\n                      <small class=\"bold\" style=\"width: 150px;\">Size</small>\n                      <select\n                        onInput={(e) => {\n                          VIEW.downloadCanvas.size = parseInt(e.target.value)\n                        }}\n                        value={VIEW.downloadCanvas.size}\n                        id=\"config-download-size\" class=\"w-full\">\n                          <option value=\"2\">2x</option>\n                          <option value=\"4\">4x</option>\n                          <option value=\"8\">8x</option>\n                          <option value=\"16\">16x</option>\n                          <option value=\"32\">32x</option>\n                          <option value=\"64\">64x</option>\n                      </select>\n                    </div>\n                </div>\n                <div class=\"fl\" style=\"padding-top: 5px;\">\n                  <button\n                    onClick={() => {\n                      VIEW.downloadCanvas.open = false\n                      VIEW.render()\n                    }}\n                    class=\"b-r-2 bold p-5 w-full bg-red m-5\">Cancel</button>\n                  <a\n                    onClick={(e) => {\n                      downloadCanvas(e)\n                    }}\n                    class=\"w-full m-5 clickable\" download=\"pixel-art.png\" style=\"display: inline-block;\">\n                    <button class=\"b-r-2 bold p-5 w-full bg-green no-ptr\">Download</button>\n                  </a>\n                </div>\n              </div>\n          </div>\n        </div>}\n      </div>\n    )\n  }\n}\n\nconst onProgramStart = () => {\n  console.log('Program started.')\n\n  newData(64, 64, true)\n  render(<View />, document.body)\n  \n  loadData({\n    onLoaded: () => {\n      initCanvases()\n      VIEW.render()\n    },\n    onError: () => {}\n  })\n\n  setupKeyListeners()\n  \n  window.addEventListener('keyup', () => {\n    saveData()\n  })  \n}\n\nwindow.addEventListener('load', onProgramStart)\n\nwindow.addEventListener('beforeunload', (event) => {\n  event.returnValue = `Are you sure you want to leave?`;\n});\n"],"names":["n","u","i","t","r","o","e","c","s","a","l","v","parentNode","removeChild","h","arguments","length","push","children","defaultProps","p","key","ref","type","props","__k","__","__b","__e","__d","__c","constructor","__v","vnode","d","m","this","context","w","indexOf","k","base","g","debounceRendering","_","sort","some","f","__P","A","__n","ownerSVGElement","T","b","y","x","appendChild","nextSibling","insertBefore","value","D","j","Array","isArray","C","setProperty","test","N","style","cssText","replace","toLowerCase","slice","addEventListener","z","removeEventListener","removeAttributeNS","setAttributeNS","removeAttribute","setAttribute","event","P","contextType","__E","prototype","render","E","sub","state","__h","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","__r","getChildContext","getSnapshotBeforeUpdate","$","diffed","call","nodeType","localName","document","createTextNode","createElementNS","createElement","is","data","childNodes","dangerouslySetInnerHTML","attributes","name","__html","innerHTML","checked","current","unmount","componentWillUnmount","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","Promise","then","bind","resolve","setTimeout","const","RGBtoHSL","rgb","let","cmin","Math","min","cmax","max","delta","round","abs","toFixed","floor","APP","VIEW","undefined","canvases","initCanvases","forEach","canvas","dom","querySelector","width","height","ctx","getContext","imgData","getImageData","newData","preventOnMount","tool","frameActive","layerActive","frameCount","layerCount","layers","hidden","frames","ImageData","color","hsl","palette","Object","seal","initAppDefault","file","open","newCanvas","downloadCanvas","size","window","request","mouseDown","startX","startY","prevX","prevY","currX","currY","brushSize","timerID","isPlaying","onionSkinning","undo","undoPos","currUndoRef","initViewDefault","addToUndo","action","splice","icon","redo","pop","colorSetHSL","HSLtoRGB","colorSetRGB","Color","class","filter","onClick","src","index","onInput","parseInt","target","dataset","autocomplete","id","data-index","map","setTool","line","endX","endY","func","dx","dy","xDir","yDir","lineX","lineY","step","circle","xCenter","yCenter","radius","sqrt","pow","circlePlot","square","paintCanvas","gestureEvent","canvasPreview","clearRect","preview","bb","canvasView","getBoundingClientRect","scaleX","scaleY","setBrushPoints","xStep","yStep","squareFilled","imgDataArr","Error","setPoint","copy","set","getPoint","canvasImgData","linear_cords","pixel_stack","original_color","linearCord","getColorAtPixel","c1","c2","areRGBAsEqual","new_pixel","shift","reached_left","reached_right","fill","canvasSelection","putImageData","Canvas","data-request","data-hover","keyMap","metaKey","shiftKey","shiftKeyMark","Date","now","metaKeyMark","alphaKeyMark","setTargetCanvas","frame","layer","console","error","seq","inserting","req","entry","timelineManager","disableUndoRedo","requestType","item","cloneData","frameI","layerActiveAfter","frameActiveAfter","layerCountAfter","frameCountAfter","swap","dir","active","temp","scheduler","Timeline","clearTimeout","li","layersEditHidden","fi","saveData","localforage","setItem","catch","err","log","View","gtag","dataLayer","canvasTemp","canvasFinal","globalAlpha","framesAhead","drawImage","funcs","canvasOuterScroll","canvasInnerScroll","timelineScroll","isSyncingLeftScroll","isSyncingRightScroll","leftDiv","rightDiv","timelineScrollController","centerCanvas","outerW","offsetWidth","innerW","outerH","offsetHeight","innerH","scrollLeft","scrollTop","onGestureDown","pageX","touches","pageY","onGestureDrag","tagName","preventDefault","onGestureEnd","onGestureHover","hover","dragOrHover","onMouseDown","which","onMouseMove","onMouseUp","onMouseLeave","val","split","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","imageSmoothingEnabled","totalWidth","image","toDataURL","download","Component","body","onLoaded","onError","getItem","stored","repeat","returnValue"],"mappings":"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"}